<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>D Doubly Robust Simulation | Study project: Fundamentals of Causal Inferences With R Tidyverse</title>
  <meta name="description" content="<p>This is study project of Fundamentals of Causal Inferences by Babette A.
Brumback with the goal of using the R Tidyverse way of programming.
The exercises are in a separate project.</p>" />
  <meta name="generator" content="bookdown 0.25 and GitBook 2.6.7" />

  <meta property="og:title" content="D Doubly Robust Simulation | Study project: Fundamentals of Causal Inferences With R Tidyverse" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="<p>This is study project of Fundamentals of Causal Inferences by Babette A.
Brumback with the goal of using the R Tidyverse way of programming.
The exercises are in a separate project.</p>" />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="D Doubly Robust Simulation | Study project: Fundamentals of Causal Inferences With R Tidyverse" />
  
  <meta name="twitter:description" content="<p>This is study project of Fundamentals of Causal Inferences by Babette A.
Brumback with the goal of using the R Tidyverse way of programming.
The exercises are in a separate project.</p>" />
  

<meta name="author" content="FranÃ§ois Lefebvre" />


<meta name="date" content="2022-05-12" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="linreg.html"/>
<link rel="next" href="references.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Study Project</a></li>

<li class="divider"></li>
<li><a href="index.html#study-project">Study Project<span></span></a>
<ul>
<li><a href="index.html#about">About<span></span></a></li>
</ul></li>
<li class="part"><span><b>I Part I<span></span></b></span></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Introduction<span></span></a>
<ul>
<li class="chapter" data-level="1.1" data-path="intro.html"><a href="intro.html#a-brief-history"><i class="fa fa-check"></i><b>1.1</b> A Brief History<span></span></a></li>
<li class="chapter" data-level="1.2" data-path="intro.html"><a href="intro.html#data-examples"><i class="fa fa-check"></i><b>1.2</b> Data Examples<span></span></a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="intro.html"><a href="intro.html#mortality-rates-by-country"><i class="fa fa-check"></i><b>1.2.1</b> Mortality Rates by Country<span></span></a></li>
<li class="chapter" data-level="1.2.2" data-path="intro.html"><a href="intro.html#national-center-for-education-statistics"><i class="fa fa-check"></i><b>1.2.2</b> National Center for Education Statistics<span></span></a></li>
<li class="chapter" data-level="1.2.3" data-path="intro.html"><a href="intro.html#reducing-alcohol-consumption"><i class="fa fa-check"></i><b>1.2.3</b> Reducing Alcohol Consumption<span></span></a></li>
<li class="chapter" data-level="1.2.4" data-path="intro.html"><a href="intro.html#general-social-survey"><i class="fa fa-check"></i><b>1.2.4</b> General Social Survey<span></span></a></li>
<li class="chapter" data-level="1.2.5" data-path="intro.html"><a href="intro.html#a-cancer-clinical-trial"><i class="fa fa-check"></i><b>1.2.5</b> A Cancer Clinical Trial<span></span></a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="intro.html"><a href="intro.html#exercises"><i class="fa fa-check"></i><b>1.3</b> Exercises<span></span></a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="probability.html"><a href="probability.html"><i class="fa fa-check"></i><b>2</b> Conditional Probability and Expectation<span></span></a>
<ul>
<li class="chapter" data-level="2.1" data-path="probability.html"><a href="probability.html#conditional-probability"><i class="fa fa-check"></i><b>2.1</b> Conditional Probability<span></span></a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="probability.html"><a href="probability.html#law-of-total-probability"><i class="fa fa-check"></i><b>2.1.1</b> Law of total probability<span></span></a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="probability.html"><a href="probability.html#conditional-expectation-and-the-law-of-total-expectation"><i class="fa fa-check"></i><b>2.2</b> Conditional Expectation and the Law of Total expectation<span></span></a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="probability.html"><a href="probability.html#mean-independence-and-conditional-mean-independence"><i class="fa fa-check"></i><b>2.2.1</b> Mean independence and conditional mean independence<span></span></a></li>
<li class="chapter" data-level="2.2.2" data-path="probability.html"><a href="probability.html#regression-model"><i class="fa fa-check"></i><b>2.2.2</b> Regression model<span></span></a></li>
<li class="chapter" data-level="2.2.3" data-path="probability.html"><a href="probability.html#nonlinear-parametric-models"><i class="fa fa-check"></i><b>2.2.3</b> Nonlinear parametric models<span></span></a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="probability.html"><a href="probability.html#estimation"><i class="fa fa-check"></i><b>2.3</b> Estimation<span></span></a></li>
<li class="chapter" data-level="2.4" data-path="probability.html"><a href="probability.html#sampling-distributions-and-the-bootstrap"><i class="fa fa-check"></i><b>2.4</b> Sampling Distributions and the Bootstrap<span></span></a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="probability.html"><a href="probability.html#bootstrapping"><i class="fa fa-check"></i><b>2.4.1</b> Bootstrapping<span></span></a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="probability.html"><a href="probability.html#exercises-1"><i class="fa fa-check"></i><b>2.5</b> Exercises<span></span></a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="outcomes.html"><a href="outcomes.html"><i class="fa fa-check"></i><b>3</b> Potential Outcomes and the Fundamental Problem of Causal Inference<span></span></a>
<ul>
<li class="chapter" data-level="3.1" data-path="outcomes.html"><a href="outcomes.html#potential-outcomes-and-the-consistency-assumption"><i class="fa fa-check"></i><b>3.1</b> Potential Outcomes and the Consistency Assumption<span></span></a></li>
<li class="chapter" data-level="3.2" data-path="outcomes.html"><a href="outcomes.html#circumventing-the-fundamental-problem-of-causal-inference"><i class="fa fa-check"></i><b>3.2</b> Circumventing the Fundamental Problem of Causal Inference<span></span></a></li>
<li class="chapter" data-level="3.3" data-path="outcomes.html"><a href="outcomes.html#effect-measures"><i class="fa fa-check"></i><b>3.3</b> Effect Measures<span></span></a></li>
<li class="chapter" data-level="3.4" data-path="outcomes.html"><a href="outcomes.html#exercises-2"><i class="fa fa-check"></i><b>3.4</b> Exercises<span></span></a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="measures.html"><a href="measures.html"><i class="fa fa-check"></i><b>4</b> Effect-Measure Modification and Causal Interaction<span></span></a>
<ul>
<li class="chapter" data-level="4.1" data-path="measures.html"><a href="measures.html#effect-measure-modification-and-statistical-interaction"><i class="fa fa-check"></i><b>4.1</b> Effect-Measure Modification and Statistical Interaction<span></span></a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="measures.html"><a href="measures.html#recovery-trial"><i class="fa fa-check"></i><b>4.1.1</b> RECOVERY trial<span></span></a></li>
<li class="chapter" data-level="4.1.2" data-path="measures.html"><a href="measures.html#nces"><i class="fa fa-check"></i><b>4.1.2</b> NCES<span></span></a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="measures.html"><a href="measures.html#qualitative-agreement-of-effect-measures-in-modification"><i class="fa fa-check"></i><b>4.2</b> Qualitative Agreement of Effect Measures in Modification<span></span></a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="measures.html"><a href="measures.html#simulate-the-effect-measures"><i class="fa fa-check"></i><b>4.2.1</b> Simulate the effect measures<span></span></a></li>
<li class="chapter" data-level="4.2.2" data-path="measures.html"><a href="measures.html#applications"><i class="fa fa-check"></i><b>4.2.2</b> Applications<span></span></a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="measures.html"><a href="measures.html#causal-interaction"><i class="fa fa-check"></i><b>4.3</b> Causal Interaction<span></span></a></li>
<li class="chapter" data-level="4.4" data-path="measures.html"><a href="measures.html#exercises-3"><i class="fa fa-check"></i><b>4.4</b> Exercises<span></span></a></li>
</ul></li>
<li class="part"><span><b>II Part II<span></span></b></span></li>
<li class="chapter" data-level="5" data-path="dag.html"><a href="dag.html"><i class="fa fa-check"></i><b>5</b> Causal Directed Acyclic Graphs<span></span></a>
<ul>
<li class="chapter" data-level="5.1" data-path="dag.html"><a href="dag.html#theory"><i class="fa fa-check"></i><b>5.1</b> Theory<span></span></a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="dag.html"><a href="dag.html#conditional-indepence-and-dag"><i class="fa fa-check"></i><b>5.1.1</b> Conditional Indepence and DAG<span></span></a></li>
<li class="chapter" data-level="5.1.2" data-path="dag.html"><a href="dag.html#d-separation"><i class="fa fa-check"></i><b>5.1.2</b> D-Separation<span></span></a></li>
<li class="chapter" data-level="5.1.3" data-path="dag.html"><a href="dag.html#causal-dag-with-collider"><i class="fa fa-check"></i><b>5.1.3</b> Causal DAG with collider<span></span></a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="dag.html"><a href="dag.html#examples"><i class="fa fa-check"></i><b>5.2</b> Examples<span></span></a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="dag.html"><a href="dag.html#causal-dag-with-intermediate-value"><i class="fa fa-check"></i><b>5.2.1</b> Causal DAG With Intermediate Value<span></span></a></li>
<li class="chapter" data-level="5.2.2" data-path="dag.html"><a href="dag.html#a-counfounder-may-occur-after-the-exposure"><i class="fa fa-check"></i><b>5.2.2</b> A counfounder may occur after the exposure<span></span></a></li>
<li class="chapter" data-level="5.2.3" data-path="dag.html"><a href="dag.html#potential-outcomes-are-the-ultimate-counfounder"><i class="fa fa-check"></i><b>5.2.3</b> Potential Outcomes are the Ultimate Counfounder<span></span></a></li>
<li class="chapter" data-level="5.2.4" data-path="dag.html"><a href="dag.html#structural-causal-model-5.7"><i class="fa fa-check"></i><b>5.2.4</b> Structural Causal Model 5.7<span></span></a></li>
<li class="chapter" data-level="5.2.5" data-path="dag.html"><a href="dag.html#potential-outcomes-behind-the-scenes"><i class="fa fa-check"></i><b>5.2.5</b> Potential Outcomes Behind the Scenes<span></span></a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="dag.html"><a href="dag.html#exercises-4"><i class="fa fa-check"></i><b>5.3</b> Exercises<span></span></a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="backdoor.html"><a href="backdoor.html"><i class="fa fa-check"></i><b>6</b> Backdoor Method via Standardization<span></span></a>
<ul>
<li class="chapter" data-level="6.1" data-path="backdoor.html"><a href="backdoor.html#standardization-via-outome-modeling"><i class="fa fa-check"></i><b>6.1</b> Standardization via Outome Modeling<span></span></a>
<ul>
<li><a href="backdoor.html#examples-1">Examples<span></span></a></li>
<li class="chapter" data-level="6.1.1" data-path="backdoor.html"><a href="backdoor.html#average-effect-of-treatment-on-the-treated"><i class="fa fa-check"></i><b>6.1.1</b> Average Effect of Treatment on the Treated<span></span></a></li>
<li class="chapter" data-level="6.1.2" data-path="backdoor.html"><a href="backdoor.html#standardization-with-a-parametric-outcome-model"><i class="fa fa-check"></i><b>6.1.2</b> Standardization with a Parametric Outcome Model<span></span></a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="backdoor.html"><a href="backdoor.html#standardization-via-exposure-modeling"><i class="fa fa-check"></i><b>6.2</b> Standardization via Exposure Modeling<span></span></a>
<ul>
<li><a href="backdoor.html#examples-2">Examples<span></span></a></li>
<li class="chapter" data-level="6.2.1" data-path="backdoor.html"><a href="backdoor.html#average-effect-of-treatment-on-the-treated-1"><i class="fa fa-check"></i><b>6.2.1</b> Average Effect of Treatment on the Treated<span></span></a></li>
<li class="chapter" data-level="6.2.2" data-path="backdoor.html"><a href="backdoor.html#standardization-with-a-parametric-exposure-model"><i class="fa fa-check"></i><b>6.2.2</b> Standardization with a Parametric Exposure Model<span></span></a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="backdoor.html"><a href="backdoor.html#doubly-robust-standardization"><i class="fa fa-check"></i><b>6.3</b> Doubly Robust Standardization<span></span></a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="backdoor.html"><a href="backdoor.html#doubly-robust-standardization-simulation"><i class="fa fa-check"></i><b>6.3.1</b> Doubly Robust Standardization Simulation<span></span></a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="backdoor.html"><a href="backdoor.html#exercises-5"><i class="fa fa-check"></i><b>6.4</b> Exercises<span></span></a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="did.html"><a href="did.html"><i class="fa fa-check"></i><b>7</b> Difference-in-Differences Estimators<span></span></a>
<ul>
<li class="chapter" data-level="7.1" data-path="did.html"><a href="did.html#difference-in-differences-did-estimators"><i class="fa fa-check"></i><b>7.1</b> Difference-in-Differences (DiD) Estimators<span></span></a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="did.html"><a href="did.html#did-estimator-with-a-linear-model"><i class="fa fa-check"></i><b>7.1.1</b> DiD Estimator with a Linear Model<span></span></a></li>
<li class="chapter" data-level="7.1.2" data-path="did.html"><a href="did.html#did-estimator-with-a-loglinear-model"><i class="fa fa-check"></i><b>7.1.2</b> DiD Estimator with a Loglinear Model<span></span></a></li>
<li class="chapter" data-level="7.1.3" data-path="did.html"><a href="did.html#did-estimator-with-a-logistic-model"><i class="fa fa-check"></i><b>7.1.3</b> DiD Estimator with a Logistic Model<span></span></a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="did.html"><a href="did.html#comparison-with-standardization"><i class="fa fa-check"></i><b>7.2</b> Comparison with Standardization<span></span></a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="did.html"><a href="did.html#doublewhatifdat"><i class="fa fa-check"></i><b>7.2.1</b> <code>doublewhatifdat</code><span></span></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="frontdoor.html"><a href="frontdoor.html"><i class="fa fa-check"></i><b>8</b> Front-Door Method<span></span></a>
<ul>
<li class="chapter" data-level="8.1" data-path="frontdoor.html"><a href="frontdoor.html#motivation"><i class="fa fa-check"></i><b>8.1</b> Motivation<span></span></a></li>
<li class="chapter" data-level="8.2" data-path="frontdoor.html"><a href="frontdoor.html#theory-and-method"><i class="fa fa-check"></i><b>8.2</b> Theory and Method<span></span></a></li>
<li class="chapter" data-level="8.3" data-path="frontdoor.html"><a href="frontdoor.html#simulated-example"><i class="fa fa-check"></i><b>8.3</b> Simulated Example<span></span></a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="instrument.html"><a href="instrument.html"><i class="fa fa-check"></i><b>9</b> Instrumental Variables<span></span></a>
<ul>
<li class="chapter" data-level="9.1" data-path="instrument.html"><a href="instrument.html#complier-average-causal-effect-and-principal-stratification"><i class="fa fa-check"></i><b>9.1</b> Complier Average Causal Effect and Principal Stratification<span></span></a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="instrument.html"><a href="instrument.html#principal-stratification"><i class="fa fa-check"></i><b>9.1.1</b> Principal Stratification<span></span></a></li>
<li class="chapter" data-level="9.1.2" data-path="instrument.html"><a href="instrument.html#complier-average-causal-effect"><i class="fa fa-check"></i><b>9.1.2</b> Complier Average Causal Effect<span></span></a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="instrument.html"><a href="instrument.html#average-effect-of-treatment-on-the-treated-and-structural-nested-mean-models"><i class="fa fa-check"></i><b>9.2</b> Average Effect of Treatment on the Treated and Structural Nested mean Models<span></span></a></li>
<li class="chapter" data-level="9.3" data-path="instrument.html"><a href="instrument.html#examples-3"><i class="fa fa-check"></i><b>9.3</b> Examples<span></span></a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="instrument.html"><a href="instrument.html#what-if-study-4"><i class="fa fa-check"></i><b>9.3.1</b> What-If Study<span></span></a></li>
<li class="chapter" data-level="9.3.2" data-path="instrument.html"><a href="instrument.html#double-what-if-study-2"><i class="fa fa-check"></i><b>9.3.2</b> Double What-if Study<span></span></a></li>
</ul></li>
</ul></li>
<li class="appendix"><span><b>Appendix<span></span></b></span></li>
<li class="chapter" data-level="A" data-path="errata.html"><a href="errata.html"><i class="fa fa-check"></i><b>A</b> Errata<span></span></a>
<ul>
<li class="chapter" data-level="A.1" data-path="errata.html"><a href="errata.html#preface"><i class="fa fa-check"></i><b>A.1</b> Preface<span></span></a></li>
<li class="chapter" data-level="A.2" data-path="errata.html"><a href="errata.html#chapter-1"><i class="fa fa-check"></i><b>A.2</b> Chapter 1<span></span></a>
<ul>
<li class="chapter" data-level="A.2.1" data-path="errata.html"><a href="errata.html#section-1.2.3.2-p.-11"><i class="fa fa-check"></i><b>A.2.1</b> Section 1.2.3.2, p.Â 11<span></span></a></li>
</ul></li>
<li class="chapter" data-level="A.3" data-path="errata.html"><a href="errata.html#chapter-2"><i class="fa fa-check"></i><b>A.3</b> Chapter 2<span></span></a>
<ul>
<li class="chapter" data-level="A.3.1" data-path="errata.html"><a href="errata.html#section-2.4-compute-the-standard-error"><i class="fa fa-check"></i><b>A.3.1</b> section 2.4 Compute the standard error<span></span></a></li>
<li class="chapter" data-level="A.3.2" data-path="errata.html"><a href="errata.html#figure-2.1-p.-30"><i class="fa fa-check"></i><b>A.3.2</b> Figure 2.1, p.Â 30<span></span></a></li>
</ul></li>
<li class="chapter" data-level="A.4" data-path="errata.html"><a href="errata.html#chapter-3"><i class="fa fa-check"></i><b>A.4</b> Chapter 3<span></span></a>
<ul>
<li class="chapter" data-level="A.4.1" data-path="errata.html"><a href="errata.html#typography-section-3.2-p.-40-equation-3.1"><i class="fa fa-check"></i><b>A.4.1</b> Typography: section 3.2 p.Â 40, equation 3.1<span></span></a></li>
</ul></li>
<li class="chapter" data-level="A.5" data-path="errata.html"><a href="errata.html#chapter-4"><i class="fa fa-check"></i><b>A.5</b> Chapter 4<span></span></a>
<ul>
<li class="chapter" data-level="A.5.1" data-path="errata.html"><a href="errata.html#section-4.1-p.-67-on-top"><i class="fa fa-check"></i><b>A.5.1</b> Section 4.1 p.Â 67 (on top)<span></span></a></li>
</ul></li>
<li class="chapter" data-level="A.6" data-path="errata.html"><a href="errata.html#chapter-5"><i class="fa fa-check"></i><b>A.6</b> Chapter 5<span></span></a></li>
<li class="chapter" data-level="A.7" data-path="errata.html"><a href="errata.html#chapter-6"><i class="fa fa-check"></i><b>A.7</b> Chapter 6<span></span></a>
<ul>
<li class="chapter" data-level="A.7.1" data-path="errata.html"><a href="errata.html#section-6.1-p.-100-first-paragraph"><i class="fa fa-check"></i><b>A.7.1</b> Section 6.1 p.Â 100, first paragraph<span></span></a></li>
<li class="chapter" data-level="A.7.2" data-path="errata.html"><a href="errata.html#section-6.3-p.-126-the-script-of-simdr"><i class="fa fa-check"></i><b>A.7.2</b> Section 6.3 p.Â 126, the script of <code>simdr</code><span></span></a></li>
</ul></li>
<li class="chapter" data-level="A.8" data-path="errata.html"><a href="errata.html#chapter-7"><i class="fa fa-check"></i><b>A.8</b> Chapter 7<span></span></a>
<ul>
<li class="chapter" data-level="A.8.1" data-path="errata.html"><a href="errata.html#section-7.2-equation-7.11-p.-139"><i class="fa fa-check"></i><b>A.8.1</b> Section 7.2, equation (7.11), p.Â 139<span></span></a></li>
<li class="chapter" data-level="A.8.2" data-path="errata.html"><a href="errata.html#exercise-2"><i class="fa fa-check"></i><b>A.8.2</b> Exercise 2<span></span></a></li>
</ul></li>
<li class="chapter" data-level="A.9" data-path="errata.html"><a href="errata.html#chapter-8"><i class="fa fa-check"></i><b>A.9</b> Chapter 8<span></span></a>
<ul>
<li class="chapter" data-level="A.9.1" data-path="errata.html"><a href="errata.html#section-8.2-p.-150"><i class="fa fa-check"></i><b>A.9.1</b> Section 8.2, p.Â 150<span></span></a></li>
</ul></li>
<li class="chapter" data-level="A.10" data-path="errata.html"><a href="errata.html#chapter-9"><i class="fa fa-check"></i><b>A.10</b> Chapter 9<span></span></a>
<ul>
<li class="chapter" data-level="A.10.1" data-path="errata.html"><a href="errata.html#beginning-of-chapter-p.-158"><i class="fa fa-check"></i><b>A.10.1</b> Beginning of chapter, p.Â 158<span></span></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="B" data-path="notes.html"><a href="notes.html"><i class="fa fa-check"></i><b>B</b> Notes<span></span></a>
<ul>
<li class="chapter" data-level="B.1" data-path="notes.html"><a href="notes.html#chapter-2-1"><i class="fa fa-check"></i><b>B.1</b> Chapter 2<span></span></a>
<ul>
<li class="chapter" data-level="B.1.1" data-path="notes.html"><a href="notes.html#section-2.4-p.-31"><i class="fa fa-check"></i><b>B.1.1</b> section 2.4 p.Â 31<span></span></a></li>
</ul></li>
<li class="chapter" data-level="B.2" data-path="notes.html"><a href="notes.html#chapter-4-1"><i class="fa fa-check"></i><b>B.2</b> Chapter 4<span></span></a>
<ul>
<li class="chapter" data-level="B.2.1" data-path="notes.html"><a href="notes.html#section-4.1"><i class="fa fa-check"></i><b>B.2.1</b> Section 4.1<span></span></a></li>
<li class="chapter" data-level="B.2.2" data-path="notes.html"><a href="notes.html#section-4.2"><i class="fa fa-check"></i><b>B.2.2</b> Section 4.2<span></span></a></li>
<li class="chapter" data-level="B.2.3" data-path="notes.html"><a href="notes.html#exercises-6"><i class="fa fa-check"></i><b>B.2.3</b> Exercises<span></span></a></li>
</ul></li>
<li class="chapter" data-level="B.3" data-path="notes.html"><a href="notes.html#chapter-6-1"><i class="fa fa-check"></i><b>B.3</b> Chapter 6<span></span></a>
<ul>
<li class="chapter" data-level="B.3.1" data-path="notes.html"><a href="notes.html#section-6.1.1-att"><i class="fa fa-check"></i><b>B.3.1</b> Section 6.1.1 ATT<span></span></a></li>
<li class="chapter" data-level="B.3.2" data-path="notes.html"><a href="notes.html#section-6.3"><i class="fa fa-check"></i><b>B.3.2</b> Section 6.3<span></span></a></li>
</ul></li>
<li class="chapter" data-level="B.4" data-path="notes.html"><a href="notes.html#chapter-9-1"><i class="fa fa-check"></i><b>B.4</b> Chapter 9<span></span></a>
<ul>
<li class="chapter" data-level="B.4.1" data-path="notes.html"><a href="notes.html#section-9.3"><i class="fa fa-check"></i><b>B.4.1</b> Section 9.3<span></span></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="C" data-path="linreg.html"><a href="linreg.html"><i class="fa fa-check"></i><b>C</b> Linear Regression with R<span></span></a>
<ul>
<li class="chapter" data-level="C.1" data-path="linreg.html"><a href="linreg.html#model"><i class="fa fa-check"></i><b>C.1</b> Model<span></span></a></li>
<li class="chapter" data-level="C.2" data-path="linreg.html"><a href="linreg.html#fitted-vs-predict"><i class="fa fa-check"></i><b>C.2</b> <code>fitted()</code> vs <code>predict()</code><span></span></a>
<ul>
<li class="chapter" data-level="C.2.1" data-path="linreg.html"><a href="linreg.html#fitted"><i class="fa fa-check"></i><b>C.2.1</b> <code>fitted()</code><span></span></a></li>
<li class="chapter" data-level="C.2.2" data-path="linreg.html"><a href="linreg.html#predict"><i class="fa fa-check"></i><b>C.2.2</b> <code>predict()</code><span></span></a></li>
<li class="chapter" data-level="C.2.3" data-path="linreg.html"><a href="linreg.html#conclusion"><i class="fa fa-check"></i><b>C.2.3</b> Conclusion<span></span></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="D" data-path="mc_standdr.html"><a href="mc_standdr.html"><i class="fa fa-check"></i><b>D</b> Doubly Robust Simulation<span></span></a>
<ul>
<li class="chapter" data-level="D.1" data-path="mc_standdr.html"><a href="mc_standdr.html#errata6a"><i class="fa fa-check"></i><b>D.1</b> Analyse <span class="math inline">\(T = \sum_{i=1}^J{T_i}\)</span> (Errata)<span></span></a></li>
<li class="chapter" data-level="D.2" data-path="mc_standdr.html"><a href="mc_standdr.html#analyse-y-sum_i1i-y_i"><i class="fa fa-check"></i><b>D.2</b> Analyse <span class="math inline">\(Y = \sum_{i=1}^I Y_i\)</span><span></span></a></li>
<li class="chapter" data-level="D.3" data-path="mc_standdr.html"><a href="mc_standdr.html#functions"><i class="fa fa-check"></i><b>D.3</b> Functions<span></span></a></li>
<li class="chapter" data-level="D.4" data-path="mc_standdr.html"><a href="mc_standdr.html#scripts"><i class="fa fa-check"></i><b>D.4</b> Scripts<span></span></a>
<ul>
<li class="chapter" data-level="D.4.1" data-path="mc_standdr.html"><a href="mc_standdr.html#simdr"><i class="fa fa-check"></i><b>D.4.1</b> <code>simdr</code><span></span></a></li>
<li class="chapter" data-level="D.4.2" data-path="mc_standdr.html"><a href="mc_standdr.html#mc_standdr-1"><i class="fa fa-check"></i><b>D.4.2</b> <code>mc_standdr</code><span></span></a></li>
</ul></li>
</ul></li>
<li><a href="references.html#references">References<span></span></a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Study project: Fundamentals of Causal Inferences With R Tidyverse</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="mc_standdr" class="section level1 hasAnchor" number="13">
<h1><span class="header-section-number">D</span> Doubly Robust Simulation<a href="mc_standdr.html#mc_standdr" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="errata6a" class="section level2 hasAnchor" number="13.1">
<h2><span class="header-section-number">D.1</span> Analyse <span class="math inline">\(T = \sum_{i=1}^J{T_i}\)</span> (Errata)<a href="mc_standdr.html#errata6a" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Section 6.3 claims that <span class="math inline">\(T=600\)</span> and <span class="math inline">\(P(T=1 \mid H) \in [0.041, 0.0468]\)</span>
but the results obtained from running <code>simdr</code> as shown in the book are different.
Not a lot but enough to puzzle the avid reader (like me for example).</p>
<p>So lets go through <code>simdr</code> to explain the differences.</p>
<div class="sourceCode" id="cb302"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb302-1"><a href="mc_standdr.html#cb302-1" aria-hidden="true" tabindex="-1"></a>simdr.out <span class="ot">&lt;-</span> <span class="fu">simdr</span>(<span class="at">seed =</span> <span class="dv">1009</span>)<span class="sc">$</span>stats</span></code></pre></div>
<blockquote>
<p>One might think that standardization with the exposure model would be
preferable when the outcome indicates a rare condition. To see this,
first suppose the condition is not rare. We might have 3000 individuals and 50%,
or 1500, with the condition. Using the rule of thumb for logistic regression
of Peduzzi et al.Â presented in chapter 2, we should be able to include 150
covariates in the outcome model.</p>
</blockquote>
<p>The Peduzzi rule can be found at the end of section 2.3, on top of p.Â 29. where
it states that</p>
<blockquote>
<p>both the numbers of individuals with <span class="math inline">\(Y=0\)</span> and <span class="math inline">\(Y=1\)</span> need to be larger than
ten times the number of parameters.</p>
</blockquote>
<p>and therefore</p>
<blockquote>
<p>Now suppose the exposure, <span class="math inline">\(T\)</span>, is divided more evenly: that is, we have 600
with <span class="math inline">\(T=1\)</span>. This would suggest we can include 60 covariates in the exposure model.</p>
</blockquote>
<p>Brumback uses a linear function of <span class="math inline">\(H\)</span> to create a distribution of <span class="math inline">\(T_i\)</span> that makes
it dependent on <span class="math inline">\(H\)</span> and which should give <span class="math inline">\(\sum T_i \approx 600\)</span>.
However, <em>the simulation with <code>simdr</code> returns <span class="math inline">\(\sum T_i \approx 540\)</span></em>.</p>
<div class="sourceCode" id="cb303"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb303-1"><a href="mc_standdr.html#cb303-1" aria-hidden="true" tabindex="-1"></a><span class="co"># sum of T</span></span>
<span id="cb303-2"><a href="mc_standdr.html#cb303-2" aria-hidden="true" tabindex="-1"></a>simdr.out<span class="sc">$</span><span class="st">`</span><span class="at">T</span><span class="st">`</span><span class="sc">$</span>sum</span></code></pre></div>
<pre><code>## [1] 541</code></pre>
<div id="errata1" class="greeting message" style="color: red;">
<p>We observe that <span class="math inline">\(\sum_i T_i \approx 540 \not \approx 600\)</span>.</p>
</div>
<p>This is the part that needs explaining. The difference seems too large to be
explained by the usual culprit, random process.</p>
<p>To be able to do that lets use some notations and go through the mechanics of <code>simdr</code>.</p>
<p>Let <span class="math inline">\(H_{j}\)</span> be the covariate <span class="math inline">\(j\)</span></p>
<p><span class="math display">\[
\begin{align*}
H_j \text{ i.i.d. } \mathcal{Bernoulli}(p), \, j = 1, \ldots, J
\end{align*}
\]</span></p>
<p>where <span class="math inline">\(J\)</span> is the same variable as <span class="math inline">\(ss\)</span> from Brumback, i.e.Â <span class="math inline">\(J = ss = 100\)</span>. Also
<span class="math inline">\(H_{i, j}\)</span> is the value of covariate <span class="math inline">\(H_j\)</span> for individual <span class="math inline">\(i\)</span>.</p>
<p>and let <span class="math inline">\(T_i\)</span> be the treatment of individual <span class="math inline">\(i\)</span></p>
<p><span class="math display">\[
\begin{align*}
T_i \sim \mathcal{Bernoulli}(prob = P_i), \, i = 1, \ldots, I
\end{align*}
\]</span></p>
<p>where <span class="math inline">\(I\)</span> is set at <span class="math inline">\(I=3000\)</span> by Brumback.</p>
<p>In addition, we let</p>
<p><span class="math display">\[
S_i = \sum_{j=1}^{J}H_{i, j} \\
\text{where } J = ss \text{ as mentioned above}
\]</span></p>
<p>and <code>simdr</code> defines <span class="math inline">\(P_i\)</span> as a random variable</p>
<p><span class="math display">\[
\begin{align*}
&amp;P_i = \alpha \frac{\beta}{J} S_i + p \times X_i \\
\\
&amp;\text{where} \\
&amp;\alpha = 0.13 \\
&amp;\beta = 20 \\ 
&amp;p = 0.05 \\
&amp;X_i \sim \mathcal{Normal}(mean = 1, sd = 0.1)
\end{align*}
\]</span></p>
<p>now, since</p>
<p><span class="math display">\[
\begin{align*}
H_i \text{ i.i.d. } \mathcal{Bernoulli}(p) &amp;\implies E(H_i)=p \\
T_i \sim \mathcal{Bernoulli}(p_{i}) &amp;\implies E(T_i) = E(P_i) \\
X_i \sim \mathcal{Normal}(mean = 1, sd = 0.1) &amp;\implies E(X_i) = 1
\end{align*}
\]</span></p>
<p>and since <span class="math inline">\(E()\)</span> is a linear function then</p>
<p><span class="math display">\[
\begin{align*}
E(T_i) &amp;= E(P_i) \\
&amp;= E(\alpha \cdot \frac{\beta}{J} S_i + p \cdot X_i) \\
&amp;= \alpha \cdot \frac{\beta}{J} \sum_{j=1}^{J}E(H_{i, j}) + p \cdot E(X_i) \\
&amp;= \alpha \cdot \frac{\beta}{J} \sum_{j=1}^{J}p + p \cdot 1 \\
&amp;= \alpha \cdot \frac{\beta}{J} \cdot J \cdot p + p \\
&amp;= \alpha \cdot \beta \cdot p + p
\end{align*}
\]</span></p>
<p>and the sum of the number of people treated is <span class="math inline">\(T = \sum_i^IT_i\)</span></p>
<p><span class="math display">\[
\begin{align*}
E(T)  &amp;= \sum_{i=1}^I{E(T_i)} \\
&amp;= \sum_{i=1}^I{(\alpha \cdot \beta \cdot p + p)} \\
&amp;= I (\alpha \cdot \beta \cdot p + p) \\
\\
&amp;\text{and since} \\ 
&amp;I = 3000, \, \alpha = 0.13, \, \beta = 20, \, p = 0.05 \\
\\
&amp;\text{then} \\
E(T) &amp;= 3000 \cdot (0.13 \cdot 20 \cdot 0.05 + 0.05) \\
&amp;= 540
\end{align*}
\]</span></p>
<p>which proves that the expected number of <span class="math inline">\(T\)</span> is not really close to 600 but rather
540 which is also the result of the simulation. Therefore we could use 54
covariates rather than 60 by the Peduzzi rule.</p>
<p>We note that this <em>does not change the conclusions drawn from the simulation
significantly</em>.</p>
<p>Finally, we note that the formula <span class="math inline">\(\alpha \cdot \beta \cdot p + p\)</span> could be
modified to get <span class="math inline">\(T=600\)</span> by varying the coefficient <span class="math inline">\(\alpha=0.13\)</span> and/or <span class="math inline">\(\beta=20\)</span>.
If we change only <span class="math inline">\(\alpha\)</span> and keep <span class="math inline">\(\beta=20\)</span> we could use the result from
above and with simple algebra</p>
<p><span class="math display">\[
\begin{align*}
E(T)&amp;= I (\alpha \cdot \beta \cdot p + p) \\
\\
&amp;\text{and since we want } E(T) = 600 \\
&amp;\text{and that} \\
&amp;\beta = 20, \, I = 3000, \, p = 0.05 \\
\\
\text{then} \\
600 &amp;= 3000 \cdot (\alpha \cdot 20 \cdot 0.05 + 0.05) \\
\alpha &amp;= \frac{600 - 0.05 \cdot 3000}{3000 \cdot 20 \cdot0.05} = \frac{450}{3000} = 0.15
\end{align*}
\]</span></p>
<p>and we simulate using <span class="math inline">\(\alpha = 0.15\)</span> to validate</p>
<div class="sourceCode" id="cb305"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb305-1"><a href="mc_standdr.html#cb305-1" aria-hidden="true" tabindex="-1"></a>simdr600.out <span class="ot">&lt;-</span> <span class="fu">simdr</span>(<span class="at">alpha =</span> <span class="fl">0.15</span>, <span class="at">seed =</span> <span class="dv">1009</span>)<span class="sc">$</span>stats</span>
<span id="cb305-2"><a href="mc_standdr.html#cb305-2" aria-hidden="true" tabindex="-1"></a>simdr600.out<span class="sc">$</span><span class="st">`</span><span class="at">T</span><span class="st">`</span><span class="sc">$</span>sum</span></code></pre></div>
<pre><code>## [1] 593</code></pre>
<div id="suggest1" class="greeting message" style="color: green;">
<p>We suggest that <code>simdr</code> be modified to <strong>use 0.15 instead of 0.13</strong>.</p>
</div>
</div>
<div id="analyse-y-sum_i1i-y_i" class="section level2 hasAnchor" number="13.2">
<h2><span class="header-section-number">D.2</span> Analyse <span class="math inline">\(Y = \sum_{i=1}^I Y_i\)</span><a href="mc_standdr.html#analyse-y-sum_i1i-y_i" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>First we analyse <span class="math inline">\(Y = \sum Y_i\)</span> mathematically using the same notation as above.</p>
<p><span class="math display">\[
\begin{align*}
&amp;\text{as defined in simdr} \\
Y_i &amp;= 0.1 T_i + 0.1 \frac{\beta}{J} S_i \\
\\
&amp;\text{therefore} \\
E(Y_i) &amp;=0.1 E(T_i) + 0.1 \frac{\beta}{J} E(S_i) \\
&amp;= 0.01 E(P_i) + 0.01 \frac{\beta}{J} \sum_{j=1}^J{E(H_{ij})} \\
&amp;= 0.01 \cdot(\alpha \cdot \beta \cdot p + p) + 0.01 \sum_{j=1}^J{p} \\
&amp;= 0.01 \cdot(\alpha \cdot \beta \cdot p + p) + 0.01 \frac{\beta}{J} \cdot J \cdot p\\
&amp;= 0.01 \cdot(\alpha \cdot \beta \cdot p + p) + 0.01 \cdot \beta \cdot p \\
\\
&amp;\text{and given} \\
&amp;\alpha = 0.13, \, \beta = 20, \, p = 0.05 \\
\\
&amp;\text{therefore} \\
E(Y_i) &amp;= 0.01 \cdot(0.13 \cdot 20 \cdot 0.05 + 0.05) + 0.01 \cdot 20 \cdot 0.05 \\
&amp;=0.0013 + 0.0005 + 0.01 \\
&amp;= 0.0118
\end{align*}
\]</span>
and since <span class="math inline">\(Y = \sum_{i=1}^I Y_i\)</span> then</p>
<p><span class="math display">\[
\begin{align*}
Y &amp;= \sum_{i=1}^I Y_i \\
E(Y) &amp;= \sum_{i=1}^I E(Y_i) = I \cdot E(Y_i) \\
\\
&amp;\text{and from above} \\
E(Y_i) &amp;= 0.0118 \\
\\
&amp;\text{therefore} \\
E(Y) &amp;= I \cdot E(Y_i) = 3000 \cdot 0.0118 = 35.4 \\
&amp;\approx 35
\end{align*}
\]</span></p>
<p>which mathematically proves the following</p>
<blockquote>
<p>We simulated <span class="math inline">\(Y_i\)</span> as a function of <span class="math inline">\(T_i\)</span> and <span class="math inline">\(\sum_{k=1}^{ss}H_{i,k}\)</span>,
such that approximately 35 individuals had <span class="math inline">\(Y=1\)</span>.</p>
</blockquote>
<p>and the result we get from both <code>simdr</code> is 38, close enough.</p>
<div class="sourceCode" id="cb307"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb307-1"><a href="mc_standdr.html#cb307-1" aria-hidden="true" tabindex="-1"></a>simdr.out<span class="sc">$</span>Y<span class="sc">$</span>sum</span></code></pre></div>
<pre><code>## [1] 38</code></pre>
<blockquote>
<p>The mean of <span class="math inline">\(\sum_{k=1}^{ss}{H_{ik}}\)</span> was fixed at one, but when <span class="math inline">\(ss\)</span> was set to
100, it ranged from 0.00 to 2.80.</p>
</blockquote>
<p>That is exactly what we get.</p>
<div class="sourceCode" id="cb309"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb309-1"><a href="mc_standdr.html#cb309-1" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="st">&quot;min&quot;</span> <span class="ot">=</span> simdr.out<span class="sc">$</span>sumH<span class="sc">$</span>min, <span class="st">&quot;max&quot;</span> <span class="ot">=</span> simdr.out<span class="sc">$</span>sumH<span class="sc">$</span>max)</span></code></pre></div>
<pre><code>## min max 
## 0.0 2.8</code></pre>
<p>then</p>
<blockquote>
<p><span class="math inline">\(P(T = 1 \mid H)\)</span> ranged from 0.041 to 0.468.</p>
</blockquote>
<div id="errata2" class="greeting message" style="color: red;">
<p>The results are different.</p>
</div>
<div class="sourceCode" id="cb311"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb311-1"><a href="mc_standdr.html#cb311-1" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="st">&quot;min&quot;</span> <span class="ot">=</span> simdr.out<span class="sc">$</span>probT<span class="sc">$</span>min, <span class="st">&quot;max&quot;</span> <span class="ot">=</span> simdr.out<span class="sc">$</span>probT<span class="sc">$</span>max)</span></code></pre></div>
<pre><code>##        min        max 
## 0.03873516 0.41876534</code></pre>
<p>Probably because the original simulation came up with <span class="math inline">\(T=600\)</span> rather than
<span class="math inline">\(T=540\)</span> as discussed above. Indeed if we verify with the simulation with
<span class="math inline">\(T=600\)</span> the results are now reasonably close.</p>
<div class="sourceCode" id="cb313"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb313-1"><a href="mc_standdr.html#cb313-1" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="st">&quot;min&quot;</span> <span class="ot">=</span> simdr600.out<span class="sc">$</span>probT<span class="sc">$</span>min, <span class="st">&quot;max&quot;</span> <span class="ot">=</span> simdr600.out<span class="sc">$</span>probT<span class="sc">$</span>max)</span></code></pre></div>
<pre><code>##        min        max 
## 0.03873516 0.47476534</code></pre>
<blockquote>
<p><span class="math inline">\(E(Y \mid T, H)\)</span> ranged from 0.000 to 0.036.</p>
</blockquote>
<p>and the results are almost identical</p>
<div class="sourceCode" id="cb315"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb315-1"><a href="mc_standdr.html#cb315-1" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="st">&quot;min&quot;</span> <span class="ot">=</span> simdr.out<span class="sc">$</span>probY<span class="sc">$</span>min, <span class="st">&quot;max&quot;</span> <span class="ot">=</span> simdr.out<span class="sc">$</span>probY<span class="sc">$</span>max)</span></code></pre></div>
<pre><code>##   min   max 
## 0.000 0.038</code></pre>
</div>
<div id="functions" class="section level2 hasAnchor" number="13.3">
<h2><span class="header-section-number">D.3</span> Functions<a href="mc_standdr.html#functions" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The function <code>simdr</code> is found on p.Â 127-128. See the script in the last section
of this appendix. We just added some arguments and and output to facilitate the
analysis. See the next section <em>Analysis</em>.</p>
<p>The Monte Carlo simulation is done with a non-parametric Monte Carlo function
<code>mc_standdr</code> with the following script. See the section <em>Simulation</em> blow.</p>
<p>Note that <code>simdr</code> was rewritten as function <code>mc_standdr</code> to</p>
<ul>
<li>facilitate the analysis of the algorithm</li>
<li>perform a Monte Carlo simulation with the <code>MonteCarlo</code> package</li>
<li>separate the data simulation from the measurement of estimates in 2 sub functions
<ul>
<li><code>standdr_sim</code>: Simulate the data</li>
<li><code>standdr_est</code>: Calculate the estimates using the simulated data from <code>standdr_sim</code></li>
</ul></li>
</ul>
<p><code>mc_standdr</code> and <code>simdr</code> give exactly the same results for the simulatted data</p>
<div class="sourceCode" id="cb317"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb317-1"><a href="mc_standdr.html#cb317-1" aria-hidden="true" tabindex="-1"></a>simdr.out <span class="ot">&lt;-</span> <span class="fu">simdr</span>(<span class="at">seed =</span> <span class="dv">1009</span>)</span>
<span id="cb317-2"><a href="mc_standdr.html#cb317-2" aria-hidden="true" tabindex="-1"></a>new_simdr.out <span class="ot">&lt;-</span> <span class="fu">standdr_sim</span>(<span class="at">seed =</span> <span class="dv">1009</span>)</span>
<span id="cb317-3"><a href="mc_standdr.html#cb317-3" aria-hidden="true" tabindex="-1"></a><span class="fu">stopifnot</span>(<span class="fu">identical</span>(simdr.out<span class="sc">$</span>stats, new_simdr.out<span class="sc">$</span>stats))</span></code></pre></div>
<p>as well as the measurements</p>
<div class="sourceCode" id="cb318"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb318-1"><a href="mc_standdr.html#cb318-1" aria-hidden="true" tabindex="-1"></a>new_simdr.est <span class="ot">&lt;-</span> <span class="fu">standdr_est</span>(<span class="at">Y =</span> new_simdr.out<span class="sc">$</span>data<span class="sc">$</span>Y,</span>
<span id="cb318-2"><a href="mc_standdr.html#cb318-2" aria-hidden="true" tabindex="-1"></a>                             <span class="st">`</span><span class="at">T</span><span class="st">`</span> <span class="ot">=</span> new_simdr.out<span class="sc">$</span>data<span class="sc">$</span><span class="st">`</span><span class="at">T</span><span class="st">`</span>,</span>
<span id="cb318-3"><a href="mc_standdr.html#cb318-3" aria-hidden="true" tabindex="-1"></a>                             <span class="at">H =</span> new_simdr.out<span class="sc">$</span>data<span class="sc">$</span>H)</span>
<span id="cb318-4"><a href="mc_standdr.html#cb318-4" aria-hidden="true" tabindex="-1"></a><span class="fu">stopifnot</span>(<span class="fu">identical</span>(simdr.out<span class="sc">$</span>est, new_simdr.est))</span></code></pre></div>
</div>
<div id="scripts" class="section level2 hasAnchor" number="13.4">
<h2><span class="header-section-number">D.4</span> Scripts<a href="mc_standdr.html#scripts" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="simdr" class="section level3 hasAnchor" number="13.4.1">
<h3><span class="header-section-number">D.4.1</span> <code>simdr</code><a href="mc_standdr.html#simdr" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb319"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb319-1"><a href="mc_standdr.html#cb319-1" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; Doubly Robust Standardization Simulation</span></span>
<span id="cb319-2"><a href="mc_standdr.html#cb319-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; </span></span>
<span id="cb319-3"><a href="mc_standdr.html#cb319-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; Doubly robust standardization simulation.</span></span>
<span id="cb319-4"><a href="mc_standdr.html#cb319-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; </span></span>
<span id="cb319-5"><a href="mc_standdr.html#cb319-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; This is the function used in \emph{Fundamentals of Causal Inference} by</span></span>
<span id="cb319-6"><a href="mc_standdr.html#cb319-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; B. Brumback in section 6.3 of chapter 6, p.127-128. \code{standdr_stats} is</span></span>
<span id="cb319-7"><a href="mc_standdr.html#cb319-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; used in the output to give more statistics. Also the arguments </span></span>
<span id="cb319-8"><a href="mc_standdr.html#cb319-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; \code{beta = 0.13} and \code{gamma = 20} were necessary to analyse the</span></span>
<span id="cb319-9"><a href="mc_standdr.html#cb319-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; algorithm, they don&#39;t change anything.</span></span>
<span id="cb319-10"><a href="mc_standdr.html#cb319-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39;</span></span>
<span id="cb319-11"><a href="mc_standdr.html#cb319-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param ss Number of covariates i.i.d with \code{rbinom(n, size=1, prob=probH)}</span></span>
<span id="cb319-12"><a href="mc_standdr.html#cb319-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param alpha coefficient used to compute the distribution of \code{`T`}.</span></span>
<span id="cb319-13"><a href="mc_standdr.html#cb319-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param beta coefficient used to compute the distribution of \code{`T`}.</span></span>
<span id="cb319-14"><a href="mc_standdr.html#cb319-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param seed Seed used for random number generation, default is \code{NULL}.</span></span>
<span id="cb319-15"><a href="mc_standdr.html#cb319-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39;</span></span>
<span id="cb319-16"><a href="mc_standdr.html#cb319-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @return List of statistics for thesimulated data and estimates using</span></span>
<span id="cb319-17"><a href="mc_standdr.html#cb319-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; different merhods.</span></span>
<span id="cb319-18"><a href="mc_standdr.html#cb319-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39;</span></span>
<span id="cb319-19"><a href="mc_standdr.html#cb319-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @examples</span></span>
<span id="cb319-20"><a href="mc_standdr.html#cb319-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; \dontrun{</span></span>
<span id="cb319-21"><a href="mc_standdr.html#cb319-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; simdr()</span></span>
<span id="cb319-22"><a href="mc_standdr.html#cb319-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; }</span></span>
<span id="cb319-23"><a href="mc_standdr.html#cb319-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @export</span></span>
<span id="cb319-24"><a href="mc_standdr.html#cb319-24" aria-hidden="true" tabindex="-1"></a>simdr <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">ss =</span> <span class="dv">100</span>, <span class="at">alpha =</span> <span class="fl">0.13</span>, <span class="at">beta =</span> <span class="dv">20</span>, <span class="at">seed =</span> <span class="cn">NULL</span>) {</span>
<span id="cb319-25"><a href="mc_standdr.html#cb319-25" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb319-26"><a href="mc_standdr.html#cb319-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set.seed</span>(seed)</span>
<span id="cb319-27"><a href="mc_standdr.html#cb319-27" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb319-28"><a href="mc_standdr.html#cb319-28" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ss is the number of confounders</span></span>
<span id="cb319-29"><a href="mc_standdr.html#cb319-29" aria-hidden="true" tabindex="-1"></a>  <span class="co"># i.e. the number of columns of H</span></span>
<span id="cb319-30"><a href="mc_standdr.html#cb319-30" aria-hidden="true" tabindex="-1"></a>  H <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="dv">3000</span>, ss)</span>
<span id="cb319-31"><a href="mc_standdr.html#cb319-31" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Let all components of H be independent Bernoulli variables with p=0.05</span></span>
<span id="cb319-32"><a href="mc_standdr.html#cb319-32" aria-hidden="true" tabindex="-1"></a>  probH <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fl">0.05</span>, <span class="dv">3000</span>)</span>
<span id="cb319-33"><a href="mc_standdr.html#cb319-33" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>ss) {</span>
<span id="cb319-34"><a href="mc_standdr.html#cb319-34" aria-hidden="true" tabindex="-1"></a>    H[, i] <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="at">n =</span> <span class="dv">3000</span>, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">prob =</span> probH)</span>
<span id="cb319-35"><a href="mc_standdr.html#cb319-35" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb319-36"><a href="mc_standdr.html#cb319-36" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Let the treatment depend on a function of H</span></span>
<span id="cb319-37"><a href="mc_standdr.html#cb319-37" aria-hidden="true" tabindex="-1"></a>  sumH <span class="ot">&lt;-</span> <span class="fu">apply</span>(H, <span class="dv">1</span>, sum) <span class="sc">*</span> beta <span class="sc">/</span> ss</span>
<span id="cb319-38"><a href="mc_standdr.html#cb319-38" aria-hidden="true" tabindex="-1"></a>  <span class="co"># make sure P(T=1) is between 0 and 1, i.e. positivity assumption</span></span>
<span id="cb319-39"><a href="mc_standdr.html#cb319-39" aria-hidden="true" tabindex="-1"></a>  probT <span class="ot">&lt;-</span> alpha <span class="sc">*</span> sumH <span class="sc">+</span> <span class="fl">0.05</span> <span class="sc">*</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">3000</span>, <span class="at">mean =</span> <span class="dv">1</span>, <span class="at">sd =</span> <span class="fl">0.1</span>)</span>
<span id="cb319-40"><a href="mc_standdr.html#cb319-40" aria-hidden="true" tabindex="-1"></a>  <span class="co"># validate the positivity assumption</span></span>
<span id="cb319-41"><a href="mc_standdr.html#cb319-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stopifnot</span>(probT <span class="sc">&gt;</span> <span class="dv">0</span>, probT <span class="sc">&lt;</span> <span class="dv">1</span>)</span>
<span id="cb319-42"><a href="mc_standdr.html#cb319-42" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb319-43"><a href="mc_standdr.html#cb319-43" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">T</span><span class="st">`</span> <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="at">n =</span> <span class="dv">3000</span>, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">prob =</span> probT)</span>
<span id="cb319-44"><a href="mc_standdr.html#cb319-44" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb319-45"><a href="mc_standdr.html#cb319-45" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Generate the outcome depend on T and H</span></span>
<span id="cb319-46"><a href="mc_standdr.html#cb319-46" aria-hidden="true" tabindex="-1"></a>  probY <span class="ot">&lt;-</span> <span class="fl">0.01</span> <span class="sc">*</span> <span class="st">`</span><span class="at">T</span><span class="st">`</span> <span class="sc">+</span> <span class="fl">0.01</span> <span class="sc">*</span> sumH</span>
<span id="cb319-47"><a href="mc_standdr.html#cb319-47" aria-hidden="true" tabindex="-1"></a>  <span class="co"># positivity assumption is not required for the outcome</span></span>
<span id="cb319-48"><a href="mc_standdr.html#cb319-48" aria-hidden="true" tabindex="-1"></a>  <span class="co"># see intro to chapter 6 p. 99</span></span>
<span id="cb319-49"><a href="mc_standdr.html#cb319-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stopifnot</span>(probY <span class="sc">&gt;=</span> <span class="dv">0</span>, probY <span class="sc">&lt;=</span> <span class="dv">1</span>)</span>
<span id="cb319-50"><a href="mc_standdr.html#cb319-50" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb319-51"><a href="mc_standdr.html#cb319-51" aria-hidden="true" tabindex="-1"></a>  Y <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="at">n =</span> <span class="dv">3000</span>, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">prob =</span> probY)</span>
<span id="cb319-52"><a href="mc_standdr.html#cb319-52" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb319-53"><a href="mc_standdr.html#cb319-53" aria-hidden="true" tabindex="-1"></a>  <span class="co"># put the simulated resuts in a list</span></span>
<span id="cb319-54"><a href="mc_standdr.html#cb319-54" aria-hidden="true" tabindex="-1"></a>  stats <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;sumH&quot;</span> <span class="ot">=</span> <span class="fu">simdr_stats</span>(sumH),</span>
<span id="cb319-55"><a href="mc_standdr.html#cb319-55" aria-hidden="true" tabindex="-1"></a>              <span class="st">&quot;probT&quot;</span> <span class="ot">=</span> <span class="fu">simdr_stats</span>(probT),</span>
<span id="cb319-56"><a href="mc_standdr.html#cb319-56" aria-hidden="true" tabindex="-1"></a>              <span class="st">&quot;T&quot;</span> <span class="ot">=</span> <span class="fu">simdr_stats</span>(<span class="st">`</span><span class="at">T</span><span class="st">`</span>),</span>
<span id="cb319-57"><a href="mc_standdr.html#cb319-57" aria-hidden="true" tabindex="-1"></a>              <span class="st">&quot;probY&quot;</span> <span class="ot">=</span> <span class="fu">simdr_stats</span>(probY),</span>
<span id="cb319-58"><a href="mc_standdr.html#cb319-58" aria-hidden="true" tabindex="-1"></a>              <span class="st">&quot;Y&quot;</span> <span class="ot">=</span> <span class="fu">simdr_stats</span>(Y))</span>
<span id="cb319-59"><a href="mc_standdr.html#cb319-59" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb319-60"><a href="mc_standdr.html#cb319-60" aria-hidden="true" tabindex="-1"></a>  <span class="co"># fit the exposure model</span></span>
<span id="cb319-61"><a href="mc_standdr.html#cb319-61" aria-hidden="true" tabindex="-1"></a>  e <span class="ot">&lt;-</span> <span class="fu">fitted</span>(<span class="fu">lm</span>(<span class="st">`</span><span class="at">T</span><span class="st">`</span> <span class="sc">~</span> H))</span>
<span id="cb319-62"><a href="mc_standdr.html#cb319-62" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb319-63"><a href="mc_standdr.html#cb319-63" aria-hidden="true" tabindex="-1"></a>  <span class="co"># refit the exposure model using an incorrect logistic model</span></span>
<span id="cb319-64"><a href="mc_standdr.html#cb319-64" aria-hidden="true" tabindex="-1"></a>  e2 <span class="ot">&lt;-</span> <span class="fu">predict</span>(<span class="fu">glm</span>(<span class="st">`</span><span class="at">T</span><span class="st">`</span> <span class="sc">~</span> H, <span class="at">family =</span> <span class="st">&quot;binomial&quot;</span>), <span class="at">type =</span> <span class="st">&quot;response&quot;</span>)</span>
<span id="cb319-65"><a href="mc_standdr.html#cb319-65" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb319-66"><a href="mc_standdr.html#cb319-66" aria-hidden="true" tabindex="-1"></a>  <span class="co"># compute the weights</span></span>
<span id="cb319-67"><a href="mc_standdr.html#cb319-67" aria-hidden="true" tabindex="-1"></a>  w0 <span class="ot">&lt;-</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="st">`</span><span class="at">T</span><span class="st">`</span>) <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">-</span> e)</span>
<span id="cb319-68"><a href="mc_standdr.html#cb319-68" aria-hidden="true" tabindex="-1"></a>  w1 <span class="ot">&lt;-</span> <span class="st">`</span><span class="at">T</span><span class="st">`</span> <span class="sc">/</span> e</span>
<span id="cb319-69"><a href="mc_standdr.html#cb319-69" aria-hidden="true" tabindex="-1"></a>  w02 <span class="ot">&lt;-</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="st">`</span><span class="at">T</span><span class="st">`</span>) <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">-</span> e2)</span>
<span id="cb319-70"><a href="mc_standdr.html#cb319-70" aria-hidden="true" tabindex="-1"></a>  w12 <span class="ot">&lt;-</span> T <span class="sc">/</span> e2</span>
<span id="cb319-71"><a href="mc_standdr.html#cb319-71" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb319-72"><a href="mc_standdr.html#cb319-72" aria-hidden="true" tabindex="-1"></a>  <span class="co"># fit an overspecified (saturated) outcome model</span></span>
<span id="cb319-73"><a href="mc_standdr.html#cb319-73" aria-hidden="true" tabindex="-1"></a>  mod.out <span class="ot">&lt;-</span> <span class="fu">lm</span>(Y <span class="sc">~</span> <span class="st">`</span><span class="at">T</span><span class="st">`</span> <span class="sc">*</span> H)</span>
<span id="cb319-74"><a href="mc_standdr.html#cb319-74" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb319-75"><a href="mc_standdr.html#cb319-75" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Estimate the expected potential outcomes using the various methods</span></span>
<span id="cb319-76"><a href="mc_standdr.html#cb319-76" aria-hidden="true" tabindex="-1"></a>  dat <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="st">&quot;Y&quot;</span> <span class="ot">=</span> Y, <span class="st">&quot;T&quot;</span> <span class="ot">=</span> <span class="st">`</span><span class="at">T</span><span class="st">`</span>)</span>
<span id="cb319-77"><a href="mc_standdr.html#cb319-77" aria-hidden="true" tabindex="-1"></a>  dat0 <span class="ot">&lt;-</span> dat</span>
<span id="cb319-78"><a href="mc_standdr.html#cb319-78" aria-hidden="true" tabindex="-1"></a>  dat0<span class="sc">$</span><span class="st">`</span><span class="at">T</span><span class="st">`</span> <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb319-79"><a href="mc_standdr.html#cb319-79" aria-hidden="true" tabindex="-1"></a>  dat1 <span class="ot">&lt;-</span> dat</span>
<span id="cb319-80"><a href="mc_standdr.html#cb319-80" aria-hidden="true" tabindex="-1"></a>  dat1<span class="sc">$</span><span class="st">`</span><span class="at">T</span><span class="st">`</span> <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb319-81"><a href="mc_standdr.html#cb319-81" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb319-82"><a href="mc_standdr.html#cb319-82" aria-hidden="true" tabindex="-1"></a>  <span class="co"># the predicted data</span></span>
<span id="cb319-83"><a href="mc_standdr.html#cb319-83" aria-hidden="true" tabindex="-1"></a>  preds0 <span class="ot">&lt;-</span> <span class="fu">predict</span>(mod.out, <span class="at">newdata =</span> dat0)</span>
<span id="cb319-84"><a href="mc_standdr.html#cb319-84" aria-hidden="true" tabindex="-1"></a>  preds1 <span class="ot">&lt;-</span> <span class="fu">predict</span>(mod.out, <span class="at">newdata =</span> dat1)</span>
<span id="cb319-85"><a href="mc_standdr.html#cb319-85" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb319-86"><a href="mc_standdr.html#cb319-86" aria-hidden="true" tabindex="-1"></a>  <span class="co"># calculate the estimates</span></span>
<span id="cb319-87"><a href="mc_standdr.html#cb319-87" aria-hidden="true" tabindex="-1"></a>  EYT0 <span class="ot">&lt;-</span> <span class="fu">mean</span>(Y <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="st">`</span><span class="at">T</span><span class="st">`</span>))</span>
<span id="cb319-88"><a href="mc_standdr.html#cb319-88" aria-hidden="true" tabindex="-1"></a>  EYT1 <span class="ot">&lt;-</span> <span class="fu">mean</span>(Y <span class="sc">*</span> <span class="st">`</span><span class="at">T</span><span class="st">`</span>)</span>
<span id="cb319-89"><a href="mc_standdr.html#cb319-89" aria-hidden="true" tabindex="-1"></a>  EY0exp <span class="ot">&lt;-</span> <span class="fu">weighted.mean</span>(Y, <span class="at">w =</span> w0)</span>
<span id="cb319-90"><a href="mc_standdr.html#cb319-90" aria-hidden="true" tabindex="-1"></a>  EY1exp <span class="ot">&lt;-</span> <span class="fu">weighted.mean</span>(Y, <span class="at">w =</span> w1)</span>
<span id="cb319-91"><a href="mc_standdr.html#cb319-91" aria-hidden="true" tabindex="-1"></a>  EY0exp2 <span class="ot">&lt;-</span> <span class="fu">weighted.mean</span>(Y, <span class="at">w =</span> w02)</span>
<span id="cb319-92"><a href="mc_standdr.html#cb319-92" aria-hidden="true" tabindex="-1"></a>  EY1exp2 <span class="ot">&lt;-</span> <span class="fu">weighted.mean</span>(Y, <span class="at">w =</span> w12)</span>
<span id="cb319-93"><a href="mc_standdr.html#cb319-93" aria-hidden="true" tabindex="-1"></a>  EY0out <span class="ot">&lt;-</span> <span class="fu">mean</span>(preds0)</span>
<span id="cb319-94"><a href="mc_standdr.html#cb319-94" aria-hidden="true" tabindex="-1"></a>  EY1out <span class="ot">&lt;-</span> <span class="fu">mean</span>(preds1)</span>
<span id="cb319-95"><a href="mc_standdr.html#cb319-95" aria-hidden="true" tabindex="-1"></a>  EY0dr <span class="ot">&lt;-</span> <span class="fu">mean</span>(w0 <span class="sc">*</span> Y <span class="sc">+</span> preds0 <span class="sc">*</span> (<span class="st">`</span><span class="at">T</span><span class="st">`</span> <span class="sc">-</span> e) <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">-</span> e))</span>
<span id="cb319-96"><a href="mc_standdr.html#cb319-96" aria-hidden="true" tabindex="-1"></a>  EY1dr <span class="ot">&lt;-</span> <span class="fu">mean</span>(w1 <span class="sc">*</span> Y <span class="sc">-</span> preds1 <span class="sc">*</span> (<span class="st">`</span><span class="at">T</span><span class="st">`</span> <span class="sc">-</span> e) <span class="sc">/</span> e)</span>
<span id="cb319-97"><a href="mc_standdr.html#cb319-97" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb319-98"><a href="mc_standdr.html#cb319-98" aria-hidden="true" tabindex="-1"></a>  est <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb319-99"><a href="mc_standdr.html#cb319-99" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;EYT0&quot;</span> <span class="ot">=</span> EYT0,</span>
<span id="cb319-100"><a href="mc_standdr.html#cb319-100" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;EYT1&quot;</span> <span class="ot">=</span> EYT1,</span>
<span id="cb319-101"><a href="mc_standdr.html#cb319-101" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;EY0exp&quot;</span> <span class="ot">=</span> EY0exp,</span>
<span id="cb319-102"><a href="mc_standdr.html#cb319-102" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;EY1exp&quot;</span> <span class="ot">=</span> EY1exp,</span>
<span id="cb319-103"><a href="mc_standdr.html#cb319-103" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;EY0exp2&quot;</span> <span class="ot">=</span> EY0exp2,</span>
<span id="cb319-104"><a href="mc_standdr.html#cb319-104" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;EY1exp2&quot;</span> <span class="ot">=</span> EY1exp2,</span>
<span id="cb319-105"><a href="mc_standdr.html#cb319-105" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;EY0out&quot;</span> <span class="ot">=</span> EY0out,</span>
<span id="cb319-106"><a href="mc_standdr.html#cb319-106" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;EY1out&quot;</span> <span class="ot">=</span> EY1out,</span>
<span id="cb319-107"><a href="mc_standdr.html#cb319-107" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;EY0dr&quot;</span> <span class="ot">=</span> EY0dr,</span>
<span id="cb319-108"><a href="mc_standdr.html#cb319-108" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;EY1dr&quot;</span> <span class="ot">=</span> EY1dr</span>
<span id="cb319-109"><a href="mc_standdr.html#cb319-109" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb319-110"><a href="mc_standdr.html#cb319-110" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb319-111"><a href="mc_standdr.html#cb319-111" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="st">&quot;stats&quot;</span> <span class="ot">=</span> stats, <span class="st">&quot;est&quot;</span> <span class="ot">=</span> est)</span>
<span id="cb319-112"><a href="mc_standdr.html#cb319-112" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb319-113"><a href="mc_standdr.html#cb319-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb319-114"><a href="mc_standdr.html#cb319-114" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; Compute statistics from \code{simdr}. Sames as \code{standdr_est}</span></span>
<span id="cb319-115"><a href="mc_standdr.html#cb319-115" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39;</span></span>
<span id="cb319-116"><a href="mc_standdr.html#cb319-116" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param x Vector of numeric values.</span></span>
<span id="cb319-117"><a href="mc_standdr.html#cb319-117" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39;</span></span>
<span id="cb319-118"><a href="mc_standdr.html#cb319-118" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @return list of statistics: \code{sun(x), mean(x), min(x), max(x)}.</span></span>
<span id="cb319-119"><a href="mc_standdr.html#cb319-119" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; </span></span>
<span id="cb319-120"><a href="mc_standdr.html#cb319-120" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @seealso standdr_stats</span></span>
<span id="cb319-121"><a href="mc_standdr.html#cb319-121" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39;</span></span>
<span id="cb319-122"><a href="mc_standdr.html#cb319-122" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @examples</span></span>
<span id="cb319-123"><a href="mc_standdr.html#cb319-123" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; simdr_stats(runif(20))</span></span>
<span id="cb319-124"><a href="mc_standdr.html#cb319-124" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @export</span></span>
<span id="cb319-125"><a href="mc_standdr.html#cb319-125" aria-hidden="true" tabindex="-1"></a>simdr_stats <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb319-126"><a href="mc_standdr.html#cb319-126" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="st">&quot;sum&quot;</span> <span class="ot">=</span> <span class="fu">sum</span>(x), <span class="st">&quot;mean&quot;</span> <span class="ot">=</span> <span class="fu">mean</span>(x), <span class="st">&quot;min&quot;</span> <span class="ot">=</span> <span class="fu">min</span>(x), <span class="st">&quot;max&quot;</span> <span class="ot">=</span> <span class="fu">max</span>(x))</span>
<span id="cb319-127"><a href="mc_standdr.html#cb319-127" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="mc_standdr-1" class="section level3 hasAnchor" number="13.4.2">
<h3><span class="header-section-number">D.4.2</span> <code>mc_standdr</code><a href="mc_standdr.html#mc_standdr-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb320"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb320-1"><a href="mc_standdr.html#cb320-1" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; Monte Carlo Simulation of Doubly Robust Standardization</span></span>
<span id="cb320-2"><a href="mc_standdr.html#cb320-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39;</span></span>
<span id="cb320-3"><a href="mc_standdr.html#cb320-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param ss Integer(). Number of covariates.</span></span>
<span id="cb320-4"><a href="mc_standdr.html#cb320-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param nrep Number of Monte Carlo repetitions.</span></span>
<span id="cb320-5"><a href="mc_standdr.html#cb320-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param width Width of interval. e.g. 0.95 will give interval c(0.025, 0.975).</span></span>
<span id="cb320-6"><a href="mc_standdr.html#cb320-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; Default is 0.95.</span></span>
<span id="cb320-7"><a href="mc_standdr.html#cb320-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; </span></span>
<span id="cb320-8"><a href="mc_standdr.html#cb320-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @seealso standdr_sim standdr_est</span></span>
<span id="cb320-9"><a href="mc_standdr.html#cb320-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39;</span></span>
<span id="cb320-10"><a href="mc_standdr.html#cb320-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @return Dataframe of results.</span></span>
<span id="cb320-11"><a href="mc_standdr.html#cb320-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @export</span></span>
<span id="cb320-12"><a href="mc_standdr.html#cb320-12" aria-hidden="true" tabindex="-1"></a>mc_standdr <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">ss =</span> <span class="fu">c</span>(<span class="dv">40</span>, <span class="dv">100</span>), <span class="at">nrep =</span> <span class="dv">1000</span>, <span class="at">width =</span> <span class="fl">0.95</span>) {</span>
<span id="cb320-13"><a href="mc_standdr.html#cb320-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stopifnot</span>(<span class="fu">all</span>(ss <span class="sc">&gt;=</span> <span class="dv">1</span>), nrep <span class="sc">&gt;=</span> <span class="dv">1</span>, width <span class="sc">&gt;</span> <span class="dv">0</span>, width <span class="sc">&lt;</span> <span class="dv">1</span>)</span>
<span id="cb320-14"><a href="mc_standdr.html#cb320-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb320-15"><a href="mc_standdr.html#cb320-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># We use alpha = 0.15 to match results with the books</span></span>
<span id="cb320-16"><a href="mc_standdr.html#cb320-16" aria-hidden="true" tabindex="-1"></a>  ms_standdr_func <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">n =</span> <span class="dv">3000</span>, <span class="at">ss =</span> <span class="dv">100</span>, <span class="at">alpha =</span> <span class="fl">0.13</span>, <span class="at">beta =</span> <span class="dv">20</span>, </span>
<span id="cb320-17"><a href="mc_standdr.html#cb320-17" aria-hidden="true" tabindex="-1"></a>                              <span class="at">probH =</span> <span class="fl">0.05</span>, <span class="at">seed =</span> <span class="cn">NULL</span>) {</span>
<span id="cb320-18"><a href="mc_standdr.html#cb320-18" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb320-19"><a href="mc_standdr.html#cb320-19" aria-hidden="true" tabindex="-1"></a>    <span class="co"># first we simulate the data</span></span>
<span id="cb320-20"><a href="mc_standdr.html#cb320-20" aria-hidden="true" tabindex="-1"></a>    dat <span class="ot">&lt;-</span> <span class="fu">standdr_sim</span>(<span class="at">n =</span> n, <span class="at">ss =</span> ss, <span class="at">alpha =</span> alpha, <span class="at">beta =</span> beta, </span>
<span id="cb320-21"><a href="mc_standdr.html#cb320-21" aria-hidden="true" tabindex="-1"></a>                       <span class="at">probH =</span> probH, <span class="at">seed =</span> seed)<span class="sc">$</span>data</span>
<span id="cb320-22"><a href="mc_standdr.html#cb320-22" aria-hidden="true" tabindex="-1"></a>    <span class="co"># then output the estimates in a list</span></span>
<span id="cb320-23"><a href="mc_standdr.html#cb320-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">standdr_est</span>(<span class="at">Y =</span> dat<span class="sc">$</span>Y, <span class="st">`</span><span class="at">T</span><span class="st">`</span> <span class="ot">=</span> dat<span class="sc">$</span><span class="st">`</span><span class="at">T</span><span class="st">`</span>, <span class="at">H =</span> dat<span class="sc">$</span>H)</span>
<span id="cb320-24"><a href="mc_standdr.html#cb320-24" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb320-25"><a href="mc_standdr.html#cb320-25" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb320-26"><a href="mc_standdr.html#cb320-26" aria-hidden="true" tabindex="-1"></a>  params <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;ss&quot;</span> <span class="ot">=</span> ss)</span>
<span id="cb320-27"><a href="mc_standdr.html#cb320-27" aria-hidden="true" tabindex="-1"></a>  mc.out <span class="ot">&lt;-</span> MonteCarlo<span class="sc">::</span><span class="fu">MonteCarlo</span>(<span class="at">func =</span> ms_standdr_func,</span>
<span id="cb320-28"><a href="mc_standdr.html#cb320-28" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">nrep =</span> nrep, <span class="at">param_list =</span> params)</span>
<span id="cb320-29"><a href="mc_standdr.html#cb320-29" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb320-30"><a href="mc_standdr.html#cb320-30" aria-hidden="true" tabindex="-1"></a>  <span class="co"># output results in a dataframe</span></span>
<span id="cb320-31"><a href="mc_standdr.html#cb320-31" aria-hidden="true" tabindex="-1"></a>  out <span class="ot">&lt;-</span> <span class="fu">suppressWarnings</span>(MonteCarlo<span class="sc">::</span><span class="fu">MakeFrame</span>(mc.out))</span>
<span id="cb320-32"><a href="mc_standdr.html#cb320-32" aria-hidden="true" tabindex="-1"></a>  out <span class="sc">%&gt;%</span></span>
<span id="cb320-33"><a href="mc_standdr.html#cb320-33" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="sc">-</span>ss, <span class="at">names_to =</span> <span class="st">&quot;estimator&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;value&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb320-34"><a href="mc_standdr.html#cb320-34" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(ss, estimator) <span class="sc">%&gt;%</span></span>
<span id="cb320-35"><a href="mc_standdr.html#cb320-35" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="at">n =</span> <span class="fu">n</span>(), </span>
<span id="cb320-36"><a href="mc_standdr.html#cb320-36" aria-hidden="true" tabindex="-1"></a>              <span class="at">mean =</span> <span class="fu">mean</span>(value),</span>
<span id="cb320-37"><a href="mc_standdr.html#cb320-37" aria-hidden="true" tabindex="-1"></a>              <span class="at">sd =</span> <span class="fu">sd</span>(value),</span>
<span id="cb320-38"><a href="mc_standdr.html#cb320-38" aria-hidden="true" tabindex="-1"></a>              <span class="at">lower =</span> <span class="fu">quantile</span>(value, <span class="at">probs =</span> (<span class="dv">1</span> <span class="sc">-</span> width) <span class="sc">/</span> <span class="dv">2</span>),</span>
<span id="cb320-39"><a href="mc_standdr.html#cb320-39" aria-hidden="true" tabindex="-1"></a>              <span class="at">upper =</span> <span class="fu">quantile</span>(value, <span class="at">probs =</span> <span class="dv">1</span> <span class="sc">-</span> (<span class="dv">1</span> <span class="sc">-</span> width) <span class="sc">/</span> <span class="dv">2</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb320-40"><a href="mc_standdr.html#cb320-40" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ungroup</span>()</span>
<span id="cb320-41"><a href="mc_standdr.html#cb320-41" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb320-42"><a href="mc_standdr.html#cb320-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-43"><a href="mc_standdr.html#cb320-43" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; Data Simulation for Doubly Robust Standardization</span></span>
<span id="cb320-44"><a href="mc_standdr.html#cb320-44" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39;</span></span>
<span id="cb320-45"><a href="mc_standdr.html#cb320-45" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param n Number of individuals/observations.</span></span>
<span id="cb320-46"><a href="mc_standdr.html#cb320-46" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param ss Number of covariates.</span></span>
<span id="cb320-47"><a href="mc_standdr.html#cb320-47" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param alpha coefficient used to compute the distribution of \code{`T`}.</span></span>
<span id="cb320-48"><a href="mc_standdr.html#cb320-48" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param beta coefficient used to compute the distribution of \code{`T`}.</span></span>
<span id="cb320-49"><a href="mc_standdr.html#cb320-49" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param probH probability of H.</span></span>
<span id="cb320-50"><a href="mc_standdr.html#cb320-50" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param seed Seed value. default is \code{NULL}.</span></span>
<span id="cb320-51"><a href="mc_standdr.html#cb320-51" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39;</span></span>
<span id="cb320-52"><a href="mc_standdr.html#cb320-52" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @return List with a dataframe of Y, T and H and summary statitics.</span></span>
<span id="cb320-53"><a href="mc_standdr.html#cb320-53" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @export</span></span>
<span id="cb320-54"><a href="mc_standdr.html#cb320-54" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39;</span></span>
<span id="cb320-55"><a href="mc_standdr.html#cb320-55" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @examples</span></span>
<span id="cb320-56"><a href="mc_standdr.html#cb320-56" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; \dontrun{</span></span>
<span id="cb320-57"><a href="mc_standdr.html#cb320-57" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; standdr_sim()</span></span>
<span id="cb320-58"><a href="mc_standdr.html#cb320-58" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; }</span></span>
<span id="cb320-59"><a href="mc_standdr.html#cb320-59" aria-hidden="true" tabindex="-1"></a>standdr_sim <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">n =</span> <span class="dv">3000</span>, <span class="at">ss =</span> <span class="dv">100</span>, <span class="at">alpha =</span> <span class="fl">0.13</span>, <span class="at">beta =</span> <span class="dv">20</span>, </span>
<span id="cb320-60"><a href="mc_standdr.html#cb320-60" aria-hidden="true" tabindex="-1"></a>                        <span class="at">probH =</span> <span class="fl">0.05</span>, <span class="at">seed =</span> <span class="cn">NULL</span>) {</span>
<span id="cb320-61"><a href="mc_standdr.html#cb320-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set.seed</span>(seed)</span>
<span id="cb320-62"><a href="mc_standdr.html#cb320-62" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb320-63"><a href="mc_standdr.html#cb320-63" aria-hidden="true" tabindex="-1"></a>  <span class="co"># matrix of independent Bernoulli vector with prob = 0.05</span></span>
<span id="cb320-64"><a href="mc_standdr.html#cb320-64" aria-hidden="true" tabindex="-1"></a>  <span class="co"># &quot;The columns of H were independent indicator variables each</span></span>
<span id="cb320-65"><a href="mc_standdr.html#cb320-65" aria-hidden="true" tabindex="-1"></a>  <span class="co">#  with probability 0.05&quot;</span></span>
<span id="cb320-66"><a href="mc_standdr.html#cb320-66" aria-hidden="true" tabindex="-1"></a>  H <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">replicate</span>(<span class="at">n =</span> ss, <span class="fu">rbinom</span>(<span class="at">n =</span> n, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">prob =</span> probH)))</span>
<span id="cb320-67"><a href="mc_standdr.html#cb320-67" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb320-68"><a href="mc_standdr.html#cb320-68" aria-hidden="true" tabindex="-1"></a>  <span class="co"># let the treatment depend on a function of H</span></span>
<span id="cb320-69"><a href="mc_standdr.html#cb320-69" aria-hidden="true" tabindex="-1"></a>  <span class="co"># &quot;We simulated T  as indicator variables with probabilities that varied as</span></span>
<span id="cb320-70"><a href="mc_standdr.html#cb320-70" aria-hidden="true" tabindex="-1"></a>  <span class="co"># a linear function  of H such that approximately 600 individuals had T=1&quot;</span></span>
<span id="cb320-71"><a href="mc_standdr.html#cb320-71" aria-hidden="true" tabindex="-1"></a>  sumH <span class="ot">&lt;-</span> <span class="fu">apply</span>(H, <span class="at">MARGIN =</span> <span class="dv">1</span>, <span class="at">FUN =</span> sum) <span class="sc">*</span> beta <span class="sc">/</span> ss</span>
<span id="cb320-72"><a href="mc_standdr.html#cb320-72" aria-hidden="true" tabindex="-1"></a>  probT <span class="ot">&lt;-</span> alpha <span class="sc">*</span> sumH <span class="sc">+</span> probH <span class="sc">*</span> <span class="fu">rnorm</span>(<span class="at">n =</span> n, <span class="at">mean =</span> <span class="dv">1</span>, <span class="at">sd =</span> <span class="fl">0.1</span>)</span>
<span id="cb320-73"><a href="mc_standdr.html#cb320-73" aria-hidden="true" tabindex="-1"></a>  <span class="co"># validate the positivity assumption</span></span>
<span id="cb320-74"><a href="mc_standdr.html#cb320-74" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stopifnot</span>(probT <span class="sc">&gt;</span> <span class="dv">0</span>, probT <span class="sc">&lt;</span> <span class="dv">1</span>)</span>
<span id="cb320-75"><a href="mc_standdr.html#cb320-75" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb320-76"><a href="mc_standdr.html#cb320-76" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">T</span><span class="st">`</span> <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="at">n =</span> n, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">prob =</span> probT)</span>
<span id="cb320-77"><a href="mc_standdr.html#cb320-77" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb320-78"><a href="mc_standdr.html#cb320-78" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb320-79"><a href="mc_standdr.html#cb320-79" aria-hidden="true" tabindex="-1"></a>  <span class="co"># generate the outcome depend on T and H</span></span>
<span id="cb320-80"><a href="mc_standdr.html#cb320-80" aria-hidden="true" tabindex="-1"></a>  <span class="co"># &quot;We simulated Y as a function T ans sumH such hat approximatey 35 </span></span>
<span id="cb320-81"><a href="mc_standdr.html#cb320-81" aria-hidden="true" tabindex="-1"></a>  <span class="co"># individuals had Y = 1&quot;</span></span>
<span id="cb320-82"><a href="mc_standdr.html#cb320-82" aria-hidden="true" tabindex="-1"></a>  probY <span class="ot">&lt;-</span> <span class="fl">0.01</span> <span class="sc">*</span> <span class="st">`</span><span class="at">T</span><span class="st">`</span> <span class="sc">+</span> <span class="fl">0.01</span> <span class="sc">*</span> sumH</span>
<span id="cb320-83"><a href="mc_standdr.html#cb320-83" aria-hidden="true" tabindex="-1"></a>  <span class="co"># positivity assumption is not required for the outcome</span></span>
<span id="cb320-84"><a href="mc_standdr.html#cb320-84" aria-hidden="true" tabindex="-1"></a>  <span class="co"># see intro to chapter 6 p. 99</span></span>
<span id="cb320-85"><a href="mc_standdr.html#cb320-85" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stopifnot</span>(probY <span class="sc">&gt;=</span> <span class="dv">0</span>, probY <span class="sc">&lt;=</span> <span class="dv">1</span>)</span>
<span id="cb320-86"><a href="mc_standdr.html#cb320-86" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb320-87"><a href="mc_standdr.html#cb320-87" aria-hidden="true" tabindex="-1"></a>  Y <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="at">n =</span> n, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">prob =</span> probY)</span>
<span id="cb320-88"><a href="mc_standdr.html#cb320-88" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb320-89"><a href="mc_standdr.html#cb320-89" aria-hidden="true" tabindex="-1"></a>  <span class="co"># put the data in a data.frame</span></span>
<span id="cb320-90"><a href="mc_standdr.html#cb320-90" aria-hidden="true" tabindex="-1"></a>  df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="st">&quot;Y&quot;</span> <span class="ot">=</span> Y, <span class="st">&quot;T&quot;</span> <span class="ot">=</span> <span class="st">`</span><span class="at">T</span><span class="st">`</span>, <span class="st">&quot;H&quot;</span> <span class="ot">=</span> H)</span>
<span id="cb320-91"><a href="mc_standdr.html#cb320-91" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb320-92"><a href="mc_standdr.html#cb320-92" aria-hidden="true" tabindex="-1"></a>  <span class="co"># output results in a list</span></span>
<span id="cb320-93"><a href="mc_standdr.html#cb320-93" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(</span>
<span id="cb320-94"><a href="mc_standdr.html#cb320-94" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;stats&quot;</span> <span class="ot">=</span> <span class="fu">list</span>(<span class="st">&quot;sumH&quot;</span> <span class="ot">=</span> <span class="fu">standdr_stats</span>(sumH),</span>
<span id="cb320-95"><a href="mc_standdr.html#cb320-95" aria-hidden="true" tabindex="-1"></a>                 <span class="st">&quot;probT&quot;</span> <span class="ot">=</span> <span class="fu">standdr_stats</span>(probT),</span>
<span id="cb320-96"><a href="mc_standdr.html#cb320-96" aria-hidden="true" tabindex="-1"></a>                 <span class="st">&quot;T&quot;</span> <span class="ot">=</span> <span class="fu">standdr_stats</span>(<span class="st">`</span><span class="at">T</span><span class="st">`</span>),</span>
<span id="cb320-97"><a href="mc_standdr.html#cb320-97" aria-hidden="true" tabindex="-1"></a>                 <span class="st">&quot;probY&quot;</span> <span class="ot">=</span> <span class="fu">standdr_stats</span>(probY),</span>
<span id="cb320-98"><a href="mc_standdr.html#cb320-98" aria-hidden="true" tabindex="-1"></a>                 <span class="st">&quot;Y&quot;</span> <span class="ot">=</span> <span class="fu">standdr_stats</span>(Y)),</span>
<span id="cb320-99"><a href="mc_standdr.html#cb320-99" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;data&quot;</span> <span class="ot">=</span> <span class="fu">list</span>(<span class="st">&quot;Y&quot;</span> <span class="ot">=</span> Y, <span class="st">&quot;T&quot;</span> <span class="ot">=</span> <span class="st">`</span><span class="at">T</span><span class="st">`</span>, <span class="st">&quot;H&quot;</span> <span class="ot">=</span> H)</span>
<span id="cb320-100"><a href="mc_standdr.html#cb320-100" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb320-101"><a href="mc_standdr.html#cb320-101" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb320-102"><a href="mc_standdr.html#cb320-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-103"><a href="mc_standdr.html#cb320-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-104"><a href="mc_standdr.html#cb320-104" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; Estimates from Doubly Robust Standardization Simulation</span></span>
<span id="cb320-105"><a href="mc_standdr.html#cb320-105" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39;</span></span>
<span id="cb320-106"><a href="mc_standdr.html#cb320-106" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param Y Vector of outcomes</span></span>
<span id="cb320-107"><a href="mc_standdr.html#cb320-107" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param `T` Vector of treatments</span></span>
<span id="cb320-108"><a href="mc_standdr.html#cb320-108" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param H Matrix of covariates</span></span>
<span id="cb320-109"><a href="mc_standdr.html#cb320-109" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39;</span></span>
<span id="cb320-110"><a href="mc_standdr.html#cb320-110" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @return List of estimates</span></span>
<span id="cb320-111"><a href="mc_standdr.html#cb320-111" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @export</span></span>
<span id="cb320-112"><a href="mc_standdr.html#cb320-112" aria-hidden="true" tabindex="-1"></a>standdr_est <span class="ot">&lt;-</span> <span class="cf">function</span>(Y, <span class="st">`</span><span class="at">T</span><span class="st">`</span>, H) {</span>
<span id="cb320-113"><a href="mc_standdr.html#cb320-113" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb320-114"><a href="mc_standdr.html#cb320-114" aria-hidden="true" tabindex="-1"></a>  <span class="co"># fit the exposure model</span></span>
<span id="cb320-115"><a href="mc_standdr.html#cb320-115" aria-hidden="true" tabindex="-1"></a>  e <span class="ot">&lt;-</span> <span class="fu">fitted</span>(<span class="fu">lm</span>(<span class="st">`</span><span class="at">T</span><span class="st">`</span> <span class="sc">~</span> H))</span>
<span id="cb320-116"><a href="mc_standdr.html#cb320-116" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb320-117"><a href="mc_standdr.html#cb320-117" aria-hidden="true" tabindex="-1"></a>  <span class="co"># refit the exposure model using an incorrect logistic model</span></span>
<span id="cb320-118"><a href="mc_standdr.html#cb320-118" aria-hidden="true" tabindex="-1"></a>  e2 <span class="ot">&lt;-</span> <span class="fu">predict</span>(<span class="fu">glm</span>(<span class="st">`</span><span class="at">T</span><span class="st">`</span> <span class="sc">~</span> H, <span class="at">family =</span> <span class="st">&quot;binomial&quot;</span>), <span class="at">type =</span> <span class="st">&quot;response&quot;</span>)</span>
<span id="cb320-119"><a href="mc_standdr.html#cb320-119" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb320-120"><a href="mc_standdr.html#cb320-120" aria-hidden="true" tabindex="-1"></a>  <span class="co"># compute the weights</span></span>
<span id="cb320-121"><a href="mc_standdr.html#cb320-121" aria-hidden="true" tabindex="-1"></a>  w0 <span class="ot">&lt;-</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="st">`</span><span class="at">T</span><span class="st">`</span>) <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">-</span> e)</span>
<span id="cb320-122"><a href="mc_standdr.html#cb320-122" aria-hidden="true" tabindex="-1"></a>  w1 <span class="ot">&lt;-</span> <span class="st">`</span><span class="at">T</span><span class="st">`</span> <span class="sc">/</span> e</span>
<span id="cb320-123"><a href="mc_standdr.html#cb320-123" aria-hidden="true" tabindex="-1"></a>  w02 <span class="ot">&lt;-</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="st">`</span><span class="at">T</span><span class="st">`</span>) <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">-</span> e2)</span>
<span id="cb320-124"><a href="mc_standdr.html#cb320-124" aria-hidden="true" tabindex="-1"></a>  w12 <span class="ot">&lt;-</span> T <span class="sc">/</span> e2</span>
<span id="cb320-125"><a href="mc_standdr.html#cb320-125" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb320-126"><a href="mc_standdr.html#cb320-126" aria-hidden="true" tabindex="-1"></a>  <span class="co"># fit an overspecified (saturated) outcome model</span></span>
<span id="cb320-127"><a href="mc_standdr.html#cb320-127" aria-hidden="true" tabindex="-1"></a>  mod.out <span class="ot">&lt;-</span> <span class="fu">lm</span>(Y <span class="sc">~</span> <span class="st">`</span><span class="at">T</span><span class="st">`</span> <span class="sc">*</span> H)</span>
<span id="cb320-128"><a href="mc_standdr.html#cb320-128" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb320-129"><a href="mc_standdr.html#cb320-129" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Estimate the expected potential outcomes using the various methods</span></span>
<span id="cb320-130"><a href="mc_standdr.html#cb320-130" aria-hidden="true" tabindex="-1"></a>  dat <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="st">&quot;Y&quot;</span> <span class="ot">=</span> Y, <span class="st">&quot;T&quot;</span> <span class="ot">=</span> <span class="st">`</span><span class="at">T</span><span class="st">`</span>)</span>
<span id="cb320-131"><a href="mc_standdr.html#cb320-131" aria-hidden="true" tabindex="-1"></a>  dat0 <span class="ot">&lt;-</span> dat</span>
<span id="cb320-132"><a href="mc_standdr.html#cb320-132" aria-hidden="true" tabindex="-1"></a>  dat0<span class="sc">$</span><span class="st">`</span><span class="at">T</span><span class="st">`</span> <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb320-133"><a href="mc_standdr.html#cb320-133" aria-hidden="true" tabindex="-1"></a>  dat1 <span class="ot">&lt;-</span> dat</span>
<span id="cb320-134"><a href="mc_standdr.html#cb320-134" aria-hidden="true" tabindex="-1"></a>  dat1<span class="sc">$</span><span class="st">`</span><span class="at">T</span><span class="st">`</span> <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb320-135"><a href="mc_standdr.html#cb320-135" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb320-136"><a href="mc_standdr.html#cb320-136" aria-hidden="true" tabindex="-1"></a>  <span class="co"># the predicted data</span></span>
<span id="cb320-137"><a href="mc_standdr.html#cb320-137" aria-hidden="true" tabindex="-1"></a>  preds0 <span class="ot">&lt;-</span> <span class="fu">predict</span>(mod.out, <span class="at">newdata =</span> dat0)</span>
<span id="cb320-138"><a href="mc_standdr.html#cb320-138" aria-hidden="true" tabindex="-1"></a>  preds1 <span class="ot">&lt;-</span> <span class="fu">predict</span>(mod.out, <span class="at">newdata =</span> dat1)</span>
<span id="cb320-139"><a href="mc_standdr.html#cb320-139" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb320-140"><a href="mc_standdr.html#cb320-140" aria-hidden="true" tabindex="-1"></a>  <span class="co"># calculate the estimates</span></span>
<span id="cb320-141"><a href="mc_standdr.html#cb320-141" aria-hidden="true" tabindex="-1"></a>  EYT0 <span class="ot">&lt;-</span> <span class="fu">mean</span>(Y <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="st">`</span><span class="at">T</span><span class="st">`</span>))</span>
<span id="cb320-142"><a href="mc_standdr.html#cb320-142" aria-hidden="true" tabindex="-1"></a>  EYT1 <span class="ot">&lt;-</span> <span class="fu">mean</span>(Y <span class="sc">*</span> <span class="st">`</span><span class="at">T</span><span class="st">`</span>)</span>
<span id="cb320-143"><a href="mc_standdr.html#cb320-143" aria-hidden="true" tabindex="-1"></a>  EY0exp <span class="ot">&lt;-</span> <span class="fu">weighted.mean</span>(Y, <span class="at">w =</span> w0)</span>
<span id="cb320-144"><a href="mc_standdr.html#cb320-144" aria-hidden="true" tabindex="-1"></a>  EY1exp <span class="ot">&lt;-</span> <span class="fu">weighted.mean</span>(Y, <span class="at">w =</span> w1)</span>
<span id="cb320-145"><a href="mc_standdr.html#cb320-145" aria-hidden="true" tabindex="-1"></a>  EY0exp2 <span class="ot">&lt;-</span> <span class="fu">weighted.mean</span>(Y, <span class="at">w =</span> w02)</span>
<span id="cb320-146"><a href="mc_standdr.html#cb320-146" aria-hidden="true" tabindex="-1"></a>  EY1exp2 <span class="ot">&lt;-</span> <span class="fu">weighted.mean</span>(Y, <span class="at">w =</span> w12)</span>
<span id="cb320-147"><a href="mc_standdr.html#cb320-147" aria-hidden="true" tabindex="-1"></a>  EY0out <span class="ot">&lt;-</span> <span class="fu">mean</span>(preds0)</span>
<span id="cb320-148"><a href="mc_standdr.html#cb320-148" aria-hidden="true" tabindex="-1"></a>  EY1out <span class="ot">&lt;-</span> <span class="fu">mean</span>(preds1)</span>
<span id="cb320-149"><a href="mc_standdr.html#cb320-149" aria-hidden="true" tabindex="-1"></a>  EY0dr <span class="ot">&lt;-</span> <span class="fu">mean</span>(w0 <span class="sc">*</span> Y <span class="sc">+</span> preds0 <span class="sc">*</span> (<span class="st">`</span><span class="at">T</span><span class="st">`</span> <span class="sc">-</span> e) <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">-</span> e))</span>
<span id="cb320-150"><a href="mc_standdr.html#cb320-150" aria-hidden="true" tabindex="-1"></a>  EY1dr <span class="ot">&lt;-</span> <span class="fu">mean</span>(w1 <span class="sc">*</span> Y <span class="sc">-</span> preds1 <span class="sc">*</span> (<span class="st">`</span><span class="at">T</span><span class="st">`</span> <span class="sc">-</span> e) <span class="sc">/</span> e)</span>
<span id="cb320-151"><a href="mc_standdr.html#cb320-151" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb320-152"><a href="mc_standdr.html#cb320-152" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="st">&quot;EYT0&quot;</span> <span class="ot">=</span> EYT0,</span>
<span id="cb320-153"><a href="mc_standdr.html#cb320-153" aria-hidden="true" tabindex="-1"></a>       <span class="st">&quot;EYT1&quot;</span> <span class="ot">=</span> EYT1,</span>
<span id="cb320-154"><a href="mc_standdr.html#cb320-154" aria-hidden="true" tabindex="-1"></a>       <span class="st">&quot;EY0exp&quot;</span> <span class="ot">=</span> EY0exp,</span>
<span id="cb320-155"><a href="mc_standdr.html#cb320-155" aria-hidden="true" tabindex="-1"></a>       <span class="st">&quot;EY1exp&quot;</span> <span class="ot">=</span> EY1exp,</span>
<span id="cb320-156"><a href="mc_standdr.html#cb320-156" aria-hidden="true" tabindex="-1"></a>       <span class="st">&quot;EY0exp2&quot;</span> <span class="ot">=</span> EY0exp2,</span>
<span id="cb320-157"><a href="mc_standdr.html#cb320-157" aria-hidden="true" tabindex="-1"></a>       <span class="st">&quot;EY1exp2&quot;</span> <span class="ot">=</span> EY1exp2,</span>
<span id="cb320-158"><a href="mc_standdr.html#cb320-158" aria-hidden="true" tabindex="-1"></a>       <span class="st">&quot;EY0out&quot;</span> <span class="ot">=</span> EY0out,</span>
<span id="cb320-159"><a href="mc_standdr.html#cb320-159" aria-hidden="true" tabindex="-1"></a>       <span class="st">&quot;EY1out&quot;</span> <span class="ot">=</span> EY1out,</span>
<span id="cb320-160"><a href="mc_standdr.html#cb320-160" aria-hidden="true" tabindex="-1"></a>       <span class="st">&quot;EY0dr&quot;</span> <span class="ot">=</span> EY0dr,</span>
<span id="cb320-161"><a href="mc_standdr.html#cb320-161" aria-hidden="true" tabindex="-1"></a>       <span class="st">&quot;EY1dr&quot;</span> <span class="ot">=</span> EY1dr)</span>
<span id="cb320-162"><a href="mc_standdr.html#cb320-162" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb320-163"><a href="mc_standdr.html#cb320-163" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-164"><a href="mc_standdr.html#cb320-164" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; Compute Statistics from \code{standdr_sim}.</span></span>
<span id="cb320-165"><a href="mc_standdr.html#cb320-165" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39;</span></span>
<span id="cb320-166"><a href="mc_standdr.html#cb320-166" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param x Vector of numeric values.</span></span>
<span id="cb320-167"><a href="mc_standdr.html#cb320-167" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39;</span></span>
<span id="cb320-168"><a href="mc_standdr.html#cb320-168" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @return list of statistics: \code{sun(x), mean(x), min(x), max(x)}.</span></span>
<span id="cb320-169"><a href="mc_standdr.html#cb320-169" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39;</span></span>
<span id="cb320-170"><a href="mc_standdr.html#cb320-170" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @examples</span></span>
<span id="cb320-171"><a href="mc_standdr.html#cb320-171" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; standdr_est(runif(20))</span></span>
<span id="cb320-172"><a href="mc_standdr.html#cb320-172" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @export</span></span>
<span id="cb320-173"><a href="mc_standdr.html#cb320-173" aria-hidden="true" tabindex="-1"></a>standdr_stats <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb320-174"><a href="mc_standdr.html#cb320-174" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="st">&quot;sum&quot;</span> <span class="ot">=</span> <span class="fu">sum</span>(x), <span class="st">&quot;mean&quot;</span> <span class="ot">=</span> <span class="fu">mean</span>(x), <span class="st">&quot;min&quot;</span> <span class="ot">=</span> <span class="fu">min</span>(x), <span class="st">&quot;max&quot;</span> <span class="ot">=</span> <span class="fu">max</span>(x))</span>
<span id="cb320-175"><a href="mc_standdr.html#cb320-175" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="linreg.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="references.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/USERNAME/REPO/edit/BRANCH/85-simdr.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
},
"toc_depth": 2
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
