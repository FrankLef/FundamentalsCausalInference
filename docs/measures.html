<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 4 Effect-Measure Modification and Causal Interaction | Study project: Fundamentals of Causal Inferences With R</title>
  <meta name="description" content="<p>This is a study project of Fundamentals of Causal Inferences by Babette A.
Brumback. It goes through a lot of the codes and through many mathematical
arguments for better learning. All exercises are attempted.</p>" />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 4 Effect-Measure Modification and Causal Interaction | Study project: Fundamentals of Causal Inferences With R" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="<p>This is a study project of Fundamentals of Causal Inferences by Babette A.
Brumback. It goes through a lot of the codes and through many mathematical
arguments for better learning. All exercises are attempted.</p>" />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 4 Effect-Measure Modification and Causal Interaction | Study project: Fundamentals of Causal Inferences With R" />
  
  <meta name="twitter:description" content="<p>This is a study project of Fundamentals of Causal Inferences by Babette A.
Brumback. It goes through a lot of the codes and through many mathematical
arguments for better learning. All exercises are attempted.</p>" />
  

<meta name="author" content="François Lefebvre" />


<meta name="date" content="2022-02-08" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="outcomes.html"/>
<link rel="next" href="dag.html"/>
<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Study Project</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Study Project</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#about"><i class="fa fa-check"></i>About</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#packages"><i class="fa fa-check"></i>Packages</a></li>
</ul></li>
<li class="part"><span><b>I Part I</b></span></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="intro.html"><a href="intro.html#a-brief-history"><i class="fa fa-check"></i><b>1.1</b> A Brief History</a></li>
<li class="chapter" data-level="1.2" data-path="intro.html"><a href="intro.html#data-examples"><i class="fa fa-check"></i><b>1.2</b> Data Examples</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="intro.html"><a href="intro.html#mortality-rates-by-country"><i class="fa fa-check"></i><b>1.2.1</b> Mortality Rates by Country</a></li>
<li class="chapter" data-level="1.2.2" data-path="intro.html"><a href="intro.html#national-center-for-education-statistics"><i class="fa fa-check"></i><b>1.2.2</b> National Center for Education Statistics</a></li>
<li class="chapter" data-level="1.2.3" data-path="intro.html"><a href="intro.html#reducing-alcohol-consumption"><i class="fa fa-check"></i><b>1.2.3</b> Reducing Alcohol Consumption</a></li>
<li class="chapter" data-level="1.2.4" data-path="intro.html"><a href="intro.html#general-social-survey"><i class="fa fa-check"></i><b>1.2.4</b> General Social Survey</a></li>
<li class="chapter" data-level="1.2.5" data-path="intro.html"><a href="intro.html#a-cancer-clinical-trial"><i class="fa fa-check"></i><b>1.2.5</b> A Cancer Clinical Trial</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="intro.html"><a href="intro.html#exercises"><i class="fa fa-check"></i><b>1.3</b> Exercises</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="intro.html"><a href="intro.html#exercise-1"><i class="fa fa-check"></i><b>1.3.1</b> Exercise 1</a></li>
<li class="chapter" data-level="1.3.2" data-path="intro.html"><a href="intro.html#exercise-2"><i class="fa fa-check"></i><b>1.3.2</b> Exercise 2</a></li>
<li class="chapter" data-level="1.3.3" data-path="intro.html"><a href="intro.html#exercise-3"><i class="fa fa-check"></i><b>1.3.3</b> Exercise 3</a></li>
<li class="chapter" data-level="1.3.4" data-path="intro.html"><a href="intro.html#exercise-4"><i class="fa fa-check"></i><b>1.3.4</b> Exercise 4</a></li>
<li class="chapter" data-level="1.3.5" data-path="intro.html"><a href="intro.html#exercise-5"><i class="fa fa-check"></i><b>1.3.5</b> Exercise 5</a></li>
<li class="chapter" data-level="1.3.6" data-path="intro.html"><a href="intro.html#exercise-6"><i class="fa fa-check"></i><b>1.3.6</b> Exercise 6</a></li>
<li class="chapter" data-level="1.3.7" data-path="intro.html"><a href="intro.html#exercise-7"><i class="fa fa-check"></i><b>1.3.7</b> Exercise 7</a></li>
<li class="chapter" data-level="1.3.8" data-path="intro.html"><a href="intro.html#exercise-8"><i class="fa fa-check"></i><b>1.3.8</b> Exercise 8</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="probability.html"><a href="probability.html"><i class="fa fa-check"></i><b>2</b> Conditional Probability and Expectation</a>
<ul>
<li class="chapter" data-level="2.1" data-path="probability.html"><a href="probability.html#conditional-probability"><i class="fa fa-check"></i><b>2.1</b> Conditional Probability</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="probability.html"><a href="probability.html#law-of-total-probability"><i class="fa fa-check"></i><b>2.1.1</b> Law of total probability</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="probability.html"><a href="probability.html#conditional-expectation-and-he-law-of-total-expectation"><i class="fa fa-check"></i><b>2.2</b> Conditional Expectation and he Law of Total expectation</a></li>
<li class="chapter" data-level="2.3" data-path="probability.html"><a href="probability.html#estimation"><i class="fa fa-check"></i><b>2.3</b> Estimation</a></li>
<li class="chapter" data-level="2.4" data-path="probability.html"><a href="probability.html#sampling-distributions-and-the-bootstrap"><i class="fa fa-check"></i><b>2.4</b> Sampling Distributions and the Bootstrap</a></li>
<li class="chapter" data-level="2.5" data-path="probability.html"><a href="probability.html#exercises-1"><i class="fa fa-check"></i><b>2.5</b> Exercises</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="probability.html"><a href="probability.html#exercise-1-1"><i class="fa fa-check"></i><b>2.5.1</b> Exercise 1</a></li>
<li class="chapter" data-level="2.5.2" data-path="probability.html"><a href="probability.html#exercise-2-1"><i class="fa fa-check"></i><b>2.5.2</b> Exercise 2</a></li>
<li class="chapter" data-level="2.5.3" data-path="probability.html"><a href="probability.html#exercise-3-1"><i class="fa fa-check"></i><b>2.5.3</b> Exercise 3</a></li>
<li class="chapter" data-level="2.5.4" data-path="probability.html"><a href="probability.html#exercise-4-1"><i class="fa fa-check"></i><b>2.5.4</b> Exercise 4</a></li>
<li class="chapter" data-level="2.5.5" data-path="probability.html"><a href="probability.html#exercise-5-1"><i class="fa fa-check"></i><b>2.5.5</b> Exercise 5</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="outcomes.html"><a href="outcomes.html"><i class="fa fa-check"></i><b>3</b> Potential Outcomes and the Fundamental Problem of Causal Inference</a>
<ul>
<li class="chapter" data-level="3.1" data-path="outcomes.html"><a href="outcomes.html#potential-outcomes-and-the-consistency-assumption"><i class="fa fa-check"></i><b>3.1</b> Potential Outcomes and the Consistency Assumption</a></li>
<li class="chapter" data-level="3.2" data-path="outcomes.html"><a href="outcomes.html#circumventing-the-fundamental-problem-of-causal-inference"><i class="fa fa-check"></i><b>3.2</b> Circumventing the Fundamental Problem of Causal Inference</a></li>
<li class="chapter" data-level="3.3" data-path="outcomes.html"><a href="outcomes.html#effect-measures"><i class="fa fa-check"></i><b>3.3</b> Effect Measures</a></li>
<li class="chapter" data-level="3.4" data-path="outcomes.html"><a href="outcomes.html#exercises-2"><i class="fa fa-check"></i><b>3.4</b> Exercises</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="outcomes.html"><a href="outcomes.html#exercise-1-2"><i class="fa fa-check"></i><b>3.4.1</b> Exercise 1</a></li>
<li class="chapter" data-level="3.4.2" data-path="outcomes.html"><a href="outcomes.html#exercise-2-2"><i class="fa fa-check"></i><b>3.4.2</b> Exercise 2</a></li>
<li class="chapter" data-level="3.4.3" data-path="outcomes.html"><a href="outcomes.html#exercise-3-2"><i class="fa fa-check"></i><b>3.4.3</b> Exercise 3</a></li>
<li class="chapter" data-level="3.4.4" data-path="outcomes.html"><a href="outcomes.html#exercise-4-2"><i class="fa fa-check"></i><b>3.4.4</b> Exercise 4</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="measures.html"><a href="measures.html"><i class="fa fa-check"></i><b>4</b> Effect-Measure Modification and Causal Interaction</a>
<ul>
<li class="chapter" data-level="4.1" data-path="measures.html"><a href="measures.html#effect-measure-modification-and-statistical-interaction"><i class="fa fa-check"></i><b>4.1</b> Effect-Measure Modification and Statistical Interaction</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="measures.html"><a href="measures.html#recovery-trial"><i class="fa fa-check"></i><b>4.1.1</b> RECOVERY trial</a></li>
<li class="chapter" data-level="4.1.2" data-path="measures.html"><a href="measures.html#nces"><i class="fa fa-check"></i><b>4.1.2</b> NCES</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="measures.html"><a href="measures.html#qualitative-agreement-of-effect-measures-in-modification"><i class="fa fa-check"></i><b>4.2</b> Qualitative Agreement of Effect Measures in Modification</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="measures.html"><a href="measures.html#simulate-the-effect-measures"><i class="fa fa-check"></i><b>4.2.1</b> Simulate the effect measures</a></li>
<li class="chapter" data-level="4.2.2" data-path="measures.html"><a href="measures.html#applications"><i class="fa fa-check"></i><b>4.2.2</b> Applications</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="measures.html"><a href="measures.html#causal-interaction"><i class="fa fa-check"></i><b>4.3</b> Causal Interaction</a></li>
<li class="chapter" data-level="4.4" data-path="measures.html"><a href="measures.html#exercises-3"><i class="fa fa-check"></i><b>4.4</b> Exercises</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="measures.html"><a href="measures.html#exercise-1-3"><i class="fa fa-check"></i><b>4.4.1</b> Exercise 1</a></li>
<li class="chapter" data-level="4.4.2" data-path="measures.html"><a href="measures.html#exercise-2-3"><i class="fa fa-check"></i><b>4.4.2</b> Exercise 2</a></li>
<li class="chapter" data-level="4.4.3" data-path="measures.html"><a href="measures.html#exercise-3-3"><i class="fa fa-check"></i><b>4.4.3</b> Exercise 3</a></li>
<li class="chapter" data-level="4.4.4" data-path="measures.html"><a href="measures.html#exercise-4-3"><i class="fa fa-check"></i><b>4.4.4</b> Exercise 4</a></li>
<li class="chapter" data-level="4.4.5" data-path="measures.html"><a href="measures.html#exercise-5-2"><i class="fa fa-check"></i><b>4.4.5</b> Exercise 5</a></li>
<li class="chapter" data-level="4.4.6" data-path="measures.html"><a href="measures.html#exercise-6-1"><i class="fa fa-check"></i><b>4.4.6</b> Exercise 6</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>II Part II</b></span></li>
<li class="chapter" data-level="5" data-path="dag.html"><a href="dag.html"><i class="fa fa-check"></i><b>5</b> Causal Directed Acyclic Graphs</a>
<ul>
<li class="chapter" data-level="5.1" data-path="dag.html"><a href="dag.html#theory"><i class="fa fa-check"></i><b>5.1</b> Theory</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="dag.html"><a href="dag.html#conditional-indepence-and-dag"><i class="fa fa-check"></i><b>5.1.1</b> Conditional Indepence and DAG</a></li>
<li class="chapter" data-level="5.1.2" data-path="dag.html"><a href="dag.html#d-separation"><i class="fa fa-check"></i><b>5.1.2</b> D-Separation</a></li>
<li class="chapter" data-level="5.1.3" data-path="dag.html"><a href="dag.html#causal-dag-with-collider"><i class="fa fa-check"></i><b>5.1.3</b> Causal DAG with collider</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="dag.html"><a href="dag.html#examples"><i class="fa fa-check"></i><b>5.2</b> Examples</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="dag.html"><a href="dag.html#causal-dag-with-intermediate-value"><i class="fa fa-check"></i><b>5.2.1</b> Causal DAG With Intermediate Value</a></li>
<li class="chapter" data-level="5.2.2" data-path="dag.html"><a href="dag.html#a-counfounder-may-occur-after-the-exposure"><i class="fa fa-check"></i><b>5.2.2</b> A counfounder may occur after the exposure</a></li>
<li class="chapter" data-level="5.2.3" data-path="dag.html"><a href="dag.html#potential-outcomes-are-the-ultimate-counfounder"><i class="fa fa-check"></i><b>5.2.3</b> Potential Outcomes are the Ultimate Counfounder</a></li>
<li class="chapter" data-level="5.2.4" data-path="dag.html"><a href="dag.html#structural-causal-model-5.7"><i class="fa fa-check"></i><b>5.2.4</b> Structural Causal Model 5.7</a></li>
<li class="chapter" data-level="5.2.5" data-path="dag.html"><a href="dag.html#potential-outcomes-behind-the-scenes"><i class="fa fa-check"></i><b>5.2.5</b> Potential Outcomes Behind the Scenes</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="dag.html"><a href="dag.html#exercises-4"><i class="fa fa-check"></i><b>5.3</b> Exercises</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="dag.html"><a href="dag.html#exercise-1-4"><i class="fa fa-check"></i><b>5.3.1</b> Exercise 1</a></li>
<li class="chapter" data-level="5.3.2" data-path="dag.html"><a href="dag.html#exercise-2-4"><i class="fa fa-check"></i><b>5.3.2</b> Exercise 2</a></li>
<li class="chapter" data-level="5.3.3" data-path="dag.html"><a href="dag.html#exercise-3-4"><i class="fa fa-check"></i><b>5.3.3</b> Exercise 3</a></li>
<li class="chapter" data-level="5.3.4" data-path="dag.html"><a href="dag.html#exercise-4-4"><i class="fa fa-check"></i><b>5.3.4</b> Exercise 4</a></li>
<li class="chapter" data-level="5.3.5" data-path="dag.html"><a href="dag.html#exercise-5-3"><i class="fa fa-check"></i><b>5.3.5</b> Exercise 5</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="backdoor.html"><a href="backdoor.html"><i class="fa fa-check"></i><b>6</b> Backdoor Method via Standardization</a>
<ul>
<li class="chapter" data-level="6.1" data-path="backdoor.html"><a href="backdoor.html#standardization-via-outome-modeling"><i class="fa fa-check"></i><b>6.1</b> Standardization via Outome Modeling</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="backdoor.html"><a href="backdoor.html#average-effect-of-treatment-on-the-treated"><i class="fa fa-check"></i><b>6.1.1</b> Average Effect of Treatment on the Treated</a></li>
</ul></li>
</ul></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="errata.html"><a href="errata.html"><i class="fa fa-check"></i><b>A</b> Errata</a>
<ul>
<li class="chapter" data-level="A.1" data-path="errata.html"><a href="errata.html#preface"><i class="fa fa-check"></i><b>A.1</b> Preface</a></li>
<li class="chapter" data-level="A.2" data-path="errata.html"><a href="errata.html#chapter-1"><i class="fa fa-check"></i><b>A.2</b> Chapter 1</a>
<ul>
<li class="chapter" data-level="A.2.1" data-path="errata.html"><a href="errata.html#section-1.2.3.2-p.-11"><i class="fa fa-check"></i><b>A.2.1</b> Section 1.2.3.2, p. 11</a></li>
</ul></li>
<li class="chapter" data-level="A.3" data-path="errata.html"><a href="errata.html#chapter-2"><i class="fa fa-check"></i><b>A.3</b> Chapter 2</a>
<ul>
<li class="chapter" data-level="A.3.1" data-path="errata.html"><a href="errata.html#figure-2.1-p.-30"><i class="fa fa-check"></i><b>A.3.1</b> Figure 2.1, p. 30</a></li>
</ul></li>
<li class="chapter" data-level="A.4" data-path="errata.html"><a href="errata.html#chapter-3"><i class="fa fa-check"></i><b>A.4</b> Chapter 3</a>
<ul>
<li class="chapter" data-level="A.4.1" data-path="errata.html"><a href="errata.html#typography-section-3.2-p.-40-equation-3.1"><i class="fa fa-check"></i><b>A.4.1</b> Typography: section 3.2 p. 40, equation 3.1</a></li>
</ul></li>
<li class="chapter" data-level="A.5" data-path="errata.html"><a href="errata.html#chapter-4"><i class="fa fa-check"></i><b>A.5</b> Chapter 4</a>
<ul>
<li class="chapter" data-level="A.5.1" data-path="errata.html"><a href="errata.html#section-4.1-p.-67-on-top"><i class="fa fa-check"></i><b>A.5.1</b> Section 4.1 p. 67 (on top)</a></li>
</ul></li>
<li class="chapter" data-level="A.6" data-path="errata.html"><a href="errata.html#chapter-5"><i class="fa fa-check"></i><b>A.6</b> Chapter 5</a></li>
<li class="chapter" data-level="A.7" data-path="errata.html"><a href="errata.html#chapter-6"><i class="fa fa-check"></i><b>A.7</b> Chapter 6</a>
<ul>
<li class="chapter" data-level="A.7.1" data-path="errata.html"><a href="errata.html#section-6.1-p.-100-first-paragraph"><i class="fa fa-check"></i><b>A.7.1</b> Section 6.1 p. 100, first paragraph</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="B" data-path="notes.html"><a href="notes.html"><i class="fa fa-check"></i><b>B</b> Notes</a>
<ul>
<li class="chapter" data-level="B.1" data-path="notes.html"><a href="notes.html#chapter-2-1"><i class="fa fa-check"></i><b>B.1</b> Chapter 2</a>
<ul>
<li class="chapter" data-level="B.1.1" data-path="notes.html"><a href="notes.html#section-2.4-p.-31"><i class="fa fa-check"></i><b>B.1.1</b> section 2.4 p. 31</a></li>
</ul></li>
<li class="chapter" data-level="B.2" data-path="notes.html"><a href="notes.html#chapter-4-1"><i class="fa fa-check"></i><b>B.2</b> Chapter 4</a>
<ul>
<li class="chapter" data-level="B.2.1" data-path="notes.html"><a href="notes.html#section-4.1"><i class="fa fa-check"></i><b>B.2.1</b> Section 4.1</a></li>
<li class="chapter" data-level="B.2.2" data-path="notes.html"><a href="notes.html#section-4.2"><i class="fa fa-check"></i><b>B.2.2</b> Section 4.2</a></li>
<li class="chapter" data-level="B.2.3" data-path="notes.html"><a href="notes.html#exercises-5"><i class="fa fa-check"></i><b>B.2.3</b> Exercises</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="C" data-path="functions.html"><a href="functions.html"><i class="fa fa-check"></i><b>C</b> Functions</a>
<ul>
<li class="chapter" data-level="C.1" data-path="functions.html"><a href="functions.html#chapter-2-2"><i class="fa fa-check"></i><b>C.1</b> Chapter 2</a></li>
<li class="chapter" data-level="C.2" data-path="functions.html"><a href="functions.html#chapter-3-1"><i class="fa fa-check"></i><b>C.2</b> Chapter 3</a>
<ul>
<li class="chapter" data-level="C.2.1" data-path="functions.html"><a href="functions.html#gt_measures.r"><i class="fa fa-check"></i><b>C.2.1</b> <code>gt_measures.R</code></a></li>
</ul></li>
<li class="chapter" data-level="C.3" data-path="functions.html"><a href="functions.html#chapter-4-2"><i class="fa fa-check"></i><b>C.3</b> Chapter 4</a>
<ul>
<li class="chapter" data-level="C.3.1" data-path="functions.html"><a href="functions.html#gt_measures_modif.r"><i class="fa fa-check"></i><b>C.3.1</b> <code>gt_measures_modif.R</code></a></li>
<li class="chapter" data-level="C.3.2" data-path="functions.html"><a href="functions.html#ggp_measures_modif.r"><i class="fa fa-check"></i><b>C.3.2</b> <code>ggp_measures_modif.R</code></a></li>
<li class="chapter" data-level="C.3.3" data-path="functions.html"><a href="functions.html#mc_beta_effect_measures.r"><i class="fa fa-check"></i><b>C.3.3</b> <code>mc_beta_effect_measures.R</code></a></li>
<li class="chapter" data-level="C.3.4" data-path="functions.html"><a href="functions.html#ggp_venn_sim.r"><i class="fa fa-check"></i><b>C.3.4</b> <code>ggp_venn_sim.R</code></a></li>
<li class="chapter" data-level="C.3.5" data-path="functions.html"><a href="functions.html#ggp_betasim.r"><i class="fa fa-check"></i><b>C.3.5</b> <code>ggp_betasim.R</code></a></li>
</ul></li>
<li class="chapter" data-level="C.4" data-path="functions.html"><a href="functions.html#chapter-5-1"><i class="fa fa-check"></i><b>C.4</b> Chapter 5</a>
<ul>
<li class="chapter" data-level="C.4.1" data-path="functions.html"><a href="functions.html#ggp_dag.r"><i class="fa fa-check"></i><b>C.4.1</b> <code>ggp_dag.R</code></a></li>
<li class="chapter" data-level="C.4.2" data-path="functions.html"><a href="functions.html#gt_probs.r"><i class="fa fa-check"></i><b>C.4.2</b> <code>gt_probs.R</code></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Study project: Fundamentals of Causal Inferences With R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="measures" class="section level1" number="4">
<h1><span class="header-section-number">Chapter 4</span> Effect-Measure Modification and Causal Interaction</h1>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="measures.html#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr, <span class="at">quietly =</span> <span class="cn">TRUE</span>)</span>
<span id="cb64-2"><a href="measures.html#cb64-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr, <span class="at">quietly =</span> <span class="cn">TRUE</span>)</span>
<span id="cb64-3"><a href="measures.html#cb64-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gt, <span class="at">quietly =</span> <span class="cn">TRUE</span>)</span>
<span id="cb64-4"><a href="measures.html#cb64-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2, <span class="at">quietly =</span> <span class="cn">TRUE</span>)</span>
<span id="cb64-5"><a href="measures.html#cb64-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(boot, <span class="at">quietly =</span> <span class="cn">TRUE</span>)</span>
<span id="cb64-6"><a href="measures.html#cb64-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gee, <span class="at">quietly =</span> <span class="cn">TRUE</span>)</span>
<span id="cb64-7"><a href="measures.html#cb64-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MonteCarlo, <span class="at">quietly =</span> <span class="cn">TRUE</span>)</span>
<span id="cb64-8"><a href="measures.html#cb64-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggvenn, <span class="at">quietly =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<div id="effect-measure-modification-and-statistical-interaction" class="section level2" number="4.1">
<h2><span class="header-section-number">4.1</span> Effect-Measure Modification and Statistical Interaction</h2>
<div id="recovery-trial" class="section level3" number="4.1.1">
<h3><span class="header-section-number">4.1.1</span> RECOVERY trial</h3>
<p>Create the data.frame for <em>RECOVERY</em> trial</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="measures.html#cb65-1" aria-hidden="true" tabindex="-1"></a>recovery <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">Y =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>, <span class="st">`</span><span class="at">T</span><span class="st">`</span> <span class="ot">=</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>, <span class="at">M =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>)</span>
<span id="cb65-2"><a href="measures.html#cb65-2" aria-hidden="true" tabindex="-1"></a>recovery<span class="sc">$</span>n <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(<span class="fu">c</span>(<span class="dv">787</span>, <span class="dv">2851</span>, <span class="dv">368</span>, <span class="dv">1412</span>, <span class="dv">278</span>, <span class="dv">405</span>, <span class="dv">86</span>, <span class="dv">238</span>))</span>
<span id="cb65-3"><a href="measures.html#cb65-3" aria-hidden="true" tabindex="-1"></a>recovery <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="at">X =</span> <span class="fu">seq_len</span>(<span class="fu">nrow</span>(recovery)), <span class="at">FUN =</span> <span class="cf">function</span>(i) {</span>
<span id="cb65-4"><a href="measures.html#cb65-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(</span>
<span id="cb65-5"><a href="measures.html#cb65-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">M =</span> <span class="fu">rep</span>(recovery<span class="sc">$</span>M[i], recovery<span class="sc">$</span>n[i]),</span>
<span id="cb65-6"><a href="measures.html#cb65-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">T</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">rep</span>(recovery<span class="sc">$</span><span class="st">`</span><span class="at">T</span><span class="st">`</span>[i], recovery<span class="sc">$</span>n[i]),</span>
<span id="cb65-7"><a href="measures.html#cb65-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">Y =</span> <span class="fu">rep</span>(recovery<span class="sc">$</span>Y[i], recovery<span class="sc">$</span>n[i])</span>
<span id="cb65-8"><a href="measures.html#cb65-8" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb65-9"><a href="measures.html#cb65-9" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb65-10"><a href="measures.html#cb65-10" aria-hidden="true" tabindex="-1"></a>recovery <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, recovery)</span>
<span id="cb65-11"><a href="measures.html#cb65-11" aria-hidden="true" tabindex="-1"></a><span class="co"># create an id variable for use with gee() later</span></span>
<span id="cb65-12"><a href="measures.html#cb65-12" aria-hidden="true" tabindex="-1"></a>recovery<span class="sc">$</span>id <span class="ot">&lt;-</span> <span class="fu">seq_len</span>(<span class="fu">nrow</span>(recovery))</span></code></pre></div>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="measures.html#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; Compute estimates of the association measures for 2 strata</span></span>
<span id="cb66-2"><a href="measures.html#cb66-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; </span></span>
<span id="cb66-3"><a href="measures.html#cb66-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; Compute estimates of the association measures for 2 strata.</span></span>
<span id="cb66-4"><a href="measures.html#cb66-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; </span></span>
<span id="cb66-5"><a href="measures.html#cb66-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; IMPORTANT:</span></span>
<span id="cb66-6"><a href="measures.html#cb66-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39;  The formula must always be in form Y ~ `T` + M, that is with only</span></span>
<span id="cb66-7"><a href="measures.html#cb66-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39;  2 predictors: T as the treatment variable and M as the modifier</span></span>
<span id="cb66-8"><a href="measures.html#cb66-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39;  variable</span></span>
<span id="cb66-9"><a href="measures.html#cb66-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39;</span></span>
<span id="cb66-10"><a href="measures.html#cb66-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param dat Dataframe of raw data.</span></span>
<span id="cb66-11"><a href="measures.html#cb66-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param formula Formula in format \code{Y ~ `T` + M}</span></span>
<span id="cb66-12"><a href="measures.html#cb66-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @R Number of bootstrap replicates.</span></span>
<span id="cb66-13"><a href="measures.html#cb66-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @conf Confidence interval</span></span>
<span id="cb66-14"><a href="measures.html#cb66-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39;</span></span>
<span id="cb66-15"><a href="measures.html#cb66-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @return Dataframe of summarized results</span></span>
<span id="cb66-16"><a href="measures.html#cb66-16" aria-hidden="true" tabindex="-1"></a>boot <span class="ot">&lt;-</span> <span class="cf">function</span>(dat, <span class="at">formula =</span> Y <span class="sc">~</span> <span class="st">`</span><span class="at">T</span><span class="st">`</span> <span class="sc">+</span> M, <span class="at">R =</span> <span class="dv">1000</span>, <span class="at">conf =</span> <span class="fl">0.95</span>) {</span>
<span id="cb66-17"><a href="measures.html#cb66-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb66-18"><a href="measures.html#cb66-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># the name of the response variable</span></span>
<span id="cb66-19"><a href="measures.html#cb66-19" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="fu">all.vars</span>(formula[[<span class="dv">2</span>]])</span>
<span id="cb66-20"><a href="measures.html#cb66-20" aria-hidden="true" tabindex="-1"></a>  <span class="co"># the name of the treatment variable</span></span>
<span id="cb66-21"><a href="measures.html#cb66-21" aria-hidden="true" tabindex="-1"></a>  t <span class="ot">&lt;-</span> <span class="fu">all.vars</span>(formula[[<span class="dv">3</span>]])[<span class="dv">1</span>]</span>
<span id="cb66-22"><a href="measures.html#cb66-22" aria-hidden="true" tabindex="-1"></a>  <span class="co"># the name of the modifier variable</span></span>
<span id="cb66-23"><a href="measures.html#cb66-23" aria-hidden="true" tabindex="-1"></a>  m <span class="ot">&lt;-</span> <span class="fu">all.vars</span>(formula[[<span class="dv">3</span>]])[<span class="dv">2</span>]</span>
<span id="cb66-24"><a href="measures.html#cb66-24" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb66-25"><a href="measures.html#cb66-25" aria-hidden="true" tabindex="-1"></a>  estimator <span class="ot">&lt;-</span> <span class="cf">function</span>(data, ids) {</span>
<span id="cb66-26"><a href="measures.html#cb66-26" aria-hidden="true" tabindex="-1"></a>    dat <span class="ot">&lt;-</span> data[ids, ]</span>
<span id="cb66-27"><a href="measures.html#cb66-27" aria-hidden="true" tabindex="-1"></a>    <span class="co"># estimate the expected potential outcomes</span></span>
<span id="cb66-28"><a href="measures.html#cb66-28" aria-hidden="true" tabindex="-1"></a>    EYT0.M0 <span class="ot">&lt;-</span> <span class="fu">mean</span>(dat[dat[, t] <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> dat[, m] <span class="sc">==</span> <span class="dv">0</span>, y])</span>
<span id="cb66-29"><a href="measures.html#cb66-29" aria-hidden="true" tabindex="-1"></a>    EYT0.M1 <span class="ot">&lt;-</span> <span class="fu">mean</span>(dat[dat[, t] <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> dat[, m] <span class="sc">==</span> <span class="dv">1</span>, y])</span>
<span id="cb66-30"><a href="measures.html#cb66-30" aria-hidden="true" tabindex="-1"></a>    EYT1.M0 <span class="ot">&lt;-</span> <span class="fu">mean</span>(dat[dat[, t] <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> dat[, m] <span class="sc">==</span> <span class="dv">0</span>, y])</span>
<span id="cb66-31"><a href="measures.html#cb66-31" aria-hidden="true" tabindex="-1"></a>    EYT1.M1 <span class="ot">&lt;-</span> <span class="fu">mean</span>(dat[dat[, t] <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> dat[, m] <span class="sc">==</span> <span class="dv">1</span>, y])</span>
<span id="cb66-32"><a href="measures.html#cb66-32" aria-hidden="true" tabindex="-1"></a>    <span class="co"># estimate the effect measures</span></span>
<span id="cb66-33"><a href="measures.html#cb66-33" aria-hidden="true" tabindex="-1"></a>    RD.M0 <span class="ot">&lt;-</span> EYT1.M0 <span class="sc">-</span> EYT0.M0</span>
<span id="cb66-34"><a href="measures.html#cb66-34" aria-hidden="true" tabindex="-1"></a>    RD.M1 <span class="ot">&lt;-</span> EYT1.M1 <span class="sc">-</span> EYT0.M1</span>
<span id="cb66-35"><a href="measures.html#cb66-35" aria-hidden="true" tabindex="-1"></a>    logRR.M0 <span class="ot">&lt;-</span> <span class="fu">log</span>(EYT1.M0 <span class="sc">/</span> EYT0.M0)</span>
<span id="cb66-36"><a href="measures.html#cb66-36" aria-hidden="true" tabindex="-1"></a>    logRR.M1 <span class="ot">&lt;-</span> <span class="fu">log</span>(EYT1.M1 <span class="sc">/</span> EYT0.M1)</span>
<span id="cb66-37"><a href="measures.html#cb66-37" aria-hidden="true" tabindex="-1"></a>    logRRstar.M0 <span class="ot">&lt;-</span> <span class="fu">log</span>((<span class="dv">1</span> <span class="sc">-</span> EYT0.M0) <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">-</span> EYT1.M0))</span>
<span id="cb66-38"><a href="measures.html#cb66-38" aria-hidden="true" tabindex="-1"></a>    logRRstar.M1 <span class="ot">&lt;-</span> <span class="fu">log</span>((<span class="dv">1</span> <span class="sc">-</span> EYT0.M1) <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">-</span> EYT1.M1))</span>
<span id="cb66-39"><a href="measures.html#cb66-39" aria-hidden="true" tabindex="-1"></a>    logOR.M0 <span class="ot">&lt;-</span> logRR.M0 <span class="sc">+</span> logRRstar.M0</span>
<span id="cb66-40"><a href="measures.html#cb66-40" aria-hidden="true" tabindex="-1"></a>    logOR.M1 <span class="ot">&lt;-</span> logRR.M1 <span class="sc">+</span> logRRstar.M1</span>
<span id="cb66-41"><a href="measures.html#cb66-41" aria-hidden="true" tabindex="-1"></a>    <span class="co"># the effect measure difference</span></span>
<span id="cb66-42"><a href="measures.html#cb66-42" aria-hidden="true" tabindex="-1"></a>    EYT0.diff <span class="ot">&lt;-</span> EYT0.M1 <span class="sc">-</span> EYT0.M0</span>
<span id="cb66-43"><a href="measures.html#cb66-43" aria-hidden="true" tabindex="-1"></a>    EYT1.diff <span class="ot">&lt;-</span> EYT1.M1 <span class="sc">-</span> EYT1.M0</span>
<span id="cb66-44"><a href="measures.html#cb66-44" aria-hidden="true" tabindex="-1"></a>    RD.diff <span class="ot">&lt;-</span> RD.M1 <span class="sc">-</span> RD.M0</span>
<span id="cb66-45"><a href="measures.html#cb66-45" aria-hidden="true" tabindex="-1"></a>    logRR.diff <span class="ot">&lt;-</span> logRR.M1 <span class="sc">-</span> logRR.M0</span>
<span id="cb66-46"><a href="measures.html#cb66-46" aria-hidden="true" tabindex="-1"></a>    logRRstar.diff <span class="ot">&lt;-</span> logRRstar.M1 <span class="sc">-</span> logRRstar.M0</span>
<span id="cb66-47"><a href="measures.html#cb66-47" aria-hidden="true" tabindex="-1"></a>    logOR.diff <span class="ot">&lt;-</span> logOR.M1 <span class="sc">-</span> logOR.M0</span>
<span id="cb66-48"><a href="measures.html#cb66-48" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb66-49"><a href="measures.html#cb66-49" aria-hidden="true" tabindex="-1"></a>    out <span class="ot">&lt;-</span> <span class="fu">c</span>(EYT0.M0, EYT0.M1, EYT1.M0, EYT1.M1, RD.M0, RD.M1,</span>
<span id="cb66-50"><a href="measures.html#cb66-50" aria-hidden="true" tabindex="-1"></a>             logRR.M0, logRR.M1, logRRstar.M0, logRRstar.M1,</span>
<span id="cb66-51"><a href="measures.html#cb66-51" aria-hidden="true" tabindex="-1"></a>             logOR.M0, logOR.M1, EYT0.diff, EYT1.diff, </span>
<span id="cb66-52"><a href="measures.html#cb66-52" aria-hidden="true" tabindex="-1"></a>             RD.diff, logRR.diff, logRRstar.diff, logOR.diff)</span>
<span id="cb66-53"><a href="measures.html#cb66-53" aria-hidden="true" tabindex="-1"></a>    <span class="fu">names</span>(out) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;EYT0.M0&quot;</span>, <span class="st">&quot;EYT0.M1&quot;</span>, <span class="st">&quot;EYT1.M0&quot;</span>, <span class="st">&quot;EYT1.M1&quot;</span>, <span class="st">&quot;RD.M0&quot;</span>, <span class="st">&quot;RD.M1&quot;</span>,</span>
<span id="cb66-54"><a href="measures.html#cb66-54" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&quot;logRR.M0&quot;</span>, <span class="st">&quot;logRR.M1&quot;</span>, <span class="st">&quot;logRRstar.M0&quot;</span>, <span class="st">&quot;logRRstar.M1&quot;</span>,</span>
<span id="cb66-55"><a href="measures.html#cb66-55" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&quot;logOR.M0&quot;</span>, <span class="st">&quot;logOR.M1&quot;</span>, <span class="st">&quot;EYT0.diff&quot;</span>, <span class="st">&quot;EYT1.diff&quot;</span>, </span>
<span id="cb66-56"><a href="measures.html#cb66-56" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&quot;RD.diff&quot;</span>, <span class="st">&quot;logRR.diff&quot;</span>, <span class="st">&quot;logRRstar.diff&quot;</span>, <span class="st">&quot;logOR.diff&quot;</span>)</span>
<span id="cb66-57"><a href="measures.html#cb66-57" aria-hidden="true" tabindex="-1"></a>    out</span>
<span id="cb66-58"><a href="measures.html#cb66-58" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb66-59"><a href="measures.html#cb66-59" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb66-60"><a href="measures.html#cb66-60" aria-hidden="true" tabindex="-1"></a>  out <span class="ot">&lt;-</span> <span class="fu">run_boot</span>(<span class="at">data =</span> dat, <span class="at">statistic =</span> estimator, <span class="at">R =</span> R, <span class="at">conf =</span> conf)</span>
<span id="cb66-61"><a href="measures.html#cb66-61" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb66-62"><a href="measures.html#cb66-62" aria-hidden="true" tabindex="-1"></a>  <span class="co"># vector of variables to exponentiate</span></span>
<span id="cb66-63"><a href="measures.html#cb66-63" aria-hidden="true" tabindex="-1"></a>  vars <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;RR.M0&quot;</span> <span class="ot">=</span> <span class="st">&quot;logRR.M0&quot;</span>, <span class="st">&quot;RR.M1&quot;</span> <span class="ot">=</span> <span class="st">&quot;logRR.M1&quot;</span>, <span class="st">&quot;RR.diff&quot;</span>  <span class="ot">=</span> <span class="st">&quot;logRR.diff&quot;</span>,</span>
<span id="cb66-64"><a href="measures.html#cb66-64" aria-hidden="true" tabindex="-1"></a>           <span class="st">&quot;RRstar.M0&quot;</span>  <span class="ot">=</span> <span class="st">&quot;logRRstar.M0&quot;</span>, <span class="st">&quot;RRstar.M1&quot;</span>  <span class="ot">=</span> <span class="st">&quot;logRRstar.M1&quot;</span>, <span class="st">&quot;RRstar.diff&quot;</span> <span class="ot">=</span> <span class="st">&quot;logRRstar.diff&quot;</span>,</span>
<span id="cb66-65"><a href="measures.html#cb66-65" aria-hidden="true" tabindex="-1"></a>           <span class="st">&quot;OR.M0&quot;</span> <span class="ot">=</span> <span class="st">&quot;logOR.M0&quot;</span>, <span class="st">&quot;OR.M1&quot;</span> <span class="ot">=</span> <span class="st">&quot;logOR.M1&quot;</span>, <span class="st">&quot;OR.diff&quot;</span> <span class="ot">=</span> <span class="st">&quot;logOR.diff&quot;</span>)</span>
<span id="cb66-66"><a href="measures.html#cb66-66" aria-hidden="true" tabindex="-1"></a>  out <span class="ot">&lt;-</span> <span class="fu">exp_effects</span>(<span class="at">data =</span> out, <span class="at">vars =</span> vars)</span>
<span id="cb66-67"><a href="measures.html#cb66-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-68"><a href="measures.html#cb66-68" aria-hidden="true" tabindex="-1"></a>  out</span>
<span id="cb66-69"><a href="measures.html#cb66-69" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>run <code>boot()</code> with the RECOVERY data set</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="measures.html#cb67-1" aria-hidden="true" tabindex="-1"></a>recovery.out <span class="ot">&lt;-</span> <span class="fu">boot</span>(recovery, <span class="at">formula =</span> Y <span class="sc">~</span> <span class="st">`</span><span class="at">T</span><span class="st">`</span> <span class="sc">+</span> M)</span></code></pre></div>
<p>verify the results with the author’s on p. 65.</p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="measures.html#cb68-1" aria-hidden="true" tabindex="-1"></a>bb <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb68-2"><a href="measures.html#cb68-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">name =</span> <span class="fu">c</span>(<span class="st">&quot;EYT0.M0&quot;</span>, <span class="st">&quot;EYT0.M1&quot;</span>, <span class="st">&quot;EYT1.M0&quot;</span>, <span class="st">&quot;EYT1.M1&quot;</span>, <span class="st">&quot;RD.M0&quot;</span>, <span class="st">&quot;RD.M1&quot;</span>,</span>
<span id="cb68-3"><a href="measures.html#cb68-3" aria-hidden="true" tabindex="-1"></a>           <span class="st">&quot;EYT0.diff&quot;</span>, <span class="st">&quot;EYT1.diff&quot;</span>, <span class="st">&quot;RD.diff&quot;</span>, <span class="st">&quot;RR.M0&quot;</span>, <span class="st">&quot;RR.M1&quot;</span>, <span class="st">&quot;RR.diff&quot;</span>,</span>
<span id="cb68-4"><a href="measures.html#cb68-4" aria-hidden="true" tabindex="-1"></a>           <span class="st">&quot;RRstar.M0&quot;</span>, <span class="st">&quot;RRstar.M1&quot;</span>, <span class="st">&quot;RRstar.diff&quot;</span>, <span class="st">&quot;OR.M0&quot;</span>, <span class="st">&quot;OR.M1&quot;</span>, <span class="st">&quot;OR.diff&quot;</span>),</span>
<span id="cb68-5"><a href="measures.html#cb68-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">est =</span> <span class="fu">c</span>(<span class="fl">0.784</span>, <span class="fl">0.593</span>, <span class="fl">0.793</span>, <span class="fl">0.735</span>, <span class="fl">0.01</span>, <span class="fl">0.142</span>,</span>
<span id="cb68-6"><a href="measures.html#cb68-6" aria-hidden="true" tabindex="-1"></a>          <span class="sc">-</span><span class="fl">0.191</span>, <span class="sc">-</span><span class="fl">0.059</span>, <span class="fl">0.132</span>, <span class="fl">1.012</span>, <span class="fl">1.239</span>, <span class="fl">1.224</span>,</span>
<span id="cb68-7"><a href="measures.html#cb68-7" aria-hidden="true" tabindex="-1"></a>          <span class="fl">1.046</span>, <span class="fl">1.533</span>, <span class="fl">1.466</span>, <span class="fl">1.059</span>, <span class="fl">1.9</span>, <span class="fl">1.794</span>)</span>
<span id="cb68-8"><a href="measures.html#cb68-8" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb68-9"><a href="measures.html#cb68-9" aria-hidden="true" tabindex="-1"></a>comp <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">bb =</span> bb,</span>
<span id="cb68-10"><a href="measures.html#cb68-10" aria-hidden="true" tabindex="-1"></a>                   <span class="at">d =</span> recovery.out[<span class="fu">match</span>(bb<span class="sc">$</span>name, recovery.out<span class="sc">$</span>name), <span class="st">&quot;est&quot;</span>])</span>
<span id="cb68-11"><a href="measures.html#cb68-11" aria-hidden="true" tabindex="-1"></a>comp<span class="sc">$</span>dev <span class="ot">&lt;-</span> <span class="fu">abs</span>(comp<span class="sc">$</span>bb.est <span class="sc">-</span> comp<span class="sc">$</span>d)</span>
<span id="cb68-12"><a href="measures.html#cb68-12" aria-hidden="true" tabindex="-1"></a><span class="fu">stopifnot</span>(<span class="fu">sum</span>(comp<span class="sc">$</span>dev) <span class="sc">&lt;</span> <span class="fl">0.01</span>)</span></code></pre></div>
<p>and we communicate the results in a table</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="measures.html#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">gt_measures_modif</span>(recovery.out, <span class="at">title =</span> <span class="st">&quot;Table 4.2 RECOVERY Trial&quot;</span>)</span></code></pre></div>
<div id="iojjvmuvdq" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#iojjvmuvdq .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#iojjvmuvdq .gt_heading {
  background-color: #DCDCDC;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#iojjvmuvdq .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: bold;
  padding-top: 4px;
  padding-bottom: 4px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#iojjvmuvdq .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: bold;
  padding-top: 0;
  padding-bottom: 6px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#iojjvmuvdq .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#iojjvmuvdq .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#iojjvmuvdq .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#iojjvmuvdq .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#iojjvmuvdq .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#iojjvmuvdq .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#iojjvmuvdq .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#iojjvmuvdq .gt_group_heading {
  padding: 8px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#iojjvmuvdq .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#iojjvmuvdq .gt_from_md > :first-child {
  margin-top: 0;
}

#iojjvmuvdq .gt_from_md > :last-child {
  margin-bottom: 0;
}

#iojjvmuvdq .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#iojjvmuvdq .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 12px;
}

#iojjvmuvdq .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#iojjvmuvdq .gt_first_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
}

#iojjvmuvdq .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#iojjvmuvdq .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#iojjvmuvdq .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#iojjvmuvdq .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#iojjvmuvdq .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#iojjvmuvdq .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding: 4px;
}

#iojjvmuvdq .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#iojjvmuvdq .gt_sourcenote {
  font-size: 90%;
  padding: 4px;
}

#iojjvmuvdq .gt_left {
  text-align: left;
}

#iojjvmuvdq .gt_center {
  text-align: center;
}

#iojjvmuvdq .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#iojjvmuvdq .gt_font_normal {
  font-weight: normal;
}

#iojjvmuvdq .gt_font_bold {
  font-weight: bold;
}

#iojjvmuvdq .gt_font_italic {
  font-style: italic;
}

#iojjvmuvdq .gt_super {
  font-size: 65%;
}

#iojjvmuvdq .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 65%;
}
</style>
<table class="gt_table">
  <thead class="gt_header">
    <tr>
      <th colspan="7" class="gt_heading gt_title gt_font_normal" style><strong>Table 4.2 RECOVERY Trial</strong></th>
    </tr>
    <tr>
      <th colspan="7" class="gt_heading gt_subtitle gt_font_normal gt_bottom_border" style><strong>Effect-measure Modification</strong></th>
    </tr>
  </thead>
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="2" colspan="1"></th>
      <th class="gt_center gt_columns_top_border gt_column_spanner_outer" rowspan="1" colspan="2">
        <span class="gt_column_spanner">M0</span>
      </th>
      <th class="gt_center gt_columns_top_border gt_column_spanner_outer" rowspan="1" colspan="2">
        <span class="gt_column_spanner">M1</span>
      </th>
      <th class="gt_center gt_columns_top_border gt_column_spanner_outer" rowspan="1" colspan="2">
        <span class="gt_column_spanner">diff</span>
      </th>
    </tr>
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1">Estimate</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1">CI<sup class="gt_footnote_marks">1</sup></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" style="border-left-width: 1.5px; border-left-style: solid; border-left-color: grey60;">Estimate</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1">CI<sup class="gt_footnote_marks">1</sup></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" style="border-left-width: 1.5px; border-left-style: solid; border-left-color: grey60;">Estimate</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1">CI<sup class="gt_footnote_marks">1</sup></th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td class="gt_row gt_left gt_stub">EYT0</td>
<td class="gt_row gt_center">0.784</td>
<td class="gt_row gt_center">(0.77, 0.797)</td>
<td class="gt_row gt_center" style="border-left-width: 1.5px; border-left-style: solid; border-left-color: grey60;">0.593</td>
<td class="gt_row gt_center">(0.555, 0.629)</td>
<td class="gt_row gt_center" style="border-left-width: 1.5px; border-left-style: solid; border-left-color: grey60;">-0.191</td>
<td class="gt_row gt_center">(-0.23, -0.153)</td></tr>
    <tr><td class="gt_row gt_left gt_stub">EYT1</td>
<td class="gt_row gt_center gt_striped">0.793</td>
<td class="gt_row gt_center gt_striped">(0.774, 0.812)</td>
<td class="gt_row gt_center gt_striped" style="border-left-width: 1.5px; border-left-style: solid; border-left-color: grey60;">0.735</td>
<td class="gt_row gt_center gt_striped">(0.686, 0.785)</td>
<td class="gt_row gt_center gt_striped" style="border-left-width: 1.5px; border-left-style: solid; border-left-color: grey60;">-0.059</td>
<td class="gt_row gt_center gt_striped">(-0.11, -0.005)</td></tr>
    <tr><td class="gt_row gt_left gt_stub">RD</td>
<td class="gt_row gt_center">0.010</td>
<td class="gt_row gt_center">(-0.014, 0.033)</td>
<td class="gt_row gt_center" style="border-left-width: 1.5px; border-left-style: solid; border-left-color: grey60;">0.142</td>
<td class="gt_row gt_center">(0.08, 0.207)</td>
<td class="gt_row gt_center" style="border-left-width: 1.5px; border-left-style: solid; border-left-color: grey60;">0.132</td>
<td class="gt_row gt_center">(0.067, 0.201)</td></tr>
    <tr><td class="gt_row gt_left gt_stub">RR</td>
<td class="gt_row gt_center gt_striped">1.012</td>
<td class="gt_row gt_center gt_striped">(0.982, 1.043)</td>
<td class="gt_row gt_center gt_striped" style="border-left-width: 1.5px; border-left-style: solid; border-left-color: grey60;">1.239</td>
<td class="gt_row gt_center gt_striped">(1.131, 1.366)</td>
<td class="gt_row gt_center gt_striped" style="border-left-width: 1.5px; border-left-style: solid; border-left-color: grey60;">1.224</td>
<td class="gt_row gt_center gt_striped">(1.114, 1.354)</td></tr>
    <tr><td class="gt_row gt_left gt_stub">RRstar</td>
<td class="gt_row gt_center">1.046</td>
<td class="gt_row gt_center">(0.934, 1.169)</td>
<td class="gt_row gt_center" style="border-left-width: 1.5px; border-left-style: solid; border-left-color: grey60;">1.533</td>
<td class="gt_row gt_center">(1.243, 1.904)</td>
<td class="gt_row gt_center" style="border-left-width: 1.5px; border-left-style: solid; border-left-color: grey60;">1.466</td>
<td class="gt_row gt_center">(1.161, 1.867)</td></tr>
    <tr><td class="gt_row gt_left gt_stub">OR</td>
<td class="gt_row gt_center gt_striped">1.059</td>
<td class="gt_row gt_center gt_striped">(0.918, 1.218)</td>
<td class="gt_row gt_center gt_striped" style="border-left-width: 1.5px; border-left-style: solid; border-left-color: grey60;">1.900</td>
<td class="gt_row gt_center gt_striped">(1.41, 2.594)</td>
<td class="gt_row gt_center gt_striped" style="border-left-width: 1.5px; border-left-style: solid; border-left-color: grey60;">1.794</td>
<td class="gt_row gt_center gt_striped">(1.298, 2.52)</td></tr>
  </tbody>
  <tfoot class="gt_sourcenotes">
    <tr>
      <td class="gt_sourcenote" colspan="7">Fundamentals of Causal Inference, Babette A. Brumback, 2022</td>
    </tr>
  </tfoot>
  <tfoot>
    <tr class="gt_footnotes">
      <td colspan="7">
        <p class="gt_footnote">
          <sup class="gt_footnote_marks">
            <em>1</em>
          </sup>
           
          95% confidence interval
          <br />
        </p>
      </td>
    </tr>
  </tfoot>
</table>
</div>
<p>plotting the results makes it easier to see the measures vary among
the strata. We can clearly see here significant difference in effect measures
between the 2 strata.</p>
<p>It supports the observation in the text concerning the
lack of effect of dexamethasone without intrusive mechanical ventilation (M0)
vs its use with intrusive mechanical ventilation (M1) which is significant.</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="measures.html#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggp_measures_modif</span>(recovery.out, <span class="at">title =</span> <span class="st">&quot;RECOVERY trial&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-55-1.png" width="672" /></p>
<p>The <code>gee::gee()</code> function is used to find information on the coefficients
and see if they are statistically significant. The same could be done
withe <code>glm::glm()</code> but <code>gee</code> offers results with robust statistics which
is very useful in practical terms.</p>
<p>Luckily, the <code>gee()</code> works exactly like the <code>glm()</code> functions, with the same
extractor functions <code>coefficients()</code>, <code>effects()</code>, etc. See the documentation
of <code>lm</code> with <code>?lm</code> for more details.</p>
<p>We are going through an example just below to illustrate how tthe extractor
functions are used which is not shown in the textbook.</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="measures.html#cb71-1" aria-hidden="true" tabindex="-1"></a>linmod <span class="ot">&lt;-</span> gee<span class="sc">::</span><span class="fu">gee</span>(Y <span class="sc">~</span> <span class="st">`</span><span class="at">T</span><span class="st">`</span> <span class="sc">+</span> M <span class="sc">+</span> <span class="st">`</span><span class="at">T</span><span class="st">`</span> <span class="sc">*</span> M,</span>
<span id="cb71-2"><a href="measures.html#cb71-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">id =</span> id,</span>
<span id="cb71-3"><a href="measures.html#cb71-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">data =</span> recovery,</span>
<span id="cb71-4"><a href="measures.html#cb71-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">family =</span> gaussian)</span></code></pre></div>
<pre><code>## Beginning Cgee S-function, @(#) geeformula.q 4.13 98/01/27</code></pre>
<pre><code>## running glm to get initial regression estimate</code></pre>
<pre><code>## (Intercept)           T           M         T:M 
##  0.78367235  0.00958608 -0.19070017  0.13200964</code></pre>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="measures.html#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(linmod)</span></code></pre></div>
<pre><code>## 
##  GEE:  GENERALIZED LINEAR MODELS FOR DEPENDENT DATA
##  gee S-function, version 4.13 modified 98/01/27 (1998) 
## 
## Model:
##  Link:                      Identity 
##  Variance to Mean Relation: Gaussian 
##  Correlation Structure:     Independent 
## 
## Call:
## gee::gee(formula = Y ~ T + M + T * M, id = id, data = recovery, 
##     family = gaussian)
## 
## Summary of Residuals:
##        Min         1Q     Median         3Q        Max 
## -0.7932584  0.2067416  0.2163277  0.2163277  0.4070278 
## 
## 
## Coefficients:
##                Estimate  Naive S.E.     Naive z Robust S.E.    Robust z
## (Intercept)  0.78367235 0.006975704 112.3431253 0.006826403 114.8001855
## T            0.00958608 0.012170195   0.7876686 0.011778554   0.8138588
## M           -0.19070017 0.017545664 -10.8687918 0.019999408  -9.5352906
## T:M          0.13200964 0.030881745   4.2746820 0.033074076   3.9913327
## 
## Estimated Scale Parameter:  0.1770267
## Number of Iterations:  1
## 
## Working Correlation
##      [,1]
## [1,]    1</code></pre>
<p>To extract the coefficients from the <code>gee</code> object we use the extractor function
<code>coefficients()</code> or its alias <code>coef()</code></p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="measures.html#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(linmod)</span></code></pre></div>
<pre><code>## (Intercept)           T           M         T:M 
##  0.78367235  0.00958608 -0.19070017  0.13200964</code></pre>
<p>and to extract the entire coefficient data to work
with it, just use <code>coefficients()</code> with <code>summary()</code></p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="measures.html#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(<span class="fu">summary</span>(linmod))</span></code></pre></div>
<pre><code>##                Estimate  Naive S.E.     Naive z Robust S.E.    Robust z
## (Intercept)  0.78367235 0.006975704 112.3431253 0.006826403 114.8001855
## T            0.00958608 0.012170195   0.7876686 0.011778554   0.8138588
## M           -0.19070017 0.017545664 -10.8687918 0.019999408  -9.5352906
## T:M          0.13200964 0.030881745   4.2746820 0.033074076   3.9913327</code></pre>
<p>and in this case we are concerned about how significant the interaction is.
Therefore the <em>Robust z</em> is extracted with <code>coefficients()</code> alias <code>coef()</code></p>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="measures.html#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(<span class="fu">summary</span>(linmod))[, <span class="st">&quot;Robust z&quot;</span>]</span></code></pre></div>
<pre><code>## (Intercept)           T           M         T:M 
## 114.8001855   0.8138588  -9.5352906   3.9913327</code></pre>
<p>we see that <span class="math inline">\(T:M\)</span> is 3.99 standard deviations away from zero which will give
us the 2-sided p-value that is significant</p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="measures.html#cb83-1" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">coef</span>(<span class="fu">summary</span>(linmod))[<span class="st">&quot;T:M&quot;</span>, <span class="st">&quot;Robust z&quot;</span>]</span>
<span id="cb83-2"><a href="measures.html#cb83-2" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span> <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">pnorm</span>(z))</span></code></pre></div>
<pre><code>## [1] 6.570304e-05</code></pre>
</div>
<div id="nces" class="section level3" number="4.1.2">
<h3><span class="header-section-number">4.1.2</span> NCES</h3>
<p>We process the <code>NCES</code> data the same way we did for the RECOVERY trial.</p>
<p>Run the bootsrap</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="measures.html#cb85-1" aria-hidden="true" tabindex="-1"></a>nces.out <span class="ot">&lt;-</span> <span class="fu">boot</span>(nces, <span class="at">formula =</span> highmathsat <span class="sc">~</span> female <span class="sc">+</span> selective)</span></code></pre></div>
<p>verify the results with the author’s on p. 70.</p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="measures.html#cb86-1" aria-hidden="true" tabindex="-1"></a>bb <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb86-2"><a href="measures.html#cb86-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">name =</span> <span class="fu">c</span>(<span class="st">&quot;EYT0.M0&quot;</span>, <span class="st">&quot;EYT0.M1&quot;</span>, <span class="st">&quot;EYT1.M0&quot;</span>, <span class="st">&quot;EYT1.M1&quot;</span>, <span class="st">&quot;RD.M0&quot;</span>, <span class="st">&quot;RD.M1&quot;</span>,</span>
<span id="cb86-3"><a href="measures.html#cb86-3" aria-hidden="true" tabindex="-1"></a>           <span class="st">&quot;EYT0.diff&quot;</span>, <span class="st">&quot;EYT1.diff&quot;</span>, <span class="st">&quot;RD.diff&quot;</span>, <span class="st">&quot;RR.M0&quot;</span>, <span class="st">&quot;RR.M1&quot;</span>, <span class="st">&quot;RR.diff&quot;</span>,</span>
<span id="cb86-4"><a href="measures.html#cb86-4" aria-hidden="true" tabindex="-1"></a>           <span class="st">&quot;RRstar.M0&quot;</span>, <span class="st">&quot;RRstar.M1&quot;</span>, <span class="st">&quot;RRstar.diff&quot;</span>, <span class="st">&quot;OR.M0&quot;</span>, <span class="st">&quot;OR.M1&quot;</span>, <span class="st">&quot;OR.diff&quot;</span>),</span>
<span id="cb86-5"><a href="measures.html#cb86-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">est =</span> <span class="fu">c</span>(<span class="fl">0.167</span>, <span class="fl">0.675</span>, <span class="fl">0.081</span>, <span class="fl">0.345</span>, <span class="sc">-</span><span class="fl">0.086</span>, <span class="sc">-</span><span class="fl">0.33</span>,</span>
<span id="cb86-6"><a href="measures.html#cb86-6" aria-hidden="true" tabindex="-1"></a>          <span class="fl">0.509</span>, <span class="fl">0.264</span>, <span class="sc">-</span><span class="fl">0.244</span>, <span class="fl">0.486</span>, <span class="fl">0.511</span>, <span class="fl">1.052</span>,</span>
<span id="cb86-7"><a href="measures.html#cb86-7" aria-hidden="true" tabindex="-1"></a>          <span class="fl">0.907</span>, <span class="fl">0.496</span>, <span class="fl">0.547</span>, <span class="fl">0.44</span>, <span class="fl">0.254</span>, <span class="fl">0.576</span>)</span>
<span id="cb86-8"><a href="measures.html#cb86-8" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb86-9"><a href="measures.html#cb86-9" aria-hidden="true" tabindex="-1"></a>comp <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">bb =</span> bb, <span class="at">d =</span> nces.out[<span class="fu">match</span>(bb<span class="sc">$</span>name, nces.out<span class="sc">$</span>name), <span class="st">&quot;est&quot;</span>])</span>
<span id="cb86-10"><a href="measures.html#cb86-10" aria-hidden="true" tabindex="-1"></a>comp<span class="sc">$</span>dev <span class="ot">&lt;-</span> <span class="fu">abs</span>(comp<span class="sc">$</span>bb.est <span class="sc">-</span> comp<span class="sc">$</span>d)</span>
<span id="cb86-11"><a href="measures.html#cb86-11" aria-hidden="true" tabindex="-1"></a><span class="fu">stopifnot</span>(<span class="fu">sum</span>(comp<span class="sc">$</span>dev) <span class="sc">&lt;</span> <span class="fl">0.01</span>)</span></code></pre></div>
<p>and the table is</p>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="measures.html#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="fu">gt_measures_modif</span>(nces.out, <span class="at">title =</span> <span class="st">&quot;Table 4.3 NCES data&quot;</span>)</span></code></pre></div>
<div id="yxbpwulhdl" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#yxbpwulhdl .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#yxbpwulhdl .gt_heading {
  background-color: #DCDCDC;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#yxbpwulhdl .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: bold;
  padding-top: 4px;
  padding-bottom: 4px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#yxbpwulhdl .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: bold;
  padding-top: 0;
  padding-bottom: 6px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#yxbpwulhdl .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#yxbpwulhdl .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#yxbpwulhdl .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#yxbpwulhdl .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#yxbpwulhdl .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#yxbpwulhdl .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#yxbpwulhdl .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#yxbpwulhdl .gt_group_heading {
  padding: 8px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#yxbpwulhdl .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#yxbpwulhdl .gt_from_md > :first-child {
  margin-top: 0;
}

#yxbpwulhdl .gt_from_md > :last-child {
  margin-bottom: 0;
}

#yxbpwulhdl .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#yxbpwulhdl .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 12px;
}

#yxbpwulhdl .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#yxbpwulhdl .gt_first_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
}

#yxbpwulhdl .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#yxbpwulhdl .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#yxbpwulhdl .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#yxbpwulhdl .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#yxbpwulhdl .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#yxbpwulhdl .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding: 4px;
}

#yxbpwulhdl .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#yxbpwulhdl .gt_sourcenote {
  font-size: 90%;
  padding: 4px;
}

#yxbpwulhdl .gt_left {
  text-align: left;
}

#yxbpwulhdl .gt_center {
  text-align: center;
}

#yxbpwulhdl .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#yxbpwulhdl .gt_font_normal {
  font-weight: normal;
}

#yxbpwulhdl .gt_font_bold {
  font-weight: bold;
}

#yxbpwulhdl .gt_font_italic {
  font-style: italic;
}

#yxbpwulhdl .gt_super {
  font-size: 65%;
}

#yxbpwulhdl .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 65%;
}
</style>
<table class="gt_table">
  <thead class="gt_header">
    <tr>
      <th colspan="7" class="gt_heading gt_title gt_font_normal" style><strong>Table 4.3 NCES data</strong></th>
    </tr>
    <tr>
      <th colspan="7" class="gt_heading gt_subtitle gt_font_normal gt_bottom_border" style><strong>Effect-measure Modification</strong></th>
    </tr>
  </thead>
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="2" colspan="1"></th>
      <th class="gt_center gt_columns_top_border gt_column_spanner_outer" rowspan="1" colspan="2">
        <span class="gt_column_spanner">M0</span>
      </th>
      <th class="gt_center gt_columns_top_border gt_column_spanner_outer" rowspan="1" colspan="2">
        <span class="gt_column_spanner">M1</span>
      </th>
      <th class="gt_center gt_columns_top_border gt_column_spanner_outer" rowspan="1" colspan="2">
        <span class="gt_column_spanner">diff</span>
      </th>
    </tr>
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1">Estimate</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1">CI<sup class="gt_footnote_marks">1</sup></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" style="border-left-width: 1.5px; border-left-style: solid; border-left-color: grey60;">Estimate</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1">CI<sup class="gt_footnote_marks">1</sup></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" style="border-left-width: 1.5px; border-left-style: solid; border-left-color: grey60;">Estimate</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1">CI<sup class="gt_footnote_marks">1</sup></th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td class="gt_row gt_left gt_stub">EYT0</td>
<td class="gt_row gt_center">0.167</td>
<td class="gt_row gt_center">(0.135, 0.198)</td>
<td class="gt_row gt_center" style="border-left-width: 1.5px; border-left-style: solid; border-left-color: grey60;">0.675</td>
<td class="gt_row gt_center">(0.602, 0.749)</td>
<td class="gt_row gt_center" style="border-left-width: 1.5px; border-left-style: solid; border-left-color: grey60;">0.509</td>
<td class="gt_row gt_center">(0.428, 0.589)</td></tr>
    <tr><td class="gt_row gt_left gt_stub">EYT1</td>
<td class="gt_row gt_center gt_striped">0.081</td>
<td class="gt_row gt_center gt_striped">(0.056, 0.106)</td>
<td class="gt_row gt_center gt_striped" style="border-left-width: 1.5px; border-left-style: solid; border-left-color: grey60;">0.345</td>
<td class="gt_row gt_center gt_striped">(0.248, 0.451)</td>
<td class="gt_row gt_center gt_striped" style="border-left-width: 1.5px; border-left-style: solid; border-left-color: grey60;">0.264</td>
<td class="gt_row gt_center gt_striped">(0.163, 0.374)</td></tr>
    <tr><td class="gt_row gt_left gt_stub">RD</td>
<td class="gt_row gt_center">-0.086</td>
<td class="gt_row gt_center">(-0.125, -0.047)</td>
<td class="gt_row gt_center" style="border-left-width: 1.5px; border-left-style: solid; border-left-color: grey60;">-0.330</td>
<td class="gt_row gt_center">(-0.453, -0.199)</td>
<td class="gt_row gt_center" style="border-left-width: 1.5px; border-left-style: solid; border-left-color: grey60;">-0.244</td>
<td class="gt_row gt_center">(-0.374, -0.106)</td></tr>
    <tr><td class="gt_row gt_left gt_stub">RR</td>
<td class="gt_row gt_center gt_striped">0.486</td>
<td class="gt_row gt_center gt_striped">(0.34, 0.702)</td>
<td class="gt_row gt_center gt_striped" style="border-left-width: 1.5px; border-left-style: solid; border-left-color: grey60;">0.511</td>
<td class="gt_row gt_center gt_striped">(0.377, 0.726)</td>
<td class="gt_row gt_center gt_striped" style="border-left-width: 1.5px; border-left-style: solid; border-left-color: grey60;">1.052</td>
<td class="gt_row gt_center gt_striped">(0.653, 1.754)</td></tr>
    <tr><td class="gt_row gt_left gt_stub">RRstar</td>
<td class="gt_row gt_center">0.907</td>
<td class="gt_row gt_center">(0.866, 0.949)</td>
<td class="gt_row gt_center" style="border-left-width: 1.5px; border-left-style: solid; border-left-color: grey60;">0.496</td>
<td class="gt_row gt_center">(0.378, 0.664)</td>
<td class="gt_row gt_center" style="border-left-width: 1.5px; border-left-style: solid; border-left-color: grey60;">0.547</td>
<td class="gt_row gt_center">(0.415, 0.736)</td></tr>
    <tr><td class="gt_row gt_left gt_stub">OR</td>
<td class="gt_row gt_center gt_striped">0.440</td>
<td class="gt_row gt_center gt_striped">(0.296, 0.663)</td>
<td class="gt_row gt_center gt_striped" style="border-left-width: 1.5px; border-left-style: solid; border-left-color: grey60;">0.253</td>
<td class="gt_row gt_center gt_striped">(0.147, 0.468)</td>
<td class="gt_row gt_center gt_striped" style="border-left-width: 1.5px; border-left-style: solid; border-left-color: grey60;">0.576</td>
<td class="gt_row gt_center gt_striped">(0.289, 1.21)</td></tr>
  </tbody>
  <tfoot class="gt_sourcenotes">
    <tr>
      <td class="gt_sourcenote" colspan="7">Fundamentals of Causal Inference, Babette A. Brumback, 2022</td>
    </tr>
  </tfoot>
  <tfoot>
    <tr class="gt_footnotes">
      <td colspan="7">
        <p class="gt_footnote">
          <sup class="gt_footnote_marks">
            <em>1</em>
          </sup>
           
          95% confidence interval
          <br />
        </p>
      </td>
    </tr>
  </tfoot>
</table>
</div>
<p>and we plot the results</p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="measures.html#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggp_measures_modif</span>(nces.out, <span class="at">title =</span> <span class="st">&quot;NCES data&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-64-1.png" width="672" /></p>
<p>We observe that</p>
<ul>
<li>RD: Risk difference shows that using selection to accept more women
seem to decrease the % of school with hogh math SAT</li>
<li>OR and RRstar: Show the same results as RD</li>
<li>RR: Indicates that selection, in relative terms <em>has no significant effect</em></li>
</ul>
</div>
</div>
<div id="qualitative-agreement-of-effect-measures-in-modification" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Qualitative Agreement of Effect Measures in Modification</h2>
<p>This section relies heavily on the paper from Shannin and Brumback (2021)
<span class="citation"><a href="#ref-shanninbrumback2021" role="doc-biblioref">Jake Shannin</a> (<a href="#ref-shanninbrumback2021" role="doc-biblioref">2021</a>)</span>. It used a Monte-Carlo simulation
in java by <a href="https://github.com/gatorjake/EffectMeasures">jake</a> running 1000000
times for six effect measures (the 4 in this chapter, the hazard ratio HR and
the recovery ration HR*).</p>
<p>For the purpose of this project we only simulate the 4 effect measures
discussed so far (RD, RR, RR* and OR). We use R package <code>MonteCarlo</code> with 5000
repetitions. The distribution used for simulation is the beta distribution
which is generally used for values in [0,1]. It is also used as a prior of
binomial regression in Bayes analysis which is the subject covered a little
later in this section. Regardless if the 6 effects measures from <span class="citation"><a href="#ref-shanninbrumback2021" role="doc-biblioref">Jake Shannin</a> (<a href="#ref-shanninbrumback2021" role="doc-biblioref">2021</a>)</span>
or the 4 from <span class="citation"><a href="#ref-brumback2022" role="doc-biblioref">Brumback</a> (<a href="#ref-brumback2022" role="doc-biblioref">2022</a>)</span> are used, the process and conclusion are the
same.</p>
<p>We point out that using the distribution <span class="math inline">\(Beta(1, 1) \sim Uniform(0, 1)\)</span> is
equivalent to running a grid search. It is also equivalent to the uniform
distribution used in <span class="citation"><a href="#ref-shanninbrumback2021" role="doc-biblioref">Jake Shannin</a> (<a href="#ref-shanninbrumback2021" role="doc-biblioref">2021</a>)</span>.</p>
<div id="simulate-the-effect-measures" class="section level3" number="4.2.1">
<h3><span class="header-section-number">4.2.1</span> Simulate the effect measures</h3>
<p>We run the Monte-Carlo simulation without constraint and with <span class="math inline">\(Beta(1,1)\)</span> which
is equivalent to <span class="math inline">\(Uniform(0,1)\)</span> used by <span class="citation"><a href="#ref-shanninbrumback2021" role="doc-biblioref">Jake Shannin</a> (<a href="#ref-shanninbrumback2021" role="doc-biblioref">2021</a>)</span>.</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="measures.html#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="fu">message</span>(<span class="st">&quot;this takes 1 sec.: we load a saved file instead&quot;</span>)</span></code></pre></div>
<pre><code>## this takes 1 sec.: we load a saved file instead</code></pre>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="measures.html#cb91-1" aria-hidden="true" tabindex="-1"></a>startTime <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb91-2"><a href="measures.html#cb91-2" aria-hidden="true" tabindex="-1"></a><span class="co"># gridsim &lt;- mc_beta_effect_measures(shape1 = 1, shape2 = 1, nrep = 5000)</span></span>
<span id="cb91-3"><a href="measures.html#cb91-3" aria-hidden="true" tabindex="-1"></a>a_file <span class="ot">&lt;-</span> <span class="fu">file.path</span>(dir_data, <span class="st">&quot;chap04_gridsim.rds&quot;</span>)</span>
<span id="cb91-4"><a href="measures.html#cb91-4" aria-hidden="true" tabindex="-1"></a><span class="co"># saveRDS(gridsim, file = a_file)</span></span>
<span id="cb91-5"><a href="measures.html#cb91-5" aria-hidden="true" tabindex="-1"></a>gridsim <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="at">file =</span> a_file)</span>
<span id="cb91-6"><a href="measures.html#cb91-6" aria-hidden="true" tabindex="-1"></a>endTime <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb91-7"><a href="measures.html#cb91-7" aria-hidden="true" tabindex="-1"></a><span class="co"># print(endTime - startTime)</span></span></code></pre></div>
<p>which gives the vector of percentages</p>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="measures.html#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="fu">unlist</span>(gridsim)</span></code></pre></div>
<pre><code>##              RD_RR          RD_RRstar              RD_OR          RR_RRstar 
##             0.0000             0.0000             0.0000             0.0000 
##              RR_OR          RRstar_OR RD_RR_vs_RRstar_OR RD_RRstar_vs_RR_OR 
##             0.0000             0.0000             0.0256             0.0278 
## RD_OR_vs_RR_RRstar       RD_RR_RRstar           RD_RR_OR       RD_RRstar_OR 
##             0.0000             0.0000             0.0556             0.0550 
##       RR_RRstar_OR    RD_RR_RRstar_OR               NONE 
##             0.0000             0.8360             0.0000</code></pre>
<p>For the following discussion, we must note the following about the vector of
percentages returned by the simulation.</p>
<ol style="list-style-type: decimal">
<li><strong>Pairwise events</strong>: Some measures move as <em>1 pair</em> in the same direction while
all the other pairs move in different direction between each other.
These are 6 possibilities named <code>RD_RR</code>,<code>RD_RRstar</code>, <code>RD_OR</code>, <code>RR_RRstar</code>, <code>RR_OR</code>, <code>RRstar_OR</code>.</li>
<li><strong>Opposite pairwise events</strong>: Some measures move as <em>2 pairs</em> but
<em>each of the 2 pairs does not move in the same direction</em>.
There are 3 possibilities, called <code>RD_RR_vs_RRstar_OR</code>,
<code>RD_RRstar_vs_RR_OR</code> and <code>RD_OR_vs_RR_RRstar</code>. <strong>These are the problematic ones
as they cannot be represented in the Venn diagram of section 4.2</strong>. However
we can distribute them to ensure probabilities add up to 1. For example
<code>RD_RR_vs_RRstar_OR</code> will be split 50% between pairwise events <code>RD_RR</code> and
50% to pairwise event<code>RRstar_OR</code>. This enforces the very important rule
that probabilities must add up to 1 without consequences on the conclusions
reached.</li>
<li><strong>3-wise events</strong>: Some 3 measures move in the same direction together There are 4 possibilities
called <code>RD_RR_RRstar</code>, <code>RD_RR_OR</code>, <code>RD_RRstar_OR</code> and <code>RR_RRstar_OR</code>.</li>
<li><strong>All events</strong>: Sometimes all measures move together.
<strong>This is the possibility of interest</strong> discussed by Shannin and Brumback (2021).
This possibility is called <code>ALL</code>.</li>
<li><strong>No event</strong>: The possibility <code>NONE</code> concerns the event that no pair of
measures move in the same direction. It is impossible and represents the empty set
<span class="math inline">\(\emptyset\)</span> which is one of the 3 conditions of a <span class="math inline">\(\sigma-field\)</span>.</li>
<li><strong>Validation</strong>: The sum of the vector’s elements must be one.</li>
</ol>
<p>The event definitions above ensure that the sample space is actually a <span class="math inline">\(\sigma-field\)</span>.
See <span class="citation"><a href="#ref-grimmett" role="doc-biblioref">Geoffrey R. Grimmet</a> (<a href="#ref-grimmett" role="doc-biblioref">2001</a>)</span>, section 1.2.</p>
<p>then we compare with the author’s results</p>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="measures.html#cb94-1" aria-hidden="true" tabindex="-1"></a>bb <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;RD_RR&quot;</span> <span class="ot">=</span> <span class="fl">0.026</span>, <span class="st">&quot;RD_RRstar&quot;</span> <span class="ot">=</span> <span class="fl">0.026</span>, <span class="st">&quot;RD_OR&quot;</span> <span class="ot">=</span> <span class="dv">0</span>, </span>
<span id="cb94-2"><a href="measures.html#cb94-2" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;RR_RRstar&quot;</span> <span class="ot">=</span> <span class="dv">0</span>, <span class="st">&quot;RR_OR&quot;</span> <span class="ot">=</span> <span class="fl">0.026</span>, <span class="st">&quot;RRstar_OR&quot;</span> <span class="ot">=</span> <span class="fl">0.026</span>,</span>
<span id="cb94-3"><a href="measures.html#cb94-3" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;RD_RR_vs_RRstar_OR&quot;</span> <span class="ot">=</span> <span class="dv">0</span>,</span>
<span id="cb94-4"><a href="measures.html#cb94-4" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;RD_RRstar_vs_RR_OR&quot;</span> <span class="ot">=</span> <span class="dv">0</span>,</span>
<span id="cb94-5"><a href="measures.html#cb94-5" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;RD_OR_vs_RR_RRstar&quot;</span> <span class="ot">=</span> <span class="dv">0</span>,</span>
<span id="cb94-6"><a href="measures.html#cb94-6" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;RD_RR_RRstar&quot;</span> <span class="ot">=</span> <span class="dv">0</span>, <span class="st">&quot;RD_RR_OR&quot;</span> <span class="ot">=</span> <span class="fl">0.057</span>, </span>
<span id="cb94-7"><a href="measures.html#cb94-7" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;RD_RRstar_OR&quot;</span> <span class="ot">=</span> <span class="fl">0.057</span>, <span class="st">&quot;RR_RRstar_OR&quot;</span> <span class="ot">=</span> <span class="dv">0</span>,</span>
<span id="cb94-8"><a href="measures.html#cb94-8" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;RD_RR_RRstar_OR&quot;</span> <span class="ot">=</span> <span class="fl">0.833</span>, <span class="st">&quot;NONE&quot;</span> <span class="ot">=</span> <span class="dv">0</span>)</span>
<span id="cb94-9"><a href="measures.html#cb94-9" aria-hidden="true" tabindex="-1"></a>comp <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">bb =</span> <span class="fu">round</span>(bb, <span class="dv">4</span>), <span class="at">sim =</span> <span class="fu">round</span>(<span class="fu">unlist</span>(gridsim), <span class="dv">4</span>))</span>
<span id="cb94-10"><a href="measures.html#cb94-10" aria-hidden="true" tabindex="-1"></a>comp</span></code></pre></div>
<pre><code>##                       bb    sim
## RD_RR              0.026 0.0000
## RD_RRstar          0.026 0.0000
## RD_OR              0.000 0.0000
## RR_RRstar          0.000 0.0000
## RR_OR              0.026 0.0000
## RRstar_OR          0.026 0.0000
## RD_RR_vs_RRstar_OR 0.000 0.0256
## RD_RRstar_vs_RR_OR 0.000 0.0278
## RD_OR_vs_RR_RRstar 0.000 0.0000
## RD_RR_RRstar       0.000 0.0000
## RD_RR_OR           0.057 0.0556
## RD_RRstar_OR       0.057 0.0550
## RR_RRstar_OR       0.000 0.0000
## RD_RR_RRstar_OR    0.833 0.8360
## NONE               0.000 0.0000</code></pre>
<p>The results from the Monte Carlo simulation above confirm the main conclusion
from <span class="citation"><a href="#ref-shanninbrumback2021" role="doc-biblioref">Jake Shannin</a> (<a href="#ref-shanninbrumback2021" role="doc-biblioref">2021</a>)</span> that all effect measures move together 84% of the time.</p>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="measures.html#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="st">&quot;simulation&quot;</span> <span class="ot">=</span> <span class="fu">unname</span>(<span class="fu">unlist</span>(gridsim[<span class="st">&quot;RD_RR_RRstar_OR&quot;</span>])), </span>
<span id="cb96-2"><a href="measures.html#cb96-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;author&#39;s&quot;</span> <span class="ot">=</span> <span class="fu">unname</span>(bb[<span class="st">&quot;RD_RR_RRstar_OR&quot;</span>]))</span></code></pre></div>
<pre><code>## simulation   author&#39;s 
##      0.836      0.833</code></pre>
<p>We note that the sim adds up correctly to 1 but not the author’s which adds up
to 1.051. This is explained on p. 72 as a bit of arbitrary allocations. The
<span class="citation"><a href="#ref-shanninbrumback2021" role="doc-biblioref">Jake Shannin</a> (<a href="#ref-shanninbrumback2021" role="doc-biblioref">2021</a>)</span> paper (caption figure 1) mentions that they do not
add to 1 because they include events that <em>are not mutually exclusive</em>.</p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="measures.html#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="st">&quot;simulation&quot;</span> <span class="ot">=</span> <span class="fu">sum</span>(<span class="fu">unlist</span>(gridsim)), <span class="st">&quot;author&#39;s&quot;</span> <span class="ot">=</span> <span class="fu">sum</span>(bb))</span></code></pre></div>
<pre><code>## simulation   author&#39;s 
##      1.000      1.051</code></pre>
<p>Actually, this is caused by the <strong>Opposite pairwise events</strong> which cannot be
represented in the 4-set Venn diagram. For the purpose of this
books we will simply split them between the events that makes them up without
consequence on the conclusion.</p>
<p>The <strong>Opposite pairwise events</strong> are the following</p>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="measures.html#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="co"># The events that pair of measures move together but in opposite</span></span>
<span id="cb100-2"><a href="measures.html#cb100-2" aria-hidden="true" tabindex="-1"></a><span class="co"># direction of another pair who also move together</span></span>
<span id="cb100-3"><a href="measures.html#cb100-3" aria-hidden="true" tabindex="-1"></a><span class="fu">unlist</span>(gridsim[<span class="fu">c</span>(<span class="st">&quot;RD_RR_vs_RRstar_OR&quot;</span>, <span class="st">&quot;RD_RRstar_vs_RR_OR&quot;</span>, <span class="st">&quot;RD_OR_vs_RR_RRstar&quot;</span>)])</span></code></pre></div>
<pre><code>## RD_RR_vs_RRstar_OR RD_RRstar_vs_RR_OR RD_OR_vs_RR_RRstar 
##             0.0256             0.0278             0.0000</code></pre>
<p>and when we split them between their 2 sub-events we can generate the
Venn diagram as follows</p>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="measures.html#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggp_venn_sim</span>(gridsim, <span class="at">n =</span> <span class="dv">1000</span>, </span>
<span id="cb102-2"><a href="measures.html#cb102-2" aria-hidden="true" tabindex="-1"></a>         <span class="at">fill_colr =</span> <span class="fu">c</span>(<span class="st">&quot;blue&quot;</span>, <span class="st">&quot;yellow&quot;</span>, <span class="st">&quot;green&quot;</span>, <span class="st">&quot;red&quot;</span>),</span>
<span id="cb102-3"><a href="measures.html#cb102-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">title =</span> <span class="st">&quot;Venn diagram of effect measure modifications&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-71-1.png" width="672" /></p>
<p>now for <strong>constrained data</strong></p>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="measures.html#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="fu">message</span>(<span class="st">&quot;this takes 1 sec.: we load a saved file instead&quot;</span>)</span></code></pre></div>
<pre><code>## this takes 1 sec.: we load a saved file instead</code></pre>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="measures.html#cb105-1" aria-hidden="true" tabindex="-1"></a>startTime <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb105-2"><a href="measures.html#cb105-2" aria-hidden="true" tabindex="-1"></a><span class="co"># gridsim_const &lt;- mc_beta_effect_measures(shape1 = 1, shape2 = 1, nrep = 5000,</span></span>
<span id="cb105-3"><a href="measures.html#cb105-3" aria-hidden="true" tabindex="-1"></a><span class="co">#                                       constrained = TRUE)</span></span>
<span id="cb105-4"><a href="measures.html#cb105-4" aria-hidden="true" tabindex="-1"></a>a_file <span class="ot">&lt;-</span> <span class="fu">file.path</span>(dir_data, <span class="st">&quot;chap04_gridsim_const.rds&quot;</span>)</span>
<span id="cb105-5"><a href="measures.html#cb105-5" aria-hidden="true" tabindex="-1"></a><span class="co"># saveRDS(gridsim_const, file = a_file)</span></span>
<span id="cb105-6"><a href="measures.html#cb105-6" aria-hidden="true" tabindex="-1"></a>gridsim_const <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="at">file =</span> a_file)</span>
<span id="cb105-7"><a href="measures.html#cb105-7" aria-hidden="true" tabindex="-1"></a>endTime <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb105-8"><a href="measures.html#cb105-8" aria-hidden="true" tabindex="-1"></a><span class="co"># print(endTime - startTime)</span></span></code></pre></div>
<p>which gives the vector of percentages</p>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="measures.html#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="fu">unlist</span>(gridsim_const)</span></code></pre></div>
<pre><code>##              RD_RR          RD_RRstar              RD_OR          RR_RRstar 
##          0.0000000          0.0000000          0.0000000          0.0000000 
##              RR_OR          RRstar_OR RD_RR_vs_RRstar_OR RD_RRstar_vs_RR_OR 
##          0.0000000          0.0000000          0.0486166          0.0541502 
## RD_OR_vs_RR_RRstar       RD_RR_RRstar           RD_RR_OR       RD_RRstar_OR 
##          0.0000000          0.0000000          0.1177866          0.1158103 
##       RR_RRstar_OR    RD_RR_RRstar_OR               NONE 
##          0.0000000          0.6636364          0.0000000</code></pre>
<p>and comparing to the author’s results</p>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="measures.html#cb108-1" aria-hidden="true" tabindex="-1"></a>bb_const <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;RD_RR&quot;</span> <span class="ot">=</span> <span class="fl">0.053</span>, <span class="st">&quot;RD_RRstar&quot;</span> <span class="ot">=</span> <span class="fl">0.053</span>, <span class="st">&quot;RD_OR&quot;</span> <span class="ot">=</span> <span class="fl">0.053</span>, </span>
<span id="cb108-2"><a href="measures.html#cb108-2" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;RR_RRstar&quot;</span> <span class="ot">=</span> <span class="dv">0</span>, <span class="st">&quot;RR_OR&quot;</span> <span class="ot">=</span> <span class="fl">0.053</span>, <span class="st">&quot;RRstar_OR&quot;</span> <span class="ot">=</span> <span class="fl">0.0</span>,</span>
<span id="cb108-3"><a href="measures.html#cb108-3" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;RD_RR_vs_RRstar_OR&quot;</span> <span class="ot">=</span> <span class="dv">0</span>,</span>
<span id="cb108-4"><a href="measures.html#cb108-4" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;RD_RRstar_vs_RR_OR&quot;</span> <span class="ot">=</span> <span class="dv">0</span>,</span>
<span id="cb108-5"><a href="measures.html#cb108-5" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;RD_OR_vs_RR_RRstar&quot;</span> <span class="ot">=</span> <span class="dv">0</span>,</span>
<span id="cb108-6"><a href="measures.html#cb108-6" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;RD_RR_RRstar&quot;</span> <span class="ot">=</span> <span class="dv">0</span>, <span class="st">&quot;RD_RR_OR&quot;</span> <span class="ot">=</span> <span class="fl">0.114</span>, </span>
<span id="cb108-7"><a href="measures.html#cb108-7" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;RD_RRstar_OR&quot;</span> <span class="ot">=</span> <span class="fl">0.114</span>, <span class="st">&quot;RR_RRstar_OR&quot;</span> <span class="ot">=</span> <span class="dv">0</span>,</span>
<span id="cb108-8"><a href="measures.html#cb108-8" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;RD_RR_RRstar_OR&quot;</span> <span class="ot">=</span> <span class="fl">0.667</span>, <span class="st">&quot;NONE&quot;</span> <span class="ot">=</span> <span class="dv">0</span>)</span>
<span id="cb108-9"><a href="measures.html#cb108-9" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(bb_const)</span></code></pre></div>
<pre><code>## [1] 1.107</code></pre>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="measures.html#cb110-1" aria-hidden="true" tabindex="-1"></a>comp <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">bb =</span> <span class="fu">round</span>(bb_const, <span class="dv">4</span>), </span>
<span id="cb110-2"><a href="measures.html#cb110-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">sim =</span> <span class="fu">round</span>(<span class="fu">unlist</span>(gridsim_const), <span class="dv">4</span>))</span>
<span id="cb110-3"><a href="measures.html#cb110-3" aria-hidden="true" tabindex="-1"></a>comp</span></code></pre></div>
<pre><code>##                       bb    sim
## RD_RR              0.053 0.0000
## RD_RRstar          0.053 0.0000
## RD_OR              0.053 0.0000
## RR_RRstar          0.000 0.0000
## RR_OR              0.053 0.0000
## RRstar_OR          0.000 0.0000
## RD_RR_vs_RRstar_OR 0.000 0.0486
## RD_RRstar_vs_RR_OR 0.000 0.0542
## RD_OR_vs_RR_RRstar 0.000 0.0000
## RD_RR_RRstar       0.000 0.0000
## RD_RR_OR           0.114 0.1178
## RD_RRstar_OR       0.114 0.1158
## RR_RRstar_OR       0.000 0.0000
## RD_RR_RRstar_OR    0.667 0.6636
## NONE               0.000 0.0000</code></pre>
<p>The results from the Monte Carlo simulation with the constrained data
agree the author’s result.</p>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="measures.html#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="st">&quot;simulation&quot;</span> <span class="ot">=</span> <span class="fu">unname</span>(<span class="fu">unlist</span>(gridsim_const[<span class="st">&quot;RD_RR_RRstar_OR&quot;</span>])),</span>
<span id="cb112-2"><a href="measures.html#cb112-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;author&#39;s&quot;</span> <span class="ot">=</span> <span class="fu">unname</span>(bb_const[<span class="st">&quot;RD_RR_RRstar_OR&quot;</span>]))</span></code></pre></div>
<pre><code>## simulation   author&#39;s 
##  0.6636364  0.6670000</code></pre>
<p>Again the <strong>Opposite pairwise events</strong> cannot be represented
in the 4-set Venn diagram.</p>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="measures.html#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="co"># The events that pair of measures move together but in opposite</span></span>
<span id="cb114-2"><a href="measures.html#cb114-2" aria-hidden="true" tabindex="-1"></a><span class="co"># direction of another pair who also move together</span></span>
<span id="cb114-3"><a href="measures.html#cb114-3" aria-hidden="true" tabindex="-1"></a><span class="fu">unlist</span>(gridsim_const[<span class="fu">c</span>(<span class="st">&quot;RD_RR_vs_RRstar_OR&quot;</span>, <span class="st">&quot;RD_RRstar_vs_RR_OR&quot;</span>, <span class="st">&quot;RD_OR_vs_RR_RRstar&quot;</span>)])</span></code></pre></div>
<pre><code>## RD_RR_vs_RRstar_OR RD_RRstar_vs_RR_OR RD_OR_vs_RR_RRstar 
##          0.0486166          0.0541502          0.0000000</code></pre>
<p>but if we do it as mentioned above then we can show a Venn diagram as follows</p>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="measures.html#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="co"># This is a custom function using the venn package</span></span>
<span id="cb116-2"><a href="measures.html#cb116-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggp_venn_sim</span>(gridsim_const,</span>
<span id="cb116-3"><a href="measures.html#cb116-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">fill_colr =</span> <span class="fu">c</span>(<span class="st">&quot;cyan&quot;</span>, <span class="st">&quot;gold&quot;</span>, <span class="st">&quot;springgreen&quot;</span>, <span class="st">&quot;hotpink&quot;</span>),</span>
<span id="cb116-4"><a href="measures.html#cb116-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">title =</span> <span class="st">&quot;Venn diagram for constrained data&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-77-1.png" width="672" /></p>
</div>
<div id="applications" class="section level3" number="4.2.2">
<h3><span class="header-section-number">4.2.2</span> Applications</h3>
<div id="simulation-of-distribution-of-effect-measures" class="section level4" number="4.2.2.1">
<h4><span class="header-section-number">4.2.2.1</span> Simulation of distribution of effect measures</h4>
<p>We use a parametric Monte Carlo simulation using the beta distribution
to evaluate the effect of the distribution assumption on the effect-measure
modifications.</p>
<p>We run the Monte-Carlo simulation with 5000 repetitions, a grid of
<code>shape1</code> and <code>shape2</code> parameters for the Beta distribution and no
constraint. Namely <code>mc_beta_effect_measures(shape1 = c(0.5, 1, 3, 5, 7), shape2 = c(0.5, 1, 3, 5, 7), nrep = 5000)</code></p>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="measures.html#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="fu">message</span>(<span class="st">&quot;this takes 25 sec.: we load a saved file instead&quot;</span>)</span></code></pre></div>
<pre><code>## this takes 25 sec.: we load a saved file instead</code></pre>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="measures.html#cb119-1" aria-hidden="true" tabindex="-1"></a>startTime <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb119-2"><a href="measures.html#cb119-2" aria-hidden="true" tabindex="-1"></a><span class="co"># priorsim &lt;- mc_beta_effect_measures(shape1 = c(0.5, 1, 3, 5, 7),</span></span>
<span id="cb119-3"><a href="measures.html#cb119-3" aria-hidden="true" tabindex="-1"></a><span class="co">#                                   shape2 = c(0.5, 1, 3, 5, 7),</span></span>
<span id="cb119-4"><a href="measures.html#cb119-4" aria-hidden="true" tabindex="-1"></a><span class="co">#                                   nrep = 5000)</span></span>
<span id="cb119-5"><a href="measures.html#cb119-5" aria-hidden="true" tabindex="-1"></a>a_file <span class="ot">&lt;-</span> <span class="fu">file.path</span>(dir_data, <span class="st">&quot;chap04_priorsim.rds&quot;</span>)</span>
<span id="cb119-6"><a href="measures.html#cb119-6" aria-hidden="true" tabindex="-1"></a><span class="co"># saveRDS(priorsim, file = a_file)</span></span>
<span id="cb119-7"><a href="measures.html#cb119-7" aria-hidden="true" tabindex="-1"></a>priorsim <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="at">file =</span> a_file)</span>
<span id="cb119-8"><a href="measures.html#cb119-8" aria-hidden="true" tabindex="-1"></a>endTime <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb119-9"><a href="measures.html#cb119-9" aria-hidden="true" tabindex="-1"></a><span class="co"># print(endTime - startTime)</span></span></code></pre></div>
<p>and we look at the matrix for the event <code>RD_RR_RRstar_OR</code> which represents the
event that all effect measures move in the same direction.</p>
<p>The matrix elements correspond to the percentage frequency of the event given
the beta distribution with shape parameters <code>shape1 = s1</code> with <code>s1</code> indicated
as column names, and <code>shape2 = s1</code> parameter with <code>s2</code> indicated in the row names.</p>
<p>The beta distribution with <code>shape1 = 1</code> and <code>shape2 = 1</code> is similar to the uniform
distribution on <span class="math inline">\([0, 1]\)</span>. Therefore this element is the one simulated by Shannon
and Brumback, see <span class="citation"><a href="#ref-shanninbrumback2021" role="doc-biblioref">Jake Shannin</a> (<a href="#ref-shanninbrumback2021" role="doc-biblioref">2021</a>)</span> and, in fact, with 5000 repetitions
<code>nrep = 5000</code>the measure is almost always very close to what is mentioned
in <span class="citation"><a href="#ref-shanninbrumback2021" role="doc-biblioref">Jake Shannin</a> (<a href="#ref-shanninbrumback2021" role="doc-biblioref">2021</a>)</span>.</p>
<p>Also note that for large <span class="math inline">\(shape1 = shape2 = \text{large number}\)</span> the beta distribution
is similar to the normal distribution with a mean of <span class="math inline">\(shape1 / (shape1 + shape2)\)</span>.
The simulation shows that in that case the percentage of measures moving in the
same directions is nearing 100%. See for example when <span class="math inline">\(shape1 = shape2 = 7\)</span> in
the matrix of results from the sim.</p>
<p>here is the matrix of percentage of times that all measures move in the same
direction, i.e. the event <code>RD_RR_RRstar_OR</code></p>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="measures.html#cb120-1" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(priorsim[[<span class="st">&quot;RD_RR_RRstar_OR&quot;</span>]], <span class="dv">2</span>)</span></code></pre></div>
<pre><code>##        s1=0.5 s1=1 s1=3 s1=5 s1=7
## s2=0.5   0.77 0.81 0.83 0.82 0.83
## s2=1     0.81 0.83 0.86 0.87 0.86
## s2=3     0.82 0.86 0.90 0.91 0.91
## s2=5     0.82 0.86 0.90 0.92 0.93
## s2=7     0.84 0.86 0.91 0.93 0.93</code></pre>
<p>and to show as a heatmap</p>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb122-1"><a href="measures.html#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggp_betasim</span>(priorsim, <span class="at">var =</span> <span class="st">&quot;RD_RR_RRstar_OR&quot;</span>, </span>
<span id="cb122-2"><a href="measures.html#cb122-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">colr =</span> <span class="fu">list</span>(<span class="st">&quot;low&quot;</span> <span class="ot">=</span> <span class="st">&quot;deepskyblue1&quot;</span>, <span class="st">&quot;high&quot;</span> <span class="ot">=</span> <span class="st">&quot;deepskyblue4&quot;</span>))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-80-1.png" width="672" /></p>
<p>and comparing with the author</p>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="measures.html#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">c</span>(<span class="st">&quot;simulation&quot;</span> <span class="ot">=</span> priorsim[[<span class="st">&quot;RD_RR_RRstar_OR&quot;</span>]][<span class="st">&quot;s2=1&quot;</span>, <span class="st">&quot;s1=1&quot;</span>], </span>
<span id="cb123-2"><a href="measures.html#cb123-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;author&#39;s&quot;</span> <span class="ot">=</span> <span class="fu">unname</span>(bb[<span class="st">&quot;RD_RR_RRstar_OR&quot;</span>])), <span class="dv">3</span>)</span></code></pre></div>
<pre><code>## simulation   author&#39;s 
##      0.833      0.833</code></pre>
<p>We can see that the range is wide and should be considered.</p>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="measures.html#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="fu">range</span>(priorsim[[<span class="st">&quot;RD_RR_RRstar_OR&quot;</span>]])</span></code></pre></div>
<pre><code>## [1] 0.7732 0.9344</code></pre>
<p>Now we do it with constrained data</p>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="measures.html#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="fu">message</span>(<span class="st">&quot;this takes 30 sec.: we load a saved file instead&quot;</span>)</span></code></pre></div>
<pre><code>## this takes 30 sec.: we load a saved file instead</code></pre>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="measures.html#cb129-1" aria-hidden="true" tabindex="-1"></a>startTime <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb129-2"><a href="measures.html#cb129-2" aria-hidden="true" tabindex="-1"></a><span class="co"># priorsim_const &lt;- mc_beta_effect_measures(shape1 = c(0.5, 1, 3, 5, 7),</span></span>
<span id="cb129-3"><a href="measures.html#cb129-3" aria-hidden="true" tabindex="-1"></a><span class="co">#                                         shape2 = c(0.5, 1, 3, 5, 7),</span></span>
<span id="cb129-4"><a href="measures.html#cb129-4" aria-hidden="true" tabindex="-1"></a><span class="co">#                                         nrep = 5000, constrained = TRUE)</span></span>
<span id="cb129-5"><a href="measures.html#cb129-5" aria-hidden="true" tabindex="-1"></a>a_file <span class="ot">&lt;-</span> <span class="fu">file.path</span>(dir_data, <span class="st">&quot;chap04_priorsim_const.rds&quot;</span>)</span>
<span id="cb129-6"><a href="measures.html#cb129-6" aria-hidden="true" tabindex="-1"></a><span class="co"># saveRDS(priorsim_const, file = a_file)</span></span>
<span id="cb129-7"><a href="measures.html#cb129-7" aria-hidden="true" tabindex="-1"></a>priorsim_const <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="at">file =</span> a_file)</span>
<span id="cb129-8"><a href="measures.html#cb129-8" aria-hidden="true" tabindex="-1"></a>endTime <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb129-9"><a href="measures.html#cb129-9" aria-hidden="true" tabindex="-1"></a><span class="co"># print(endTime - startTime)</span></span></code></pre></div>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb130-1"><a href="measures.html#cb130-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggp_betasim</span>(priorsim_const, <span class="at">var =</span> <span class="st">&quot;RD_RR_RRstar_OR&quot;</span>,</span>
<span id="cb130-2"><a href="measures.html#cb130-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">colr =</span> <span class="fu">list</span>(<span class="st">&quot;low&quot;</span> <span class="ot">=</span> <span class="st">&quot;lightsalmon1&quot;</span>, <span class="st">&quot;high&quot;</span> <span class="ot">=</span> <span class="st">&quot;lightsalmon4&quot;</span>),</span>
<span id="cb130-3"><a href="measures.html#cb130-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">title =</span> <span class="st">&quot;Monte Carlo simulation. Constrained data.&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-84-1.png" width="672" /></p>
<p>and comparing with the author</p>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="measures.html#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">c</span>(<span class="st">&quot;simulation&quot;</span> <span class="ot">=</span> priorsim_const[[<span class="st">&quot;RD_RR_RRstar_OR&quot;</span>]][<span class="st">&quot;s2=1&quot;</span>, <span class="st">&quot;s1=1&quot;</span>], </span>
<span id="cb131-2"><a href="measures.html#cb131-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;author&#39;s&quot;</span> <span class="ot">=</span> <span class="fu">unname</span>(bb_const[<span class="st">&quot;RD_RR_RRstar_OR&quot;</span>])), <span class="dv">3</span>)</span></code></pre></div>
<pre><code>## simulation   author&#39;s 
##      0.662      0.667</code></pre>
<p>and the range is even larger and therefore more significant.</p>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="measures.html#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="fu">range</span>(priorsim_const[[<span class="st">&quot;RD_RR_RRstar_OR&quot;</span>]])</span></code></pre></div>
<pre><code>## [1] 0.5710824 0.8565217</code></pre>
</div>
<div id="application-data-pre-processing-data-cleaning" class="section level4" number="4.2.2.2">
<h4><span class="header-section-number">4.2.2.2</span> Application: Data pre-processing (data cleaning)</h4>
<p>Unless the <span class="math inline">\(p_0, p_1\)</span> obtained are uniformly distributed
(not the most common scenario for sure) it seems from the
results above that the likelihood of <em>not</em> having all effect measures moving
in the same direction is low. Thus, it could be a good hint to uncover hidden
processes in a data pre-processing routine.</p>
<p>We note the important rule mentioned at the beginning of section 4.2</p>
<blockquote>
<p>when relative risk <span class="math inline">\(RR\)</span> and other relative risk <span class="math inline">\(RR^*\)</span> both change in the
same direction […] then so must the difference the risk difference and
odds ratio.</p>
</blockquote>
<p>Another rule from section 4.2 can help in data cleaning</p>
<blockquote>
<p>When <span class="math inline">\(RR_0\)</span> and <span class="math inline">\(RR_1\)</span> are on opposite side of 1, that is, when in one stratum
the treatment is helpful and in the other it is harmful, then all measures
will automatically change together.</p>
</blockquote>
<p>Thus a quick, easy way to clean up potential data problems and obtain relevant
details on outliers and <strong>hidden processes</strong> might be</p>
<ol style="list-style-type: decimal">
<li>Exclude cases when <span class="math inline">\(RR\)</span> and <span class="math inline">\(RR^*\)</span> change in the same direction to reduce
the data load.</li>
<li>Exclude cases when <span class="math inline">\(RR_0\)</span> and <span class="math inline">\(RR_1\)</span> are on opposite side of 1</li>
<li>Investigate the remining cases asthey are good candidates for <em>hidden processes</em></li>
</ol>
</div>
<div id="application-bayesian-prior-in-beta-binomial-model" class="section level4" number="4.2.2.3">
<h4><span class="header-section-number">4.2.2.3</span> Application: Bayesian prior in Beta-binomial model</h4>
<p>If we use information from the population, or from expert knowledge,
that effect measures should move in the same direction then a beta distribution with <span class="math inline">\(shape1 &gt; 1, shape2 &gt; 1\)</span>
would make sense and provide a better prior for the Beta-binomial model.</p>
<p>On the contrary, if we wish that the model look into the unlikely events
that effect measure do not move in the same directions, then
a beta distribution with <span class="math inline">\(shape1 \leq 1, shape2 \leq 1\)</span> could be supported
by the results from above.</p>
</div>
</div>
</div>
<div id="causal-interaction" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Causal Interaction</h2>
</div>
<div id="exercises-3" class="section level2" number="4.4">
<h2><span class="header-section-number">4.4</span> Exercises</h2>
<p>Please note that the solutions to exercises of <span class="citation"><a href="#ref-brumback2022" role="doc-biblioref">Brumback</a> (<a href="#ref-brumback2022" role="doc-biblioref">2022</a>)</span> below are my own
and have not been verified or approved in any way by the author.</p>
<div id="exercise-1-3" class="section level3" number="4.4.1">
<h3><span class="header-section-number">4.4.1</span> Exercise 1</h3>
<p>Comment: Using the causal power, the conclusion is different than the official
answer. It is not obvious why the official solution does not make use of
the <em>causal power</em>.</p>
<p>Let <span class="math inline">\(Y \in \{0,1\}\)</span> mean that there is a cost barrier <span class="math inline">\(Y=1\)</span> or not <span class="math inline">\(Y=0\)</span>.</p>
<p>Let <span class="math inline">\(T \in \{0,1\}\)</span> mean that the individual is a person with disability <span class="math inline">\(T=1\)</span>
or not <span class="math inline">\(T=0\)</span></p>
<p>Let <span class="math inline">\(M \in \{0,1\}\)</span> mean that the individual is 65-year or older <span class="math inline">\(M = 1\)</span> or
is younger than 65 year-old <span class="math inline">\(M=0\)</span>.</p>
<p>and so we are given that</p>
<p><span class="math display">\[
p_0 = \hat{E}(Y \mid T = 0, M = 0) = 0.225 \\
p_1 = \hat{E}(Y \mid T = 1, M = 0) = 0.383 \\
p_2 = \hat{E}(Y \mid T = 0, M = 1) = 0.04 \\
p_3 = \hat{E}(Y \mid T = 1, M = 1) = 0.072 
\]</span></p>
<p>and so we compute the effect measures by age group</p>
<p><span class="math display">\[
\begin{align*}
RD_0 &amp;= p_1 - p_0 = 0.383-0.225  \\
RD_1 &amp;= p_3 - p_2 = 0.072-0.04 \\
RR_0 &amp;= \frac{p_1}{p_0} = \frac{0.383}{0.225} \\
RR_1 &amp;= \frac{p_3}{p_2} = \frac{0.072}{0.04} \\
RR^*_0 &amp;= \frac{1-p_0}{1-p_1}=\frac{1-0.225}{1-0.383} \\
RR^*_1 &amp;= \frac{1-p_2}{1-p_3}=\frac{1-0.04}{1-0.072} \\
RO_0 &amp;= \frac{\frac{p_1}{1-p_1}}{\frac{p_0}{1-p_0}} \\
RO_1 &amp;= \frac{\frac{p_3}{1-p_3}}{\frac{p_2}{1-p_2}}
\end{align*}
\]</span></p>
<p>which gives</p>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb135-1"><a href="measures.html#cb135-1" aria-hidden="true" tabindex="-1"></a>p0 <span class="ot">&lt;-</span> <span class="fl">0.225</span></span>
<span id="cb135-2"><a href="measures.html#cb135-2" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fl">0.383</span></span>
<span id="cb135-3"><a href="measures.html#cb135-3" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fl">0.04</span></span>
<span id="cb135-4"><a href="measures.html#cb135-4" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fl">0.072</span></span>
<span id="cb135-5"><a href="measures.html#cb135-5" aria-hidden="true" tabindex="-1"></a>RD0 <span class="ot">&lt;-</span> p1 <span class="sc">-</span> p0</span>
<span id="cb135-6"><a href="measures.html#cb135-6" aria-hidden="true" tabindex="-1"></a>RD1 <span class="ot">&lt;-</span> p3 <span class="sc">-</span> p2</span>
<span id="cb135-7"><a href="measures.html#cb135-7" aria-hidden="true" tabindex="-1"></a>RR0 <span class="ot">&lt;-</span> p1 <span class="sc">/</span> p0</span>
<span id="cb135-8"><a href="measures.html#cb135-8" aria-hidden="true" tabindex="-1"></a>RR1 <span class="ot">&lt;-</span> p3 <span class="sc">/</span> p2</span>
<span id="cb135-9"><a href="measures.html#cb135-9" aria-hidden="true" tabindex="-1"></a>RR0star <span class="ot">&lt;-</span> (<span class="dv">1</span><span class="sc">-</span>p0) <span class="sc">/</span> (<span class="dv">1</span><span class="sc">-</span>p1)</span>
<span id="cb135-10"><a href="measures.html#cb135-10" aria-hidden="true" tabindex="-1"></a>RR1star <span class="ot">&lt;-</span> (<span class="dv">1</span><span class="sc">-</span>p2) <span class="sc">/</span> (<span class="dv">1</span><span class="sc">-</span>p3)</span>
<span id="cb135-11"><a href="measures.html#cb135-11" aria-hidden="true" tabindex="-1"></a>RO0 <span class="ot">&lt;-</span> (p1 <span class="sc">/</span> (<span class="dv">1</span><span class="sc">-</span>p1)) <span class="sc">/</span> (p0 <span class="sc">/</span> (<span class="dv">1</span><span class="sc">-</span>p0))</span>
<span id="cb135-12"><a href="measures.html#cb135-12" aria-hidden="true" tabindex="-1"></a>RO1 <span class="ot">&lt;-</span> (p3 <span class="sc">/</span> (<span class="dv">1</span><span class="sc">-</span>p3)) <span class="sc">/</span> (p2 <span class="sc">/</span> (<span class="dv">1</span><span class="sc">-</span>p2))</span>
<span id="cb135-13"><a href="measures.html#cb135-13" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="st">&quot;RD0&quot;</span> <span class="ot">=</span> RD0, <span class="st">&quot;RD1&quot;</span> <span class="ot">=</span> RD1, <span class="st">&quot;RR0&quot;</span> <span class="ot">=</span> RR0, <span class="st">&quot;RR1&quot;</span> <span class="ot">=</span> RR1,</span>
<span id="cb135-14"><a href="measures.html#cb135-14" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;RR0star&quot;</span> <span class="ot">=</span> RR0star, <span class="st">&quot;RR1star&quot;</span> <span class="ot">=</span> RR1star, <span class="st">&quot;RO0&quot;</span> <span class="ot">=</span> RO0, <span class="st">&quot;RO1&quot;</span> <span class="ot">=</span> RO1)</span></code></pre></div>
<pre><code>##      RD0      RD1      RR0      RR1  RR0star  RR1star      RO0      RO1 
## 0.158000 0.032000 1.702222 1.800000 1.256078 1.034483 2.138124 1.862069</code></pre>
<p>and if we define</p>
<p><span class="math display">\[
\begin{align*}
RD &amp;= RD_1 - RD_0 \\
RR &amp;= RR_1 - RR_0 \\
RRstar &amp;= RR1star_1 - RRstar_0 \\
RO &amp;= RO_1 - RO_0
\end{align*}
\]</span></p>
<p>then</p>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb137-1"><a href="measures.html#cb137-1" aria-hidden="true" tabindex="-1"></a>RD <span class="ot">=</span> RD1 <span class="sc">-</span> RD0</span>
<span id="cb137-2"><a href="measures.html#cb137-2" aria-hidden="true" tabindex="-1"></a>RR <span class="ot">=</span> RR1 <span class="sc">-</span> RR0</span>
<span id="cb137-3"><a href="measures.html#cb137-3" aria-hidden="true" tabindex="-1"></a>RRstar <span class="ot">=</span> RR1star <span class="sc">-</span> RR0star</span>
<span id="cb137-4"><a href="measures.html#cb137-4" aria-hidden="true" tabindex="-1"></a>RO <span class="ot">=</span> RO1 <span class="sc">-</span> RO0</span>
<span id="cb137-5"><a href="measures.html#cb137-5" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="st">&quot;RD&quot;</span> <span class="ot">=</span> RD, <span class="st">&quot;RR&quot;</span> <span class="ot">=</span> RR, <span class="st">&quot;RRstar&quot;</span> <span class="ot">=</span> RRstar, <span class="st">&quot;RO&quot;</span> <span class="ot">=</span> RO)</span></code></pre></div>
<pre><code>##          RD          RR      RRstar          RO 
## -0.12600000  0.09777778 -0.22159504 -0.27605457</code></pre>
<p><em>Is there a clear answer to determining which age group has a stronger effect
of disability having a cost barrier to health care?</em></p>
<p>The difference in <span class="math inline">\(RD\)</span> from people 65-year older and younger ones is -0.126
but the difference in Risk ratio <span class="math inline">\(RR\)</span> is 0.098 and therefore not in the same
direction which normally is a minority case and needs to investigated before
reaching a conclusion. Thereofre, no, there is no clear answer to the question.</p>
<p><em>Which age group would benefit the most from an intervention?</em></p>
<p>The causal power (see p. 45) <span class="math inline">\(CP_0\)</span> represents the fraction of people who are
younger than 65 year-old who have a disability would not have met a cost barrier
to health if they had received helped to compensate for their disabilities.</p>
<p><span class="math display">\[
CP_0 = \frac{p_1 - p_0}{1-p_0}= \frac{0.383-0.225}{1-0.225} = 0.2
\]</span></p>
<p>The causal power (see p. 45) <span class="math inline">\(CP_1\)</span> represents the fraction of people who are
older than 65 year-old who have a disability would not have met a cost barrier
to health if they had received helped to compensate for their disabilities.</p>
<p><span class="math display">\[
CP_1 = \frac{p_3 - p_2}{1-p_2}= \frac{0.072-0.04}{1-0.04} = 0.3
\]</span></p>
<p>Therefore it seems that the help would benefit people older than 65 about 50%
more than younger people. However we have to be careful since, as mentioned
above, not ll measures move in the same direction and further investigation is
necessary.</p>
</div>
<div id="exercise-2-3" class="section level3" number="4.4.2">
<h3><span class="header-section-number">4.4.2</span> Exercise 2</h3>
<p>We process the data with function <code>boot</code> from above.</p>
<div class="sourceCode" id="cb139"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb139-1"><a href="measures.html#cb139-1" aria-hidden="true" tabindex="-1"></a>sepsis.out <span class="ot">&lt;-</span> <span class="fu">boot</span>(sepsis, <span class="at">formula =</span> zubrod45 <span class="sc">~</span> shock <span class="sc">+</span> gt65)</span></code></pre></div>
<p>then create the table of results</p>
<div class="sourceCode" id="cb140"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb140-1"><a href="measures.html#cb140-1" aria-hidden="true" tabindex="-1"></a><span class="fu">gt_measures_modif</span>(sepsis.out, <span class="at">title =</span> <span class="st">&quot;**Sepsis Study**&quot;</span>)</span></code></pre></div>
<div id="jpsnetghha" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#jpsnetghha .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#jpsnetghha .gt_heading {
  background-color: #DCDCDC;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#jpsnetghha .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: bold;
  padding-top: 4px;
  padding-bottom: 4px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#jpsnetghha .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: bold;
  padding-top: 0;
  padding-bottom: 6px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#jpsnetghha .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#jpsnetghha .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#jpsnetghha .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#jpsnetghha .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#jpsnetghha .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#jpsnetghha .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#jpsnetghha .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#jpsnetghha .gt_group_heading {
  padding: 8px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#jpsnetghha .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#jpsnetghha .gt_from_md > :first-child {
  margin-top: 0;
}

#jpsnetghha .gt_from_md > :last-child {
  margin-bottom: 0;
}

#jpsnetghha .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#jpsnetghha .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 12px;
}

#jpsnetghha .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#jpsnetghha .gt_first_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
}

#jpsnetghha .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#jpsnetghha .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#jpsnetghha .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#jpsnetghha .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#jpsnetghha .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#jpsnetghha .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding: 4px;
}

#jpsnetghha .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#jpsnetghha .gt_sourcenote {
  font-size: 90%;
  padding: 4px;
}

#jpsnetghha .gt_left {
  text-align: left;
}

#jpsnetghha .gt_center {
  text-align: center;
}

#jpsnetghha .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#jpsnetghha .gt_font_normal {
  font-weight: normal;
}

#jpsnetghha .gt_font_bold {
  font-weight: bold;
}

#jpsnetghha .gt_font_italic {
  font-style: italic;
}

#jpsnetghha .gt_super {
  font-size: 65%;
}

#jpsnetghha .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 65%;
}
</style>
<table class="gt_table">
  <thead class="gt_header">
    <tr>
      <th colspan="7" class="gt_heading gt_title gt_font_normal" style><strong><strong>Sepsis Study</strong></strong></th>
    </tr>
    <tr>
      <th colspan="7" class="gt_heading gt_subtitle gt_font_normal gt_bottom_border" style><strong>Effect-measure Modification</strong></th>
    </tr>
  </thead>
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="2" colspan="1"></th>
      <th class="gt_center gt_columns_top_border gt_column_spanner_outer" rowspan="1" colspan="2">
        <span class="gt_column_spanner">M0</span>
      </th>
      <th class="gt_center gt_columns_top_border gt_column_spanner_outer" rowspan="1" colspan="2">
        <span class="gt_column_spanner">M1</span>
      </th>
      <th class="gt_center gt_columns_top_border gt_column_spanner_outer" rowspan="1" colspan="2">
        <span class="gt_column_spanner">diff</span>
      </th>
    </tr>
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1">Estimate</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1">CI<sup class="gt_footnote_marks">1</sup></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" style="border-left-width: 1.5px; border-left-style: solid; border-left-color: grey60;">Estimate</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1">CI<sup class="gt_footnote_marks">1</sup></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" style="border-left-width: 1.5px; border-left-style: solid; border-left-color: grey60;">Estimate</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1">CI<sup class="gt_footnote_marks">1</sup></th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td class="gt_row gt_left gt_stub">EYT0</td>
<td class="gt_row gt_center">0.150</td>
<td class="gt_row gt_center">(0.093, 0.207)</td>
<td class="gt_row gt_center" style="border-left-width: 1.5px; border-left-style: solid; border-left-color: grey60;">0.375</td>
<td class="gt_row gt_center">(0.267, 0.48)</td>
<td class="gt_row gt_center" style="border-left-width: 1.5px; border-left-style: solid; border-left-color: grey60;">0.225</td>
<td class="gt_row gt_center">(0.102, 0.345)</td></tr>
    <tr><td class="gt_row gt_left gt_stub">EYT1</td>
<td class="gt_row gt_center gt_striped">0.371</td>
<td class="gt_row gt_center gt_striped">(0.211, 0.531)</td>
<td class="gt_row gt_center gt_striped" style="border-left-width: 1.5px; border-left-style: solid; border-left-color: grey60;">0.571</td>
<td class="gt_row gt_center gt_striped">(0.421, 0.715)</td>
<td class="gt_row gt_center gt_striped" style="border-left-width: 1.5px; border-left-style: solid; border-left-color: grey60;">0.200</td>
<td class="gt_row gt_center gt_striped">(-0.026, 0.42)</td></tr>
    <tr><td class="gt_row gt_left gt_stub">RD</td>
<td class="gt_row gt_center">0.222</td>
<td class="gt_row gt_center">(0.051, 0.39)</td>
<td class="gt_row gt_center" style="border-left-width: 1.5px; border-left-style: solid; border-left-color: grey60;">0.196</td>
<td class="gt_row gt_center">(0.017, 0.371)</td>
<td class="gt_row gt_center" style="border-left-width: 1.5px; border-left-style: solid; border-left-color: grey60;">-0.025</td>
<td class="gt_row gt_center">(-0.276, 0.223)</td></tr>
    <tr><td class="gt_row gt_left gt_stub">RR</td>
<td class="gt_row gt_center gt_striped">2.482</td>
<td class="gt_row gt_center gt_striped">(1.358, 4.528)</td>
<td class="gt_row gt_center gt_striped" style="border-left-width: 1.5px; border-left-style: solid; border-left-color: grey60;">1.524</td>
<td class="gt_row gt_center gt_striped">(1.035, 2.22)</td>
<td class="gt_row gt_center gt_striped" style="border-left-width: 1.5px; border-left-style: solid; border-left-color: grey60;">0.614</td>
<td class="gt_row gt_center gt_striped">(0.297, 1.257)</td></tr>
    <tr><td class="gt_row gt_left gt_stub">RRstar</td>
<td class="gt_row gt_center">1.353</td>
<td class="gt_row gt_center">(1.019, 1.76)</td>
<td class="gt_row gt_center" style="border-left-width: 1.5px; border-left-style: solid; border-left-color: grey60;">1.458</td>
<td class="gt_row gt_center">(0.971, 2.109)</td>
<td class="gt_row gt_center" style="border-left-width: 1.5px; border-left-style: solid; border-left-color: grey60;">1.078</td>
<td class="gt_row gt_center">(0.66, 1.729)</td></tr>
    <tr><td class="gt_row gt_left gt_stub">OR</td>
<td class="gt_row gt_center gt_striped">3.357</td>
<td class="gt_row gt_center gt_striped">(1.422, 7.756)</td>
<td class="gt_row gt_center gt_striped" style="border-left-width: 1.5px; border-left-style: solid; border-left-color: grey60;">2.222</td>
<td class="gt_row gt_center gt_striped">(1.025, 4.59)</td>
<td class="gt_row gt_center gt_striped" style="border-left-width: 1.5px; border-left-style: solid; border-left-color: grey60;">0.662</td>
<td class="gt_row gt_center gt_striped">(0.207, 2.058)</td></tr>
  </tbody>
  <tfoot class="gt_sourcenotes">
    <tr>
      <td class="gt_sourcenote" colspan="7">Fundamentals of Causal Inference, Babette A. Brumback, 2022</td>
    </tr>
  </tfoot>
  <tfoot>
    <tr class="gt_footnotes">
      <td colspan="7">
        <p class="gt_footnote">
          <sup class="gt_footnote_marks">
            <em>1</em>
          </sup>
           
          95% confidence interval
          <br />
        </p>
      </td>
    </tr>
  </tfoot>
</table>
</div>
<p>and plotting the results</p>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb141-1"><a href="measures.html#cb141-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggp_measures_modif</span>(sepsis.out, <span class="at">title =</span> <span class="st">&quot;Sepsis Study&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-91-1.png" width="672" /></p>
<p>Both <span class="math inline">\(RR\)</span> and <span class="math inline">\(OR\)</span> are show a reduction in relative terms when comparing 65-yars
olds to younger people. That is, in relative terms, the event of a shock does
reduces more the zubrod score for older people.</p>
<p>However the effect is not entirely clear as not all effect measures change
in the same direction as should be the case. More investigaitons is required.</p>
</div>
<div id="exercise-3-3" class="section level3" number="4.4.3">
<h3><span class="header-section-number">4.4.3</span> Exercise 3</h3>
<p>We process the data with function <code>boot</code> from above. See exercise #3 of
chapter 3 for details on the <code>brfss</code> data set. We are required to filter
respondents aged less than 65.</p>
<div class="sourceCode" id="cb142"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb142-1"><a href="measures.html#cb142-1" aria-hidden="true" tabindex="-1"></a>dataBRFSS <span class="ot">&lt;-</span> brfss[brfss<span class="sc">$</span>gt65 <span class="sc">==</span> <span class="dv">0</span>, ]</span></code></pre></div>
<p>we process with 500 boot iterations</p>
<div class="sourceCode" id="cb143"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb143-1"><a href="measures.html#cb143-1" aria-hidden="true" tabindex="-1"></a><span class="fu">message</span>(<span class="st">&quot;This takes 2 min.: We used a saved file.&quot;</span>)</span></code></pre></div>
<pre><code>## This takes 2 min.: We used a saved file.</code></pre>
<div class="sourceCode" id="cb145"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb145-1"><a href="measures.html#cb145-1" aria-hidden="true" tabindex="-1"></a><span class="co"># startTime &lt;- Sys.time()</span></span>
<span id="cb145-2"><a href="measures.html#cb145-2" aria-hidden="true" tabindex="-1"></a><span class="co"># brfss.out &lt;- boot(dataBRFSS, formula = insured ~ gthsedu + whitenh, </span></span>
<span id="cb145-3"><a href="measures.html#cb145-3" aria-hidden="true" tabindex="-1"></a><span class="co">#                     R = 500, conf = 0.95)</span></span>
<span id="cb145-4"><a href="measures.html#cb145-4" aria-hidden="true" tabindex="-1"></a><span class="co"># endTime &lt;- Sys.time()</span></span>
<span id="cb145-5"><a href="measures.html#cb145-5" aria-hidden="true" tabindex="-1"></a><span class="co"># print(endTime - startTime)</span></span>
<span id="cb145-6"><a href="measures.html#cb145-6" aria-hidden="true" tabindex="-1"></a>a_file <span class="ot">&lt;-</span> <span class="fu">file.path</span>(dir_data, <span class="st">&quot;chap04_ex3.rds&quot;</span>)</span>
<span id="cb145-7"><a href="measures.html#cb145-7" aria-hidden="true" tabindex="-1"></a><span class="co"># saveRDS(brfss.out, file = a_file)</span></span>
<span id="cb145-8"><a href="measures.html#cb145-8" aria-hidden="true" tabindex="-1"></a>brfss.out <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="at">file =</span> a_file)</span></code></pre></div>
<p>then create the table of results</p>
<div class="sourceCode" id="cb146"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb146-1"><a href="measures.html#cb146-1" aria-hidden="true" tabindex="-1"></a><span class="fu">gt_measures_modif</span>(brfss.out, <span class="at">title =</span> <span class="st">&quot;**BRFSS Survey**&quot;</span>)</span></code></pre></div>
<div id="qulfxsumbd" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#qulfxsumbd .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#qulfxsumbd .gt_heading {
  background-color: #DCDCDC;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#qulfxsumbd .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: bold;
  padding-top: 4px;
  padding-bottom: 4px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#qulfxsumbd .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: bold;
  padding-top: 0;
  padding-bottom: 6px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#qulfxsumbd .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#qulfxsumbd .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#qulfxsumbd .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#qulfxsumbd .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#qulfxsumbd .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#qulfxsumbd .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#qulfxsumbd .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#qulfxsumbd .gt_group_heading {
  padding: 8px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#qulfxsumbd .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#qulfxsumbd .gt_from_md > :first-child {
  margin-top: 0;
}

#qulfxsumbd .gt_from_md > :last-child {
  margin-bottom: 0;
}

#qulfxsumbd .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#qulfxsumbd .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 12px;
}

#qulfxsumbd .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#qulfxsumbd .gt_first_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
}

#qulfxsumbd .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#qulfxsumbd .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#qulfxsumbd .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#qulfxsumbd .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#qulfxsumbd .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#qulfxsumbd .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding: 4px;
}

#qulfxsumbd .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#qulfxsumbd .gt_sourcenote {
  font-size: 90%;
  padding: 4px;
}

#qulfxsumbd .gt_left {
  text-align: left;
}

#qulfxsumbd .gt_center {
  text-align: center;
}

#qulfxsumbd .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#qulfxsumbd .gt_font_normal {
  font-weight: normal;
}

#qulfxsumbd .gt_font_bold {
  font-weight: bold;
}

#qulfxsumbd .gt_font_italic {
  font-style: italic;
}

#qulfxsumbd .gt_super {
  font-size: 65%;
}

#qulfxsumbd .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 65%;
}
</style>
<table class="gt_table">
  <thead class="gt_header">
    <tr>
      <th colspan="7" class="gt_heading gt_title gt_font_normal" style><strong><strong>BRFSS Survey</strong></strong></th>
    </tr>
    <tr>
      <th colspan="7" class="gt_heading gt_subtitle gt_font_normal gt_bottom_border" style><strong>Effect-measure Modification</strong></th>
    </tr>
  </thead>
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="2" colspan="1"></th>
      <th class="gt_center gt_columns_top_border gt_column_spanner_outer" rowspan="1" colspan="2">
        <span class="gt_column_spanner">M0</span>
      </th>
      <th class="gt_center gt_columns_top_border gt_column_spanner_outer" rowspan="1" colspan="2">
        <span class="gt_column_spanner">M1</span>
      </th>
      <th class="gt_center gt_columns_top_border gt_column_spanner_outer" rowspan="1" colspan="2">
        <span class="gt_column_spanner">diff</span>
      </th>
    </tr>
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1">Estimate</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1">CI<sup class="gt_footnote_marks">1</sup></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" style="border-left-width: 1.5px; border-left-style: solid; border-left-color: grey60;">Estimate</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1">CI<sup class="gt_footnote_marks">1</sup></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" style="border-left-width: 1.5px; border-left-style: solid; border-left-color: grey60;">Estimate</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1">CI<sup class="gt_footnote_marks">1</sup></th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td class="gt_row gt_left gt_stub">EYT0</td>
<td class="gt_row gt_center">0.697</td>
<td class="gt_row gt_center">(0.691, 0.703)</td>
<td class="gt_row gt_center" style="border-left-width: 1.5px; border-left-style: solid; border-left-color: grey60;">0.845</td>
<td class="gt_row gt_center">(0.841, 0.848)</td>
<td class="gt_row gt_center" style="border-left-width: 1.5px; border-left-style: solid; border-left-color: grey60;">0.148</td>
<td class="gt_row gt_center">(0.141, 0.155)</td></tr>
    <tr><td class="gt_row gt_left gt_stub">EYT1</td>
<td class="gt_row gt_center gt_striped">0.881</td>
<td class="gt_row gt_center gt_striped">(0.878, 0.884)</td>
<td class="gt_row gt_center gt_striped" style="border-left-width: 1.5px; border-left-style: solid; border-left-color: grey60;">0.933</td>
<td class="gt_row gt_center gt_striped">(0.932, 0.935)</td>
<td class="gt_row gt_center gt_striped" style="border-left-width: 1.5px; border-left-style: solid; border-left-color: grey60;">0.052</td>
<td class="gt_row gt_center gt_striped">(0.048, 0.056)</td></tr>
    <tr><td class="gt_row gt_left gt_stub">RD</td>
<td class="gt_row gt_center">0.184</td>
<td class="gt_row gt_center">(0.178, 0.191)</td>
<td class="gt_row gt_center" style="border-left-width: 1.5px; border-left-style: solid; border-left-color: grey60;">0.088</td>
<td class="gt_row gt_center">(0.085, 0.092)</td>
<td class="gt_row gt_center" style="border-left-width: 1.5px; border-left-style: solid; border-left-color: grey60;">-0.096</td>
<td class="gt_row gt_center">(-0.104, -0.088)</td></tr>
    <tr><td class="gt_row gt_left gt_stub">RR</td>
<td class="gt_row gt_center gt_striped">1.264</td>
<td class="gt_row gt_center gt_striped">(1.253, 1.276)</td>
<td class="gt_row gt_center gt_striped" style="border-left-width: 1.5px; border-left-style: solid; border-left-color: grey60;">1.105</td>
<td class="gt_row gt_center gt_striped">(1.1, 1.109)</td>
<td class="gt_row gt_center gt_striped" style="border-left-width: 1.5px; border-left-style: solid; border-left-color: grey60;">0.874</td>
<td class="gt_row gt_center gt_striped">(0.865, 0.882)</td></tr>
    <tr><td class="gt_row gt_left gt_stub">RRstar</td>
<td class="gt_row gt_center">2.552</td>
<td class="gt_row gt_center">(2.464, 2.637)</td>
<td class="gt_row gt_center" style="border-left-width: 1.5px; border-left-style: solid; border-left-color: grey60;">2.321</td>
<td class="gt_row gt_center">(2.249, 2.393)</td>
<td class="gt_row gt_center" style="border-left-width: 1.5px; border-left-style: solid; border-left-color: grey60;">0.910</td>
<td class="gt_row gt_center">(0.869, 0.953)</td></tr>
    <tr><td class="gt_row gt_left gt_stub">OR</td>
<td class="gt_row gt_center gt_striped">3.227</td>
<td class="gt_row gt_center gt_striped">(3.091, 3.361)</td>
<td class="gt_row gt_center gt_striped" style="border-left-width: 1.5px; border-left-style: solid; border-left-color: grey60;">2.564</td>
<td class="gt_row gt_center gt_striped">(2.475, 2.654)</td>
<td class="gt_row gt_center gt_striped" style="border-left-width: 1.5px; border-left-style: solid; border-left-color: grey60;">0.795</td>
<td class="gt_row gt_center gt_striped">(0.753, 0.84)</td></tr>
  </tbody>
  <tfoot class="gt_sourcenotes">
    <tr>
      <td class="gt_sourcenote" colspan="7">Fundamentals of Causal Inference, Babette A. Brumback, 2022</td>
    </tr>
  </tfoot>
  <tfoot>
    <tr class="gt_footnotes">
      <td colspan="7">
        <p class="gt_footnote">
          <sup class="gt_footnote_marks">
            <em>1</em>
          </sup>
           
          95% confidence interval
          <br />
        </p>
      </td>
    </tr>
  </tfoot>
</table>
</div>
<p>and plotting the results</p>
<div class="sourceCode" id="cb147"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb147-1"><a href="measures.html#cb147-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggp_measures_modif</span>(brfss.out, <span class="at">title =</span> <span class="st">&quot;BRFSS Survey&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-95-1.png" width="672" /></p>
<p>For causal interpretaion we would need to assume that <code>whitenh</code> and <code>gthsedu</code>
are not correlated together by another latent variable which could possibly
be the case here.</p>
<p>if a causal interpretation were possible since all effect measures show
a reduction of the effect of having higher education when the respondent
is not white non-hispanic. In other words being white and nonhispanic
interacts with higher education to have an increased chance of being insured.</p>
</div>
<div id="exercise-4-3" class="section level3" number="4.4.4">
<h3><span class="header-section-number">4.4.4</span> Exercise 4</h3>
<div class="sourceCode" id="cb148"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb148-1"><a href="measures.html#cb148-1" aria-hidden="true" tabindex="-1"></a>dataWAVE <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb148-2"><a href="measures.html#cb148-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">T1 =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>),</span>
<span id="cb148-3"><a href="measures.html#cb148-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">T2 =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb148-4"><a href="measures.html#cb148-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">Y =</span> <span class="fu">c</span>(<span class="fl">0.019</span>, <span class="fl">0.057</span>, <span class="fl">0.039</span>, <span class="fl">0.094</span>),</span>
<span id="cb148-5"><a href="measures.html#cb148-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">n =</span> <span class="fu">c</span>(<span class="dv">108</span>, <span class="dv">105</span>, <span class="dv">103</span>, <span class="dv">107</span>))</span></code></pre></div>
<div id="using-glm" class="section level4" number="4.4.4.1">
<h4><span class="header-section-number">4.4.4.1</span> Using <code>glm</code></h4>
<p>To evaluate statistical significance we use the <code>glm()</code> function. Because our
outcome is numeric, we choose to fit the gaussian parametric model.
Also we use the <code>weights</code> parameter with the variable <span class="math inline">\(n\)</span> since the data is
aggregated.</p>
<div class="sourceCode" id="cb149"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb149-1"><a href="measures.html#cb149-1" aria-hidden="true" tabindex="-1"></a>wave.glm <span class="ot">&lt;-</span> <span class="fu">glm</span>(<span class="at">formula =</span> Y <span class="sc">~</span> T1 <span class="sc">+</span> T2 <span class="sc">+</span> T1<span class="sc">:</span>T2, </span>
<span id="cb149-2"><a href="measures.html#cb149-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">family =</span> gaussian, <span class="at">weights =</span> n, <span class="at">data =</span> dataWAVE)</span>
<span id="cb149-3"><a href="measures.html#cb149-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(wave.glm)</span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = Y ~ T1 + T2 + T1:T2, family = gaussian, data = dataWAVE, 
##     weights = n)
## 
## Deviance Residuals: 
## [1]  0  0  0  0
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)
## (Intercept)    0.019        NaN     NaN      NaN
## T1             0.020        NaN     NaN      NaN
## T2             0.038        NaN     NaN      NaN
## T1:T2          0.017        NaN     NaN      NaN
## 
## (Dispersion parameter for gaussian family taken to be NaN)
## 
##     Null deviance: 3.2636e-01  on 3  degrees of freedom
## Residual deviance: 6.2593e-33  on 0  degrees of freedom
## AIC: -299.44
## 
## Number of Fisher Scoring iterations: 1</code></pre>
<p>And the <code>glm</code> function cannot compute because of the dispersion measure for
the <code>gaussian</code> family.</p>
<p>Therefore we use <code>gee</code> which uses robust statistics and saves the day.</p>
</div>
<div id="using-gee" class="section level4" number="4.4.4.2">
<h4><span class="header-section-number">4.4.4.2</span> Using <code>gee</code></h4>
<p><code>gee</code> does not have a <code>weights</code> parameter like <code>glm</code> so we expand the data
before using <code>gee</code>.</p>
<div class="sourceCode" id="cb151"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb151-1"><a href="measures.html#cb151-1" aria-hidden="true" tabindex="-1"></a>dfs <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="at">mode =</span> <span class="st">&quot;list&quot;</span>, <span class="at">length =</span> <span class="dv">4</span>)</span>
<span id="cb151-2"><a href="measures.html#cb151-2" aria-hidden="true" tabindex="-1"></a>pos <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb151-3"><a href="measures.html#cb151-3" aria-hidden="true" tabindex="-1"></a>dfs[[pos]] <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, </span>
<span id="cb151-4"><a href="measures.html#cb151-4" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">replicate</span>(dataWAVE<span class="sc">$</span>n[pos], </span>
<span id="cb151-5"><a href="measures.html#cb151-5" aria-hidden="true" tabindex="-1"></a>                                <span class="fu">data.frame</span>(<span class="at">T1 =</span> <span class="dv">0</span>, <span class="at">T2 =</span> <span class="dv">0</span>, <span class="at">Y =</span> <span class="fl">0.019</span>), </span>
<span id="cb151-6"><a href="measures.html#cb151-6" aria-hidden="true" tabindex="-1"></a>                                <span class="at">simplify =</span> <span class="cn">FALSE</span>))</span>
<span id="cb151-7"><a href="measures.html#cb151-7" aria-hidden="true" tabindex="-1"></a>pos <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb151-8"><a href="measures.html#cb151-8" aria-hidden="true" tabindex="-1"></a>dfs[[pos]] <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, </span>
<span id="cb151-9"><a href="measures.html#cb151-9" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">replicate</span>(dataWAVE<span class="sc">$</span>n[pos], </span>
<span id="cb151-10"><a href="measures.html#cb151-10" aria-hidden="true" tabindex="-1"></a>                                <span class="fu">data.frame</span>(<span class="at">T1 =</span> <span class="dv">0</span>, <span class="at">T2 =</span> <span class="dv">1</span>, <span class="at">Y =</span> <span class="fl">0.057</span>), </span>
<span id="cb151-11"><a href="measures.html#cb151-11" aria-hidden="true" tabindex="-1"></a>                                <span class="at">simplify =</span> <span class="cn">FALSE</span>))</span>
<span id="cb151-12"><a href="measures.html#cb151-12" aria-hidden="true" tabindex="-1"></a>pos <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb151-13"><a href="measures.html#cb151-13" aria-hidden="true" tabindex="-1"></a>dfs[[pos]] <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, </span>
<span id="cb151-14"><a href="measures.html#cb151-14" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">replicate</span>(dataWAVE<span class="sc">$</span>n[pos], </span>
<span id="cb151-15"><a href="measures.html#cb151-15" aria-hidden="true" tabindex="-1"></a>                                <span class="fu">data.frame</span>(<span class="at">T1 =</span> <span class="dv">1</span>, <span class="at">T2 =</span> <span class="dv">0</span>, <span class="at">Y =</span> <span class="fl">0.039</span>), </span>
<span id="cb151-16"><a href="measures.html#cb151-16" aria-hidden="true" tabindex="-1"></a>                                <span class="at">simplify =</span> <span class="cn">FALSE</span>))</span>
<span id="cb151-17"><a href="measures.html#cb151-17" aria-hidden="true" tabindex="-1"></a>pos <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb151-18"><a href="measures.html#cb151-18" aria-hidden="true" tabindex="-1"></a>dfs[[pos]] <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, </span>
<span id="cb151-19"><a href="measures.html#cb151-19" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">replicate</span>(dataWAVE<span class="sc">$</span>n[pos], </span>
<span id="cb151-20"><a href="measures.html#cb151-20" aria-hidden="true" tabindex="-1"></a>                                <span class="fu">data.frame</span>(<span class="at">T1 =</span> <span class="dv">1</span>, <span class="at">T2 =</span> <span class="dv">1</span>, <span class="at">Y =</span> <span class="fl">0.094</span>), </span>
<span id="cb151-21"><a href="measures.html#cb151-21" aria-hidden="true" tabindex="-1"></a>                                <span class="at">simplify =</span> <span class="cn">FALSE</span>))</span>
<span id="cb151-22"><a href="measures.html#cb151-22" aria-hidden="true" tabindex="-1"></a>dataWAVErep <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, dfs)</span>
<span id="cb151-23"><a href="measures.html#cb151-23" aria-hidden="true" tabindex="-1"></a>dataWAVErep<span class="sc">$</span>id <span class="ot">&lt;-</span> <span class="fu">seq_len</span>(<span class="fu">nrow</span>(dataWAVErep))</span></code></pre></div>
<p>then we use <code>gee</code></p>
<div class="sourceCode" id="cb152"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb152-1"><a href="measures.html#cb152-1" aria-hidden="true" tabindex="-1"></a>wave.gee <span class="ot">&lt;-</span> gee<span class="sc">::</span><span class="fu">gee</span>(<span class="at">formula =</span> Y <span class="sc">~</span> T1 <span class="sc">+</span> T2 <span class="sc">+</span> T1 <span class="sc">*</span> T2,</span>
<span id="cb152-2"><a href="measures.html#cb152-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">id =</span> id, <span class="at">family =</span> gaussian, <span class="at">data =</span> dataWAVErep)</span></code></pre></div>
<pre><code>## Beginning Cgee S-function, @(#) geeformula.q 4.13 98/01/27</code></pre>
<pre><code>## running glm to get initial regression estimate</code></pre>
<pre><code>## (Intercept)          T1          T2       T1:T2 
##       0.019       0.020       0.038       0.017</code></pre>
<div class="sourceCode" id="cb156"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb156-1"><a href="measures.html#cb156-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(wave.gee)</span></code></pre></div>
<pre><code>## 
##  GEE:  GENERALIZED LINEAR MODELS FOR DEPENDENT DATA
##  gee S-function, version 4.13 modified 98/01/27 (1998) 
## 
## Model:
##  Link:                      Identity 
##  Variance to Mean Relation: Gaussian 
##  Correlation Structure:     Independent 
## 
## Call:
## gee::gee(formula = Y ~ T1 + T2 + T1 * T2, id = id, data = dataWAVErep, 
##     family = gaussian)
## 
## Summary of Residuals:
##           Min            1Q        Median            3Q           Max 
## -9.055257e-16 -9.055257e-16  2.775558e-17  1.595946e-16  2.567391e-16 
## 
## 
## Coefficients:
##             Estimate   Naive S.E.      Naive z  Robust S.E.     Robust z
## (Intercept)    0.019 4.658032e-17 4.078976e+14 8.713425e-17 2.180543e+14
## T1             0.020 6.666917e-17 2.999887e+14 8.854187e-17 2.258818e+14
## T2             0.038 6.634338e-17 5.727776e+14 9.066498e-17 4.191254e+14
## T1:T2          0.017 9.416210e-17 1.805397e+14 9.205772e-17 1.846668e+14
## 
## Estimated Scale Parameter:  0
## Number of Iterations:  1
## 
## Working Correlation
##      [,1]
## [1,]    1</code></pre>
<p>Just by looking at the <code>Robust z</code> indicating that <span class="math inline">\(T1:T2\)</span> is 1.85e14 from
zero it is obvious that the interaction is statistically significant.</p>
<div class="sourceCode" id="cb158"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb158-1"><a href="measures.html#cb158-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(<span class="fu">summary</span>(wave.gee))</span></code></pre></div>
<pre><code>##             Estimate   Naive S.E.      Naive z  Robust S.E.     Robust z
## (Intercept)    0.019 4.658032e-17 4.078976e+14 8.713425e-17 2.180543e+14
## T1             0.020 6.666917e-17 2.999887e+14 8.854187e-17 2.258818e+14
## T2             0.038 6.634338e-17 5.727776e+14 9.066498e-17 4.191254e+14
## T1:T2          0.017 9.416210e-17 1.805397e+14 9.205772e-17 1.846668e+14</code></pre>
<p>The actual p-value calculation (see p. 67 on how to do this) is</p>
<div class="sourceCode" id="cb160"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb160-1"><a href="measures.html#cb160-1" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">coef</span>(<span class="fu">summary</span>(wave.gee))[<span class="st">&quot;T1:T2&quot;</span>, <span class="st">&quot;Robust z&quot;</span>]</span>
<span id="cb160-2"><a href="measures.html#cb160-2" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span> <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">pnorm</span>(z))</span></code></pre></div>
<pre><code>## [1] 0</code></pre>
<p>and since the p-value is 0 then it is statistically significant.</p>
</div>
</div>
<div id="exercise-5-2" class="section level3" number="4.4.5">
<h3><span class="header-section-number">4.4.5</span> Exercise 5</h3>
<div class="sourceCode" id="cb162"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb162-1"><a href="measures.html#cb162-1" aria-hidden="true" tabindex="-1"></a>dataGSS <span class="ot">&lt;-</span> gss[, <span class="fu">c</span>(<span class="st">&quot;attend&quot;</span>, <span class="st">&quot;gthsedu&quot;</span>, <span class="st">&quot;female&quot;</span>)]</span>
<span id="cb162-2"><a href="measures.html#cb162-2" aria-hidden="true" tabindex="-1"></a>dataGSS <span class="ot">&lt;-</span> dataGSS[<span class="fu">complete.cases</span>(dataGSS), ]</span>
<span id="cb162-3"><a href="measures.html#cb162-3" aria-hidden="true" tabindex="-1"></a>dataGSS<span class="sc">$</span>id <span class="ot">&lt;-</span> <span class="fu">seq_len</span>(<span class="fu">nrow</span>(dataGSS))</span></code></pre></div>
<p>To determine a synergetic effect we are looking for the pattern where
<span class="math inline">\(Y(t_1 = 0, t_2 = 0) = 0\)</span>, <span class="math inline">\(Y(t_1 = 1, t_2 = 0) = 0\)</span>, <span class="math inline">\(Y(t_1 = 0, t_2 = 1) = 0\)</span>
and <span class="math inline">\(Y(t_1 = 1, t_2 = 1) = 1\)</span>. That is, as explained in p. 76 of section 4.3,
both <span class="math inline">\(T_1\)</span> and <span class="math inline">\(T_2\)</span> for <span class="math inline">\(Y=1\)</span>, otherwise <span class="math inline">\(Y=0\)</span>, It is the causal type 2 shown
in table 4.4 on p. 75.</p>
<p>Assuming monotocity we can use the result from VanderWeele and Robins (2007)
discussed in p.76 of section 4.3 stating that a sufficient condition for the
synergistic effect is</p>
<p><span class="math display">\[
E(Y(1, 1)) - E(Y(0, 1)) - E(Y(1, 0)) + E(Y(0, 0)) &gt; 0
\]</span>
and if we estimate with the regression model</p>
<p><span class="math display">\[
Y = \beta_0 + \beta_1 T_1 + \beta_2 T_2 +  + \beta_3 T_1T_2
\]</span>
then we hcan determine our result with the estimates</p>
<p><span class="math display">\[
\begin{align*}
\hat{E}(Y(0, 0)) &amp;= \beta_0 \\
\hat{E}(Y(1, 0)) &amp;= \beta_1 \\ 
\hat{E}(Y(0, 1)) &amp;= \beta_2 \\
\hat{E}(Y(1, 1)) &amp;=\beta_3
\end{align*}
\]</span></p>
<p>doing he fit with <code>gee</code>, with the binomial family because our outcome is binary,
we obtain</p>
<div class="sourceCode" id="cb163"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb163-1"><a href="measures.html#cb163-1" aria-hidden="true" tabindex="-1"></a>gss.gee <span class="ot">&lt;-</span> gee<span class="sc">::</span><span class="fu">gee</span>(<span class="at">formula =</span> attend <span class="sc">~</span> gthsedu <span class="sc">+</span> female <span class="sc">+</span> gthsedu <span class="sc">*</span> female,</span>
<span id="cb163-2"><a href="measures.html#cb163-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">id =</span> id, <span class="at">family =</span> binomial, <span class="at">data =</span> dataGSS)</span></code></pre></div>
<pre><code>## Beginning Cgee S-function, @(#) geeformula.q 4.13 98/01/27</code></pre>
<pre><code>## running glm to get initial regression estimate</code></pre>
<pre><code>##    (Intercept)        gthsedu         female gthsedu:female 
##     -1.0509842      0.4313711      0.5352755     -0.3694460</code></pre>
<div class="sourceCode" id="cb167"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb167-1"><a href="measures.html#cb167-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(gss.gee)</span></code></pre></div>
<pre><code>## 
##  GEE:  GENERALIZED LINEAR MODELS FOR DEPENDENT DATA
##  gee S-function, version 4.13 modified 98/01/27 (1998) 
## 
## Model:
##  Link:                      Logit 
##  Variance to Mean Relation: Binomial 
##  Correlation Structure:     Independent 
## 
## Call:
## gee::gee(formula = attend ~ gthsedu + female + gthsedu * female, 
##     id = id, data = dataGSS, family = binomial)
## 
## Summary of Residuals:
##        Min         1Q     Median         3Q        Max 
## -0.3884615 -0.3738562 -0.2590361  0.6261438  0.7409639 
## 
## 
## Coefficients:
##                  Estimate Naive S.E.    Naive z Robust S.E.   Robust z
## (Intercept)    -1.0509842 0.08865639 -11.854580  0.08858032 -11.864759
## gthsedu         0.4313711 0.13913457   3.100388  0.13901520   3.103050
## female          0.5352755 0.11599024   4.614832  0.11589072   4.618795
## gthsedu:female -0.3694460 0.18182758  -2.031848  0.18167157  -2.033593
## 
## Estimated Scale Parameter:  1.001718
## Number of Iterations:  1
## 
## Working Correlation
##      [,1]
## [1,]    1</code></pre>
<p>so now lets compute the sufficient condition from VanderWeele and Robins (2007)
using the estimates from the regression</p>
<p><span class="math display">\[
\begin{align*}
\hat{E}(Y(1, 1)) - \hat{E}(Y(0, 1)) - \hat{E}(Y(1, 0)) + \hat{E}(Y(0, 0))
\end{align*}
\]</span></p>
<div class="sourceCode" id="cb169"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb169-1"><a href="measures.html#cb169-1" aria-hidden="true" tabindex="-1"></a>Y11 <span class="ot">&lt;-</span> <span class="fu">coef</span>(gss.gee)[<span class="st">&quot;gthsedu:female&quot;</span>]</span>
<span id="cb169-2"><a href="measures.html#cb169-2" aria-hidden="true" tabindex="-1"></a>Y01 <span class="ot">&lt;-</span> <span class="fu">coef</span>(gss.gee)[<span class="st">&quot;female&quot;</span>]</span>
<span id="cb169-3"><a href="measures.html#cb169-3" aria-hidden="true" tabindex="-1"></a>Y10 <span class="ot">&lt;-</span> <span class="fu">coef</span>(gss.gee)[<span class="st">&quot;gthsedu&quot;</span>]</span>
<span id="cb169-4"><a href="measures.html#cb169-4" aria-hidden="true" tabindex="-1"></a>Y00 <span class="ot">&lt;-</span> <span class="fu">coef</span>(gss.gee)[<span class="st">&quot;(Intercept)&quot;</span>]</span>
<span id="cb169-5"><a href="measures.html#cb169-5" aria-hidden="true" tabindex="-1"></a>Y11 <span class="sc">-</span> Y01 <span class="sc">-</span> Y10 <span class="sc">-</span> Y00</span></code></pre></div>
<pre><code>## gthsedu:female 
##     -0.2851084</code></pre>
<p>Therefore the sufficient condition is not met. We cannot positively
confirm a causal effect without more information.</p>
</div>
<div id="exercise-6-1" class="section level3" number="4.4.6">
<h3><span class="header-section-number">4.4.6</span> Exercise 6</h3>
<p>Since we condition on H then we would filter the data based on H and apply
the sufficient condition for synergy to each data set filtered for each value
of H.</p>

</div>
</div>
</div>



<h3>References</h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-brumback2022" class="csl-entry">
Brumback, Babette A. 2022. <em>Fundamentals of Causal Inference with r</em>. Boca Raton, Florida: Chapman; Hall/CRC. <a href="https://www.crcpress.com">https://www.crcpress.com</a>.
</div>
<div id="ref-grimmett" class="csl-entry">
Geoffrey R. Grimmet, David R. Stirzacker. 2001. <em>Probability and Random Processes</em>. 3rd ed. Great Clarendon Street, oxford OX2 6DP: Oxford University Press.
</div>
<div id="ref-shanninbrumback2021" class="csl-entry">
Jake Shannin, Babette A. Brumback. 2021. <em>Disagreement Concerning Effect-Measures Modification</em>. <a href="https://arxiv.org/abs/2105.07285v1">https://arxiv.org/abs/2105.07285v1</a>.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="outcomes.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="dag.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/USERNAME/REPO/edit/BRANCH/04-measures.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
},
"toc_depth": 2
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
